var Ei=Object.defineProperty;var Ti=(r,t,e)=>t in r?Ei(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e;var te=(r,t,e)=>Ti(r,typeof t!="symbol"?t+"":t,e);import{u as un,a as Si,a1 as bi,a2 as sr,a3 as cr,a4 as wi}from"./common-BQgXWrz2O5Bt.js";import{d as h,V as at,c as sn,b as Oi,p as D,D as C,t as A,i as Vt,T as B,S as ut,a as cn,e as b,f as Ai,g as Ri,I as Li,h as ln,R as ft,m as Pi,j as Ci,k as xi}from"./context-slice-graphql-B0DOwuSsR7A9.js";var L;(function(r){r[r.DELTA=0]="DELTA",r[r.CUMULATIVE=1]="CUMULATIVE"})(L||(L={}));var x;(function(r){r[r.HISTOGRAM=0]="HISTOGRAM",r[r.EXPONENTIAL_HISTOGRAM=1]="EXPONENTIAL_HISTOGRAM",r[r.GAUGE=2]="GAUGE",r[r.SUM=3]="SUM"})(x||(x={}));var Mi=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),lr=function(r,t,e,n){function o(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function s(l){try{a(n.next(l))}catch(f){u(f)}}function c(l){try{a(n.throw(l))}catch(f){u(f)}}function a(l){l.done?i(l.value):o(l.value).then(s,c)}a((n=n.apply(r,t||[])).next())})},fr=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(l){return c([a,l])}}function c(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,o=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(l){a=[6,l],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Ii=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},Ni=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},Ui=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function Di(r){return r!=null}function fn(r){var t=Object.keys(r);return t.length===0?"":(t=t.sort(),JSON.stringify(t.map(function(e){return[e,r[e]]})))}function Bi(r){var t,e;return r.name+":"+((t=r.version)!==null&&t!==void 0?t:"")+":"+((e=r.schemaUrl)!==null&&e!==void 0?e:"")}var Hi=function(r){Mi(t,r);function t(e){var n=r.call(this,e)||this;return Object.setPrototypeOf(n,t.prototype),n}return t}(Error);function Nt(r,t){var e,n=new Promise(function(i,u){e=setTimeout(function(){u(new Hi("Operation timed out."))},t)});return Promise.race([r,n]).then(function(o){return clearTimeout(e),o},function(o){throw clearTimeout(e),o})}function Gi(r){return lr(this,void 0,void 0,function(){var t=this;return fr(this,function(e){return[2,Promise.all(r.map(function(n){return lr(t,void 0,void 0,function(){var o,i;return fr(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,n];case 1:return o=u.sent(),[2,{status:"fulfilled",value:o}];case 2:return i=u.sent(),[2,{status:"rejected",reason:i}];case 3:return[2]}})})}))]})})}function ji(r){return r.status==="rejected"}function dr(r,t){var e=[];return r.forEach(function(n){e.push.apply(e,Ni([],Ii(t(n)),!1))}),e}function ki(r,t){var e,n;if(r.size!==t.size)return!1;try{for(var o=Ui(r),i=o.next();!i.done;i=o.next()){var u=i.value;if(!t.has(u))return!1}}catch(s){e={error:s}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return!0}function Fi(r,t){for(var e=0,n=r.length-1,o=r.length;n>=e;){var i=e+Math.trunc((n-e)/2);r[i]<t?e=i+1:(o=i,n=i-1)}return o}function Vi(r,t){return r.toLowerCase()===t.toLowerCase()}var K;(function(r){r[r.DROP=0]="DROP",r[r.SUM=1]="SUM",r[r.LAST_VALUE=2]="LAST_VALUE",r[r.HISTOGRAM=3]="HISTOGRAM",r[r.EXPONENTIAL_HISTOGRAM=4]="EXPONENTIAL_HISTOGRAM"})(K||(K={}));var Xi=function(){function r(){this.kind=K.DROP}return r.prototype.createAccumulation=function(){},r.prototype.merge=function(t,e){},r.prototype.diff=function(t,e){},r.prototype.toMetricData=function(t,e,n,o){},r}(),v;(function(r){r.COUNTER="COUNTER",r.GAUGE="GAUGE",r.HISTOGRAM="HISTOGRAM",r.UP_DOWN_COUNTER="UP_DOWN_COUNTER",r.OBSERVABLE_COUNTER="OBSERVABLE_COUNTER",r.OBSERVABLE_GAUGE="OBSERVABLE_GAUGE",r.OBSERVABLE_UP_DOWN_COUNTER="OBSERVABLE_UP_DOWN_COUNTER"})(v||(v={}));function G(r,t,e){var n,o,i,u;return Wi(r)||h.warn('Invalid metric name: "'+r+'". The metric name should be a ASCII string with a length no greater than 255 characters.'),{name:r,type:t,description:(n=e==null?void 0:e.description)!==null&&n!==void 0?n:"",unit:(o=e==null?void 0:e.unit)!==null&&o!==void 0?o:"",valueType:(i=e==null?void 0:e.valueType)!==null&&i!==void 0?i:at.DOUBLE,advice:(u=e==null?void 0:e.advice)!==null&&u!==void 0?u:{}}}function $i(r,t){var e,n;return{name:(e=r.name)!==null&&e!==void 0?e:t.name,description:(n=r.description)!==null&&n!==void 0?n:t.description,type:t.type,unit:t.unit,valueType:t.valueType,advice:t.advice}}function zi(r,t){return Vi(r.name,t.name)&&r.unit===t.unit&&r.type===t.type&&r.valueType===t.valueType}var Yi=/^[a-z][a-z0-9_.\-/]{0,254}$/i;function Wi(r){return r.match(Yi)!=null}var Ki=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i};function qi(r){var t=r.map(function(){return 0});return t.push(0),{buckets:{boundaries:r,counts:t},sum:0,count:0,hasMinMax:!1,min:1/0,max:-1/0}}var ee=function(){function r(t,e,n,o){n===void 0&&(n=!0),o===void 0&&(o=qi(e)),this.startTime=t,this._boundaries=e,this._recordMinMax=n,this._current=o}return r.prototype.record=function(t){if(!Number.isNaN(t)){this._current.count+=1,this._current.sum+=t,this._recordMinMax&&(this._current.min=Math.min(t,this._current.min),this._current.max=Math.max(t,this._current.max),this._current.hasMinMax=!0);var e=Fi(this._boundaries,t);this._current.buckets.counts[e]+=1}},r.prototype.setStartTime=function(t){this.startTime=t},r.prototype.toPointValue=function(){return this._current},r}(),dn=function(){function r(t,e){this._boundaries=t,this._recordMinMax=e,this.kind=K.HISTOGRAM}return r.prototype.createAccumulation=function(t){return new ee(t,this._boundaries,this._recordMinMax)},r.prototype.merge=function(t,e){for(var n=t.toPointValue(),o=e.toPointValue(),i=n.buckets.counts,u=o.buckets.counts,s=new Array(i.length),c=0;c<i.length;c++)s[c]=i[c]+u[c];var a=1/0,l=-1/0;return this._recordMinMax&&(n.hasMinMax&&o.hasMinMax?(a=Math.min(n.min,o.min),l=Math.max(n.max,o.max)):n.hasMinMax?(a=n.min,l=n.max):o.hasMinMax&&(a=o.min,l=o.max)),new ee(t.startTime,n.buckets.boundaries,this._recordMinMax,{buckets:{boundaries:n.buckets.boundaries,counts:s},count:n.count+o.count,sum:n.sum+o.sum,hasMinMax:this._recordMinMax&&(n.hasMinMax||o.hasMinMax),min:a,max:l})},r.prototype.diff=function(t,e){for(var n=t.toPointValue(),o=e.toPointValue(),i=n.buckets.counts,u=o.buckets.counts,s=new Array(i.length),c=0;c<i.length;c++)s[c]=u[c]-i[c];return new ee(e.startTime,n.buckets.boundaries,this._recordMinMax,{buckets:{boundaries:n.buckets.boundaries,counts:s},count:o.count-n.count,sum:o.sum-n.sum,hasMinMax:!1,min:1/0,max:-1/0})},r.prototype.toMetricData=function(t,e,n,o){return{descriptor:t,aggregationTemporality:e,dataPointType:x.HISTOGRAM,dataPoints:n.map(function(i){var u=Ki(i,2),s=u[0],c=u[1],a=c.toPointValue(),l=t.type===v.GAUGE||t.type===v.UP_DOWN_COUNTER||t.type===v.OBSERVABLE_GAUGE||t.type===v.OBSERVABLE_UP_DOWN_COUNTER;return{attributes:s,startTime:c.startTime,endTime:o,value:{min:a.hasMinMax?a.min:void 0,max:a.hasMinMax?a.max:void 0,sum:l?void 0:a.sum,buckets:a.buckets,count:a.count}}})}},r}(),re=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},ne=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},hr=function(){function r(t,e,n,o){t===void 0&&(t=new Qi),e===void 0&&(e=0),n===void 0&&(n=0),o===void 0&&(o=0),this.backing=t,this.indexBase=e,this.indexStart=n,this.indexEnd=o}return Object.defineProperty(r.prototype,"offset",{get:function(){return this.indexStart},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"length",{get:function(){return this.backing.length===0||this.indexEnd===this.indexStart&&this.at(0)===0?0:this.indexEnd-this.indexStart+1},enumerable:!1,configurable:!0}),r.prototype.counts=function(){var t=this;return Array.from({length:this.length},function(e,n){return t.at(n)})},r.prototype.at=function(t){var e=this.indexBase-this.indexStart;return t<e&&(t+=this.backing.length),t-=e,this.backing.countAt(t)},r.prototype.incrementBucket=function(t,e){this.backing.increment(t,e)},r.prototype.decrementBucket=function(t,e){this.backing.decrement(t,e)},r.prototype.trim=function(){for(var t=0;t<this.length;t++)if(this.at(t)!==0){this.indexStart+=t;break}else if(t===this.length-1){this.indexStart=this.indexEnd=this.indexBase=0;return}for(var t=this.length-1;t>=0;t--)if(this.at(t)!==0){this.indexEnd-=this.length-t-1;break}this._rotate()},r.prototype.downscale=function(t){this._rotate();for(var e=1+this.indexEnd-this.indexStart,n=1<<t,o=0,i=0,u=this.indexStart;u<=this.indexEnd;){var s=u%n;s<0&&(s+=n);for(var c=s;c<n&&o<e;c++)this._relocateBucket(i,o),o++,u++;i++}this.indexStart>>=t,this.indexEnd>>=t,this.indexBase=this.indexStart},r.prototype.clone=function(){return new r(this.backing.clone(),this.indexBase,this.indexStart,this.indexEnd)},r.prototype._rotate=function(){var t=this.indexBase-this.indexStart;t!==0&&(t>0?(this.backing.reverse(0,this.backing.length),this.backing.reverse(0,t),this.backing.reverse(t,this.backing.length)):(this.backing.reverse(0,this.backing.length),this.backing.reverse(0,this.backing.length+t)),this.indexBase=this.indexStart)},r.prototype._relocateBucket=function(t,e){t!==e&&this.incrementBucket(t,this.backing.emptyBucket(e))},r}(),Qi=function(){function r(t){t===void 0&&(t=[0]),this._counts=t}return Object.defineProperty(r.prototype,"length",{get:function(){return this._counts.length},enumerable:!1,configurable:!0}),r.prototype.countAt=function(t){return this._counts[t]},r.prototype.growTo=function(t,e,n){var o=new Array(t).fill(0);o.splice.apply(o,ne([n,this._counts.length-e],re(this._counts.slice(e)),!1)),o.splice.apply(o,ne([0,e],re(this._counts.slice(0,e)),!1)),this._counts=o},r.prototype.reverse=function(t,e){for(var n=Math.floor((t+e)/2)-t,o=0;o<n;o++){var i=this._counts[t+o];this._counts[t+o]=this._counts[e-o-1],this._counts[e-o-1]=i}},r.prototype.emptyBucket=function(t){var e=this._counts[t];return this._counts[t]=0,e},r.prototype.increment=function(t,e){this._counts[t]+=e},r.prototype.decrement=function(t,e){this._counts[t]>=e?this._counts[t]-=e:this._counts[t]=0},r.prototype.clone=function(){return new r(ne([],re(this._counts),!1))},r}(),Zi=52,Ji=2146435072,to=1048575,hn=1023,_n=-1022,pn=hn,we=Math.pow(2,-1022);function vn(r){var t=new DataView(new ArrayBuffer(8));t.setFloat64(0,r);var e=t.getUint32(0),n=(e&Ji)>>20;return n-hn}function yn(r){var t=new DataView(new ArrayBuffer(8));t.setFloat64(0,r);var e=t.getUint32(0),n=t.getUint32(4),o=(e&to)*Math.pow(2,32);return o+n}function Oe(r,t){return r===0||r===Number.POSITIVE_INFINITY||r===Number.NEGATIVE_INFINITY||Number.isNaN(r)?r:r*Math.pow(2,t)}function eo(r){return r--,r|=r>>1,r|=r>>2,r|=r>>4,r|=r>>8,r|=r>>16,r++,r}var ro=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),vt=function(r){ro(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(Error),no=function(){function r(t){this._shift=-t}return r.prototype.mapToIndex=function(t){if(t<we)return this._minNormalLowerBoundaryIndex();var e=vn(t),n=this._rightShift(yn(t)-1,Zi);return e+n>>this._shift},r.prototype.lowerBoundary=function(t){var e=this._minNormalLowerBoundaryIndex();if(t<e)throw new vt("underflow: "+t+" is < minimum lower boundary: "+e);var n=this._maxNormalLowerBoundaryIndex();if(t>n)throw new vt("overflow: "+t+" is > maximum lower boundary: "+n);return Oe(1,t<<this._shift)},Object.defineProperty(r.prototype,"scale",{get:function(){return this._shift===0?0:-this._shift},enumerable:!1,configurable:!0}),r.prototype._minNormalLowerBoundaryIndex=function(){var t=_n>>this._shift;return this._shift<2&&t--,t},r.prototype._maxNormalLowerBoundaryIndex=function(){return pn>>this._shift},r.prototype._rightShift=function(t,e){return Math.floor(t*Math.pow(2,-e))},r}(),io=function(){function r(t){this._scale=t,this._scaleFactor=Oe(Math.LOG2E,t),this._inverseFactor=Oe(Math.LN2,-t)}return r.prototype.mapToIndex=function(t){if(t<=we)return this._minNormalLowerBoundaryIndex()-1;if(yn(t)===0){var e=vn(t);return(e<<this._scale)-1}var n=Math.floor(Math.log(t)*this._scaleFactor),o=this._maxNormalLowerBoundaryIndex();return n>=o?o:n},r.prototype.lowerBoundary=function(t){var e=this._maxNormalLowerBoundaryIndex();if(t>=e){if(t===e)return 2*Math.exp((t-(1<<this._scale))/this._scaleFactor);throw new vt("overflow: "+t+" is > maximum lower boundary: "+e)}var n=this._minNormalLowerBoundaryIndex();if(t<=n){if(t===n)return we;if(t===n-1)return Math.exp((t+(1<<this._scale))/this._scaleFactor)/2;throw new vt("overflow: "+t+" is < minimum lower boundary: "+n)}return Math.exp(t*this._inverseFactor)},Object.defineProperty(r.prototype,"scale",{get:function(){return this._scale},enumerable:!1,configurable:!0}),r.prototype._minNormalLowerBoundaryIndex=function(){return _n<<this._scale},r.prototype._maxNormalLowerBoundaryIndex=function(){return(pn+1<<this._scale)-1},r}(),_r=-10,pr=20,oo=Array.from({length:31},function(r,t){return t>10?new io(t-10):new no(t-10)});function vr(r){if(r>pr||r<_r)throw new vt("expected scale >= "+_r+" && <= "+pr+", got: "+r);return oo[r+10]}var ao=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},Et=function(){function r(t,e){this.low=t,this.high=e}return r.combine=function(t,e){return new r(Math.min(t.low,e.low),Math.max(t.high,e.high))},r}(),uo=20,so=160,ie=2,co=function(){function r(t,e,n,o,i,u,s,c,a,l,f){t===void 0&&(t=t),e===void 0&&(e=so),n===void 0&&(n=!0),o===void 0&&(o=0),i===void 0&&(i=0),u===void 0&&(u=0),s===void 0&&(s=Number.POSITIVE_INFINITY),c===void 0&&(c=Number.NEGATIVE_INFINITY),a===void 0&&(a=new hr),l===void 0&&(l=new hr),f===void 0&&(f=vr(uo)),this.startTime=t,this._maxSize=e,this._recordMinMax=n,this._sum=o,this._count=i,this._zeroCount=u,this._min=s,this._max=c,this._positive=a,this._negative=l,this._mapping=f,this._maxSize<ie&&(h.warn("Exponential Histogram Max Size set to "+this._maxSize+",                 changing to the minimum size of: "+ie),this._maxSize=ie)}return r.prototype.record=function(t){this.updateByIncrement(t,1)},r.prototype.setStartTime=function(t){this.startTime=t},r.prototype.toPointValue=function(){return{hasMinMax:this._recordMinMax,min:this.min,max:this.max,sum:this.sum,positive:{offset:this.positive.offset,bucketCounts:this.positive.counts()},negative:{offset:this.negative.offset,bucketCounts:this.negative.counts()},count:this.count,scale:this.scale,zeroCount:this.zeroCount}},Object.defineProperty(r.prototype,"sum",{get:function(){return this._sum},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"min",{get:function(){return this._min},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"max",{get:function(){return this._max},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"count",{get:function(){return this._count},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"zeroCount",{get:function(){return this._zeroCount},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"scale",{get:function(){return this._count===this._zeroCount?0:this._mapping.scale},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"positive",{get:function(){return this._positive},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"negative",{get:function(){return this._negative},enumerable:!1,configurable:!0}),r.prototype.updateByIncrement=function(t,e){if(!Number.isNaN(t)){if(t>this._max&&(this._max=t),t<this._min&&(this._min=t),this._count+=e,t===0){this._zeroCount+=e;return}this._sum+=t*e,t>0?this._updateBuckets(this._positive,t,e):this._updateBuckets(this._negative,-t,e)}},r.prototype.merge=function(t){this._count===0?(this._min=t.min,this._max=t.max):t.count!==0&&(t.min<this.min&&(this._min=t.min),t.max>this.max&&(this._max=t.max)),this.startTime=t.startTime,this._sum+=t.sum,this._count+=t.count,this._zeroCount+=t.zeroCount;var e=this._minScale(t);this._downscale(this.scale-e),this._mergeBuckets(this.positive,t,t.positive,e),this._mergeBuckets(this.negative,t,t.negative,e)},r.prototype.diff=function(t){this._min=1/0,this._max=-1/0,this._sum-=t.sum,this._count-=t.count,this._zeroCount-=t.zeroCount;var e=this._minScale(t);this._downscale(this.scale-e),this._diffBuckets(this.positive,t,t.positive,e),this._diffBuckets(this.negative,t,t.negative,e)},r.prototype.clone=function(){return new r(this.startTime,this._maxSize,this._recordMinMax,this._sum,this._count,this._zeroCount,this._min,this._max,this.positive.clone(),this.negative.clone(),this._mapping)},r.prototype._updateBuckets=function(t,e,n){var o=this._mapping.mapToIndex(e),i=!1,u=0,s=0;if(t.length===0?(t.indexStart=o,t.indexEnd=t.indexStart,t.indexBase=t.indexStart):o<t.indexStart&&t.indexEnd-o>=this._maxSize?(i=!0,s=o,u=t.indexEnd):o>t.indexEnd&&o-t.indexStart>=this._maxSize&&(i=!0,s=t.indexStart,u=o),i){var c=this._changeScale(u,s);this._downscale(c),o=this._mapping.mapToIndex(e)}this._incrementIndexBy(t,o,n)},r.prototype._incrementIndexBy=function(t,e,n){if(n!==0){if(t.length===0&&(t.indexStart=t.indexEnd=t.indexBase=e),e<t.indexStart){var o=t.indexEnd-e;o>=t.backing.length&&this._grow(t,o+1),t.indexStart=e}else if(e>t.indexEnd){var o=e-t.indexStart;o>=t.backing.length&&this._grow(t,o+1),t.indexEnd=e}var i=e-t.indexBase;i<0&&(i+=t.backing.length),t.incrementBucket(i,n)}},r.prototype._grow=function(t,e){var n=t.backing.length,o=t.indexBase-t.indexStart,i=n-o,u=eo(e);u>this._maxSize&&(u=this._maxSize);var s=u-o;t.backing.growTo(u,i,s)},r.prototype._changeScale=function(t,e){for(var n=0;t-e>=this._maxSize;)t>>=1,e>>=1,n++;return n},r.prototype._downscale=function(t){if(t!==0){if(t<0)throw new Error("impossible change of scale: "+this.scale);var e=this._mapping.scale-t;this._positive.downscale(t),this._negative.downscale(t),this._mapping=vr(e)}},r.prototype._minScale=function(t){var e=Math.min(this.scale,t.scale),n=Et.combine(this._highLowAtScale(this.positive,this.scale,e),this._highLowAtScale(t.positive,t.scale,e)),o=Et.combine(this._highLowAtScale(this.negative,this.scale,e),this._highLowAtScale(t.negative,t.scale,e));return Math.min(e-this._changeScale(n.high,n.low),e-this._changeScale(o.high,o.low))},r.prototype._highLowAtScale=function(t,e,n){if(t.length===0)return new Et(0,-1);var o=e-n;return new Et(t.indexStart>>o,t.indexEnd>>o)},r.prototype._mergeBuckets=function(t,e,n,o){for(var i=n.offset,u=e.scale-o,s=0;s<n.length;s++)this._incrementIndexBy(t,i+s>>u,n.at(s))},r.prototype._diffBuckets=function(t,e,n,o){for(var i=n.offset,u=e.scale-o,s=0;s<n.length;s++){var c=i+s>>u,a=c-t.indexBase;a<0&&(a+=t.backing.length),t.decrementBucket(a,n.at(s))}t.trim()},r}(),lo=function(){function r(t,e){this._maxSize=t,this._recordMinMax=e,this.kind=K.EXPONENTIAL_HISTOGRAM}return r.prototype.createAccumulation=function(t){return new co(t,this._maxSize,this._recordMinMax)},r.prototype.merge=function(t,e){var n=e.clone();return n.merge(t),n},r.prototype.diff=function(t,e){var n=e.clone();return n.diff(t),n},r.prototype.toMetricData=function(t,e,n,o){return{descriptor:t,aggregationTemporality:e,dataPointType:x.EXPONENTIAL_HISTOGRAM,dataPoints:n.map(function(i){var u=ao(i,2),s=u[0],c=u[1],a=c.toPointValue(),l=t.type===v.GAUGE||t.type===v.UP_DOWN_COUNTER||t.type===v.OBSERVABLE_GAUGE||t.type===v.OBSERVABLE_UP_DOWN_COUNTER;return{attributes:s,startTime:c.startTime,endTime:o,value:{min:a.hasMinMax?a.min:void 0,max:a.hasMinMax?a.max:void 0,sum:l?void 0:a.sum,positive:{offset:a.positive.offset,bucketCounts:a.positive.bucketCounts},negative:{offset:a.negative.offset,bucketCounts:a.negative.bucketCounts},count:a.count,scale:a.scale,zeroCount:a.zeroCount}}})}},r}(),Fe=sn("OpenTelemetry SDK Context Key SUPPRESS_TRACING");function Ve(r){return r.setValue(Fe,!0)}function fo(r){return r.deleteValue(Fe)}function Xt(r){return r.getValue(Fe)===!0}var ho="=",Ae=";",Ut=",",oe="baggage",_o=180,po=4096,vo=8192,yo=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i};function mn(r){return r.reduce(function(t,e){var n=""+t+(t!==""?Ut:"")+e;return n.length>vo?t:n},"")}function gn(r){return r.getAllEntries().map(function(t){var e=yo(t,2),n=e[0],o=e[1],i=encodeURIComponent(n)+"="+encodeURIComponent(o.value);return o.metadata!==void 0&&(i+=Ae+o.metadata.toString()),i})}function Xe(r){var t=r.split(Ae);if(!(t.length<=0)){var e=t.shift();if(e){var n=e.indexOf(ho);if(!(n<=0)){var o=decodeURIComponent(e.substring(0,n).trim()),i=decodeURIComponent(e.substring(n+1).trim()),u;return t.length>0&&(u=Oi(t.join(Ae))),{key:o,value:i,metadata:u}}}}}function mo(r){return typeof r!="string"||r.length===0?{}:r.split(Ut).map(function(t){return Xe(t)}).filter(function(t){return t!==void 0&&t.value.length>0}).reduce(function(t,e){return t[e.key]=e.value,t},{})}var En=function(){function r(){}return r.prototype.inject=function(t,e,n){var o=D.getBaggage(t);if(!(!o||Xt(t))){var i=gn(o).filter(function(s){return s.length<=po}).slice(0,_o),u=mn(i);u.length>0&&n.set(e,oe,u)}},r.prototype.extract=function(t,e,n){var o=n.get(e,oe),i=Array.isArray(o)?o.join(Ut):o;if(!i)return t;var u={};if(i.length===0)return t;var s=i.split(Ut);return s.forEach(function(c){var a=Xe(c);if(a){var l={value:a.value};a.metadata&&(l.metadata=a.metadata),u[a.key]=l}}),Object.entries(u).length===0?t:D.setBaggage(t,D.createBaggage(u))},r.prototype.fields=function(){return[oe]},r}(),go=function(){function r(t,e){this._monotonicClock=e,this._epochMillis=t.now(),this._performanceMillis=e.now()}return r.prototype.now=function(){var t=this._monotonicClock.now()-this._performanceMillis;return this._epochMillis+t},r}(),Tn=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Eo=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i};function pt(r){var t,e,n={};if(typeof r!="object"||r==null)return n;try{for(var o=Tn(Object.entries(r)),i=o.next();!i.done;i=o.next()){var u=Eo(i.value,2),s=u[0],c=u[1];if(!Sn(s)){h.warn("Invalid attribute key: "+s);continue}if(!yt(c)){h.warn("Invalid attribute value set for key: "+s);continue}Array.isArray(c)?n[s]=c.slice():n[s]=c}}catch(a){t={error:a}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return n}function Sn(r){return typeof r=="string"&&r.length>0}function yt(r){return r==null?!0:Array.isArray(r)?To(r):bn(r)}function To(r){var t,e,n;try{for(var o=Tn(r),i=o.next();!i.done;i=o.next()){var u=i.value;if(u!=null){if(!n){if(bn(u)){n=typeof u;continue}return!1}if(typeof u!==n)return!1}}}catch(s){t={error:s}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return!0}function bn(r){switch(typeof r){case"number":case"boolean":case"string":return!0}return!1}function wn(){return function(r){h.error(So(r))}}function So(r){return typeof r=="string"?r:JSON.stringify(bo(r))}function bo(r){for(var t={},e=r;e!==null;)Object.getOwnPropertyNames(e).forEach(function(n){if(!t[n]){var o=e[n];o&&(t[n]=String(o))}}),e=Object.getPrototypeOf(e);return t}var On=wn();function wo(r){On=r}function w(r){try{On(r)}catch{}}var P;(function(r){r.AlwaysOff="always_off",r.AlwaysOn="always_on",r.ParentBasedAlwaysOff="parentbased_always_off",r.ParentBasedAlwaysOn="parentbased_always_on",r.ParentBasedTraceIdRatio="parentbased_traceidratio",r.TraceIdRatio="traceidratio"})(P||(P={}));var Oo=",",Ao=["OTEL_SDK_DISABLED"];function Ro(r){return Ao.indexOf(r)>-1}var Lo=["OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_BLRP_EXPORT_TIMEOUT","OTEL_BLRP_MAX_EXPORT_BATCH_SIZE","OTEL_BLRP_MAX_QUEUE_SIZE","OTEL_BLRP_SCHEDULE_DELAY","OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT","OTEL_EXPORTER_OTLP_TIMEOUT","OTEL_EXPORTER_OTLP_TRACES_TIMEOUT","OTEL_EXPORTER_OTLP_METRICS_TIMEOUT","OTEL_EXPORTER_OTLP_LOGS_TIMEOUT","OTEL_EXPORTER_JAEGER_AGENT_PORT"];function Po(r){return Lo.indexOf(r)>-1}var Co=["OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS","OTEL_SEMCONV_STABILITY_OPT_IN"];function xo(r){return Co.indexOf(r)>-1}var rt=1/0,nt=128,An=128,Rn=128,$e={OTEL_SDK_DISABLED:!1,CONTAINER_NAME:"",ECS_CONTAINER_METADATA_URI_V4:"",ECS_CONTAINER_METADATA_URI:"",HOSTNAME:"",KUBERNETES_SERVICE_HOST:"",NAMESPACE:"",OTEL_BSP_EXPORT_TIMEOUT:3e4,OTEL_BSP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BSP_MAX_QUEUE_SIZE:2048,OTEL_BSP_SCHEDULE_DELAY:5e3,OTEL_BLRP_EXPORT_TIMEOUT:3e4,OTEL_BLRP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BLRP_MAX_QUEUE_SIZE:2048,OTEL_BLRP_SCHEDULE_DELAY:5e3,OTEL_EXPORTER_JAEGER_AGENT_HOST:"",OTEL_EXPORTER_JAEGER_AGENT_PORT:6832,OTEL_EXPORTER_JAEGER_ENDPOINT:"",OTEL_EXPORTER_JAEGER_PASSWORD:"",OTEL_EXPORTER_JAEGER_USER:"",OTEL_EXPORTER_OTLP_ENDPOINT:"",OTEL_EXPORTER_OTLP_TRACES_ENDPOINT:"",OTEL_EXPORTER_OTLP_METRICS_ENDPOINT:"",OTEL_EXPORTER_OTLP_LOGS_ENDPOINT:"",OTEL_EXPORTER_OTLP_HEADERS:"",OTEL_EXPORTER_OTLP_TRACES_HEADERS:"",OTEL_EXPORTER_OTLP_METRICS_HEADERS:"",OTEL_EXPORTER_OTLP_LOGS_HEADERS:"",OTEL_EXPORTER_OTLP_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_TRACES_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_METRICS_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_LOGS_TIMEOUT:1e4,OTEL_EXPORTER_ZIPKIN_ENDPOINT:"http://localhost:9411/api/v2/spans",OTEL_LOG_LEVEL:C.INFO,OTEL_NO_PATCH_MODULES:[],OTEL_PROPAGATORS:["tracecontext","baggage"],OTEL_RESOURCE_ATTRIBUTES:"",OTEL_SERVICE_NAME:"",OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT:rt,OTEL_ATTRIBUTE_COUNT_LIMIT:nt,OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT:rt,OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT:nt,OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT:rt,OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT:nt,OTEL_SPAN_EVENT_COUNT_LIMIT:128,OTEL_SPAN_LINK_COUNT_LIMIT:128,OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT:An,OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT:Rn,OTEL_TRACES_EXPORTER:"",OTEL_TRACES_SAMPLER:P.ParentBasedAlwaysOn,OTEL_TRACES_SAMPLER_ARG:"",OTEL_LOGS_EXPORTER:"",OTEL_EXPORTER_OTLP_INSECURE:"",OTEL_EXPORTER_OTLP_TRACES_INSECURE:"",OTEL_EXPORTER_OTLP_METRICS_INSECURE:"",OTEL_EXPORTER_OTLP_LOGS_INSECURE:"",OTEL_EXPORTER_OTLP_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_COMPRESSION:"",OTEL_EXPORTER_OTLP_TRACES_COMPRESSION:"",OTEL_EXPORTER_OTLP_METRICS_COMPRESSION:"",OTEL_EXPORTER_OTLP_LOGS_COMPRESSION:"",OTEL_EXPORTER_OTLP_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_TRACES_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_LOGS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE:"cumulative",OTEL_SEMCONV_STABILITY_OPT_IN:[]};function Mo(r,t,e){if(!(typeof e[r]>"u")){var n=String(e[r]);t[r]=n.toLowerCase()==="true"}}function Io(r,t,e,n,o){if(n===void 0&&(n=-1/0),o===void 0&&(o=1/0),typeof e[r]<"u"){var i=Number(e[r]);isNaN(i)||(i<n?t[r]=n:i>o?t[r]=o:t[r]=i)}}function No(r,t,e,n){n===void 0&&(n=Oo);var o=e[r];typeof o=="string"&&(t[r]=o.split(n).map(function(i){return i.trim()}))}var Uo={ALL:C.ALL,VERBOSE:C.VERBOSE,DEBUG:C.DEBUG,INFO:C.INFO,WARN:C.WARN,ERROR:C.ERROR,NONE:C.NONE};function Do(r,t,e){var n=e[r];if(typeof n=="string"){var o=Uo[n.toUpperCase()];o!=null&&(t[r]=o)}}function ze(r){var t={};for(var e in $e){var n=e;switch(n){case"OTEL_LOG_LEVEL":Do(n,t,r);break;default:if(Ro(n))Mo(n,t,r);else if(Po(n))Io(n,t,r);else if(xo(n))No(n,t,r);else{var o=r[n];typeof o<"u"&&o!==null&&(t[n]=String(o))}}}return t}var it=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof global=="object"?global:{};function I(){var r=ze(it);return Object.assign({},$e,r)}function Ye(){return ze(it)}function yr(r){return r>=48&&r<=57?r-48:r>=97&&r<=102?r-87:r-55}function gt(r){for(var t=new Uint8Array(r.length/2),e=0,n=0;n<r.length;n+=2){var o=yr(r.charCodeAt(n)),i=yr(r.charCodeAt(n+1));t[e++]=o<<4|i}return t}var Bo=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},Ho=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))};function Go(r){return btoa(String.fromCharCode.apply(String,Ho([],Bo(gt(r)),!1)))}var jo=8,ko=16,Fo=function(){function r(){this.generateTraceId=mr(ko),this.generateSpanId=mr(jo)}return r}(),Tt=Array(32);function mr(r){return function(){for(var e=0;e<r*2;e++)Tt[e]=Math.floor(Math.random()*16)+48,Tt[e]>=58&&(Tt[e]+=39);return String.fromCharCode.apply(null,Tt.slice(0,r*2))}}var Y=performance,Ln="1.30.1",Vo="exception.type",Xo="exception.message",$o="exception.stacktrace",zo="http.method",Yo="http.url",Wo="http.host",Ko="http.scheme",qo="http.status_code",Qo="http.user_agent",Zo="http.request_content_length_uncompressed",Jo="http.response_content_length",ta="http.response_content_length_uncompressed",ae=Vo,ue=Xo,ea=$o,ra=zo,na=Yo,ia=Wo,oa=Ko,aa=qo,ua=Qo,sa=Zo,ca=Jo,la=ta,fa="process.runtime.name",da="service.name",ha="telemetry.sdk.name",_a="telemetry.sdk.language",pa="telemetry.sdk.version",va=fa,ya=da,Re=ha,Le=_a,Pe=pa,ma="webjs",ga=ma,tt,Lt=(tt={},tt[Re]="opentelemetry",tt[va]="browser",tt[Le]=ga,tt[Pe]=Ln,tt);function Ea(r){}var Pn=9,Ta=6,Sa=Math.pow(10,Ta),Dt=Math.pow(10,Pn);function R(r){var t=r/1e3,e=Math.trunc(t),n=Math.round(r%1e3*Sa);return[e,n]}function $t(){var r=Y.timeOrigin;if(typeof r!="number"){var t=Y;r=t.timing&&t.timing.fetchStart}return r}function mt(r){var t=R($t()),e=R(typeof r=="number"?r:Y.now());return We(t,e)}function F(r){if(zt(r))return r;if(typeof r=="number")return r<$t()?mt(r):R(r);if(r instanceof Date)return R(r.getTime());throw TypeError("Invalid input type")}function Cn(r,t){var e=t[0]-r[0],n=t[1]-r[1];return n<0&&(e-=1,n+=Dt),[e,n]}function ba(r){var t=Pn,e=""+"0".repeat(t)+r[1]+"Z",n=e.substring(e.length-t-1),o=new Date(r[0]*1e3).toISOString();return o.replace("000Z",n)}function M(r){return r[0]*Dt+r[1]}function wa(r){return r[0]*1e3+r[1]/1e6}function k(r){return r[0]*1e6+r[1]/1e3}function zt(r){return Array.isArray(r)&&r.length===2&&typeof r[0]=="number"&&typeof r[1]=="number"}function Ce(r){return zt(r)||typeof r=="number"||r instanceof Date}function We(r,t){var e=[r[0]+t[0],r[1]+t[1]];return e[1]>=Dt&&(e[1]-=Dt,e[0]+=1),e}var T;(function(r){r[r.SUCCESS=0]="SUCCESS",r[r.FAILED=1]="FAILED"})(T||(T={}));var Oa=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},xn=function(){function r(t){t===void 0&&(t={});var e;this._propagators=(e=t.propagators)!==null&&e!==void 0?e:[],this._fields=Array.from(new Set(this._propagators.map(function(n){return typeof n.fields=="function"?n.fields():[]}).reduce(function(n,o){return n.concat(o)},[])))}return r.prototype.inject=function(t,e,n){var o,i;try{for(var u=Oa(this._propagators),s=u.next();!s.done;s=u.next()){var c=s.value;try{c.inject(t,e,n)}catch(a){h.warn("Failed to inject with "+c.constructor.name+". Err: "+a.message)}}}catch(a){o={error:a}}finally{try{s&&!s.done&&(i=u.return)&&i.call(u)}finally{if(o)throw o.error}}},r.prototype.extract=function(t,e,n){return this._propagators.reduce(function(o,i){try{return i.extract(o,e,n)}catch(u){h.warn("Failed to extract with "+i.constructor.name+". Err: "+u.message)}return o},t)},r.prototype.fields=function(){return this._fields.slice()},r}(),xe="[_0-9a-z-*/]",Aa="[a-z]"+xe+"{0,255}",Ra="[a-z0-9]"+xe+"{0,240}@[a-z]"+xe+"{0,13}",La=new RegExp("^(?:"+Aa+"|"+Ra+")$"),Pa=/^[ -~]{0,255}[!-~]$/,Ca=/,|=/;function xa(r){return La.test(r)}function Ma(r){return Pa.test(r)&&!Ca.test(r)}var gr=32,Ia=512,Er=",",Tr="=",Mn=function(){function r(t){this._internalState=new Map,t&&this._parse(t)}return r.prototype.set=function(t,e){var n=this._clone();return n._internalState.has(t)&&n._internalState.delete(t),n._internalState.set(t,e),n},r.prototype.unset=function(t){var e=this._clone();return e._internalState.delete(t),e},r.prototype.get=function(t){return this._internalState.get(t)},r.prototype.serialize=function(){var t=this;return this._keys().reduce(function(e,n){return e.push(n+Tr+t.get(n)),e},[]).join(Er)},r.prototype._parse=function(t){t.length>Ia||(this._internalState=t.split(Er).reverse().reduce(function(e,n){var o=n.trim(),i=o.indexOf(Tr);if(i!==-1){var u=o.slice(0,i),s=o.slice(i+1,n.length);xa(u)&&Ma(s)&&e.set(u,s)}return e},new Map),this._internalState.size>gr&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,gr))))},r.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},r.prototype._clone=function(){var t=new r;return t._internalState=new Map(this._internalState),t},r}(),Pt="traceparent",Ct="tracestate",Na="00",Ua="(?!ff)[\\da-f]{2}",Da="(?![0]{32})[\\da-f]{32}",Ba="(?![0]{16})[\\da-f]{16}",Ha="[\\da-f]{2}",Ga=new RegExp("^\\s?("+Ua+")-("+Da+")-("+Ba+")-("+Ha+")(-.*)?\\s?$");function In(r){var t=Ga.exec(r);return!t||t[1]==="00"&&t[5]?null:{traceId:t[2],spanId:t[3],traceFlags:parseInt(t[4],16)}}var Nn=function(){function r(){}return r.prototype.inject=function(t,e,n){var o=A.getSpanContext(t);if(!(!o||Xt(t)||!Vt(o))){var i=Na+"-"+o.traceId+"-"+o.spanId+"-0"+Number(o.traceFlags||B.NONE).toString(16);n.set(e,Pt,i),o.traceState&&n.set(e,Ct,o.traceState.serialize())}},r.prototype.extract=function(t,e,n){var o=n.get(e,Pt);if(!o)return t;var i=Array.isArray(o)?o[0]:o;if(typeof i!="string")return t;var u=In(i);if(!u)return t;u.isRemote=!0;var s=n.get(e,Ct);if(s){var c=Array.isArray(s)?s.join(","):s;u.traceState=new Mn(typeof c=="string"?c:void 0)}return A.setSpanContext(t,u)},r.prototype.fields=function(){return[Pt,Ct]},r}(),Ke=sn("OpenTelemetry SDK Context Key RPC_METADATA"),Me;(function(r){r.HTTP="http"})(Me||(Me={}));function ja(r,t){return r.setValue(Ke,t)}function ka(r){return r.deleteValue(Ke)}function Fa(r){return r.getValue(Ke)}var Ie=function(){function r(){}return r.prototype.shouldSample=function(){return{decision:ut.NOT_RECORD}},r.prototype.toString=function(){return"AlwaysOffSampler"},r}(),xt=function(){function r(){}return r.prototype.shouldSample=function(){return{decision:ut.RECORD_AND_SAMPLED}},r.prototype.toString=function(){return"AlwaysOnSampler"},r}(),Va=function(){function r(t){var e,n,o,i;this._root=t.root,this._root||(w(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new xt),this._remoteParentSampled=(e=t.remoteParentSampled)!==null&&e!==void 0?e:new xt,this._remoteParentNotSampled=(n=t.remoteParentNotSampled)!==null&&n!==void 0?n:new Ie,this._localParentSampled=(o=t.localParentSampled)!==null&&o!==void 0?o:new xt,this._localParentNotSampled=(i=t.localParentNotSampled)!==null&&i!==void 0?i:new Ie}return r.prototype.shouldSample=function(t,e,n,o,i,u){var s=A.getSpanContext(t);return!s||!Vt(s)?this._root.shouldSample(t,e,n,o,i,u):s.isRemote?s.traceFlags&B.SAMPLED?this._remoteParentSampled.shouldSample(t,e,n,o,i,u):this._remoteParentNotSampled.shouldSample(t,e,n,o,i,u):s.traceFlags&B.SAMPLED?this._localParentSampled.shouldSample(t,e,n,o,i,u):this._localParentNotSampled.shouldSample(t,e,n,o,i,u)},r.prototype.toString=function(){return"ParentBased{root="+this._root.toString()+", remoteParentSampled="+this._remoteParentSampled.toString()+", remoteParentNotSampled="+this._remoteParentNotSampled.toString()+", localParentSampled="+this._localParentSampled.toString()+", localParentNotSampled="+this._localParentNotSampled.toString()+"}"},r}(),Xa=function(){function r(t){t===void 0&&(t=0),this._ratio=t,this._ratio=this._normalize(t),this._upperBound=Math.floor(this._ratio*4294967295)}return r.prototype.shouldSample=function(t,e){return{decision:cn(e)&&this._accumulate(e)<this._upperBound?ut.RECORD_AND_SAMPLED:ut.NOT_RECORD}},r.prototype.toString=function(){return"TraceIdRatioBased{"+this._ratio+"}"},r.prototype._normalize=function(t){return typeof t!="number"||isNaN(t)?0:t>=1?1:t<=0?0:t},r.prototype._accumulate=function(t){for(var e=0,n=0;n<t.length/8;n++){var o=n*8,i=parseInt(t.slice(o,o+8),16);e=(e^i)>>>0}return e},r}(),$a="[object Object]",za="[object Null]",Ya="[object Undefined]",Wa=Function.prototype,Un=Wa.toString,Ka=Un.call(Object),qa=Qa(Object.getPrototypeOf,Object),Dn=Object.prototype,Bn=Dn.hasOwnProperty,$=Symbol?Symbol.toStringTag:void 0,Hn=Dn.toString;function Qa(r,t){return function(e){return r(t(e))}}function Sr(r){if(!Za(r)||Ja(r)!==$a)return!1;var t=qa(r);if(t===null)return!0;var e=Bn.call(t,"constructor")&&t.constructor;return typeof e=="function"&&e instanceof e&&Un.call(e)===Ka}function Za(r){return r!=null&&typeof r=="object"}function Ja(r){return r==null?r===void 0?Ya:za:$&&$ in Object(r)?tu(r):eu(r)}function tu(r){var t=Bn.call(r,$),e=r[$],n=!1;try{r[$]=void 0,n=!0}catch{}var o=Hn.call(r);return n&&(t?r[$]=e:delete r[$]),o}function eu(r){return Hn.call(r)}var ru=20;function qe(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];for(var e=r.shift(),n=new WeakMap;r.length>0;)e=Gn(e,r.shift(),0,n);return e}function se(r){return Bt(r)?r.slice():r}function Gn(r,t,e,n){e===void 0&&(e=0);var o;if(!(e>ru)){if(e++,Mt(r)||Mt(t)||jn(t))o=se(t);else if(Bt(r)){if(o=r.slice(),Bt(t))for(var i=0,u=t.length;i<u;i++)o.push(se(t[i]));else if(dt(t))for(var s=Object.keys(t),i=0,u=s.length;i<u;i++){var c=s[i];o[c]=se(t[c])}}else if(dt(r))if(dt(t)){if(!nu(r,t))return t;o=Object.assign({},r);for(var s=Object.keys(t),i=0,u=s.length;i<u;i++){var c=s[i],a=t[c];if(Mt(a))typeof a>"u"?delete o[c]:o[c]=a;else{var l=o[c],f=a;if(br(r,c,n)||br(t,c,n))delete o[c];else{if(dt(l)&&dt(f)){var d=n.get(l)||[],_=n.get(f)||[];d.push({obj:r,key:c}),_.push({obj:t,key:c}),n.set(l,d),n.set(f,_)}o[c]=Gn(o[c],a,e,n)}}}}else o=t;return o}}function br(r,t,e){for(var n=e.get(r[t])||[],o=0,i=n.length;o<i;o++){var u=n[o];if(u.key===t&&u.obj===r)return!0}return!1}function Bt(r){return Array.isArray(r)}function jn(r){return typeof r=="function"}function dt(r){return!Mt(r)&&!Bt(r)&&!jn(r)&&typeof r=="object"}function Mt(r){return typeof r=="string"||typeof r=="number"||typeof r=="boolean"||typeof r>"u"||r instanceof Date||r instanceof RegExp||r===null}function nu(r,t){return!(!Sr(r)||!Sr(t))}var iu=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),kn=function(r){iu(t,r);function t(e){var n=r.call(this,e)||this;return Object.setPrototypeOf(n,t.prototype),n}return t}(Error);function Qe(r,t){var e,n=new Promise(function(i,u){e=setTimeout(function(){u(new kn("Operation timed out."))},t)});return Promise.race([r,n]).then(function(o){return clearTimeout(e),o},function(o){throw clearTimeout(e),o})}var ou=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function Ze(r,t){return typeof t=="string"?r===t:!!r.match(t)}function Fn(r,t){var e,n;if(!t)return!1;try{for(var o=ou(t),i=o.next();!i.done;i=o.next()){var u=i.value;if(Ze(r,u))return!0}}catch(s){e={error:s}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return!1}function au(r){return typeof r=="function"&&typeof r.__original=="function"&&typeof r.__unwrap=="function"&&r.__wrapped===!0}var uu=function(){function r(){var t=this;this._promise=new Promise(function(e,n){t._resolve=e,t._reject=n})}return Object.defineProperty(r.prototype,"promise",{get:function(){return this._promise},enumerable:!1,configurable:!0}),r.prototype.resolve=function(t){this._resolve(t)},r.prototype.reject=function(t){this._reject(t)},r}(),su=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},cu=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},ct=function(){function r(t,e){this._callback=t,this._that=e,this._isCalled=!1,this._deferred=new uu}return Object.defineProperty(r.prototype,"isCalled",{get:function(){return this._isCalled},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"promise",{get:function(){return this._deferred.promise},enumerable:!1,configurable:!0}),r.prototype.call=function(){for(var t,e=this,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];if(!this._isCalled){this._isCalled=!0;try{Promise.resolve((t=this._callback).call.apply(t,cu([this._that],su(n),!1))).then(function(i){return e._deferred.resolve(i)},function(i){return e._deferred.reject(i)})}catch(i){this._deferred.reject(i)}}return this._deferred.promise},r}();function lu(r,t){return new Promise(function(e){b.with(Ve(b.active()),function(){r.export(t,function(n){e(n)})})})}var fu={getKeyPairs:gn,serializeKeyPairs:mn,parseKeyPairsIntoRecord:mo,parsePairKeyValue:Xe},Yt={_export:lu};const du=Object.freeze(Object.defineProperty({__proto__:null,AlwaysOffSampler:Ie,AlwaysOnSampler:xt,AnchoredClock:go,BindOnceFuture:ct,CompositePropagator:xn,DEFAULT_ATTRIBUTE_COUNT_LIMIT:nt,DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT:rt,DEFAULT_ENVIRONMENT:$e,DEFAULT_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT:An,DEFAULT_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT:Rn,get ExportResultCode(){return T},ParentBasedSampler:Va,get RPCType(){return Me},RandomIdGenerator:Fo,SDK_INFO:Lt,TRACE_PARENT_HEADER:Pt,TRACE_STATE_HEADER:Ct,TimeoutError:kn,TraceIdRatioBasedSampler:Xa,TraceState:Mn,get TracesSamplerValues(){return P},VERSION:Ln,W3CBaggagePropagator:En,W3CTraceContextPropagator:Nn,_globalThis:it,addHrTimes:We,baggageUtils:fu,callWithTimeout:Qe,deleteRPCMetadata:ka,getEnv:I,getEnvWithoutDefaults:Ye,getRPCMetadata:Fa,getTimeOrigin:$t,globalErrorHandler:w,hexToBase64:Go,hexToBinary:gt,hrTime:mt,hrTimeDuration:Cn,hrTimeToMicroseconds:k,hrTimeToMilliseconds:wa,hrTimeToNanoseconds:M,hrTimeToTimeStamp:ba,internal:Yt,isAttributeKey:Sn,isAttributeValue:yt,isTimeInput:Ce,isTimeInputHrTime:zt,isTracingSuppressed:Xt,isUrlIgnored:Fn,isWrapped:au,loggingErrorHandler:wn,merge:qe,millisToHrTime:R,otperformance:Y,parseEnvironment:ze,parseTraceParent:In,sanitizeAttributes:pt,setGlobalErrorHandler:wo,setRPCMetadata:ja,suppressTracing:Ve,timeInputToHrTime:F,unrefTimer:Ea,unsuppressTracing:fo,urlMatches:Ze},Symbol.toStringTag,{value:"Module"}));var hu=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},ce=function(){function r(t,e,n){e===void 0&&(e=0),n===void 0&&(n=[0,0]),this.startTime=t,this._current=e,this.sampleTime=n}return r.prototype.record=function(t){this._current=t,this.sampleTime=R(Date.now())},r.prototype.setStartTime=function(t){this.startTime=t},r.prototype.toPointValue=function(){return this._current},r}(),_u=function(){function r(){this.kind=K.LAST_VALUE}return r.prototype.createAccumulation=function(t){return new ce(t)},r.prototype.merge=function(t,e){var n=k(e.sampleTime)>=k(t.sampleTime)?e:t;return new ce(t.startTime,n.toPointValue(),n.sampleTime)},r.prototype.diff=function(t,e){var n=k(e.sampleTime)>=k(t.sampleTime)?e:t;return new ce(e.startTime,n.toPointValue(),n.sampleTime)},r.prototype.toMetricData=function(t,e,n,o){return{descriptor:t,aggregationTemporality:e,dataPointType:x.GAUGE,dataPoints:n.map(function(i){var u=hu(i,2),s=u[0],c=u[1];return{attributes:s,startTime:c.startTime,endTime:o,value:c.toPointValue()}})}},r}(),pu=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},ht=function(){function r(t,e,n,o){n===void 0&&(n=0),o===void 0&&(o=!1),this.startTime=t,this.monotonic=e,this._current=n,this.reset=o}return r.prototype.record=function(t){this.monotonic&&t<0||(this._current+=t)},r.prototype.setStartTime=function(t){this.startTime=t},r.prototype.toPointValue=function(){return this._current},r}(),wr=function(){function r(t){this.monotonic=t,this.kind=K.SUM}return r.prototype.createAccumulation=function(t){return new ht(t,this.monotonic)},r.prototype.merge=function(t,e){var n=t.toPointValue(),o=e.toPointValue();return e.reset?new ht(e.startTime,this.monotonic,o,e.reset):new ht(t.startTime,this.monotonic,n+o)},r.prototype.diff=function(t,e){var n=t.toPointValue(),o=e.toPointValue();return this.monotonic&&n>o?new ht(e.startTime,this.monotonic,o,!0):new ht(e.startTime,this.monotonic,o-n)},r.prototype.toMetricData=function(t,e,n,o){return{descriptor:t,aggregationTemporality:e,dataPointType:x.SUM,dataPoints:n.map(function(i){var u=pu(i,2),s=u[0],c=u[1];return{attributes:s,startTime:c.startTime,endTime:o,value:c.toPointValue()}}),isMonotonic:this.monotonic}},r}(),Q=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),N=function(){function r(){}return r.Drop=function(){return $n},r.Sum=function(){return zn},r.LastValue=function(){return Yn},r.Histogram=function(){return Wn},r.ExponentialHistogram=function(){return Tu},r.Default=function(){return Su},r}(),vu=function(r){Q(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.createAggregator=function(e){return t.DEFAULT_INSTANCE},t.DEFAULT_INSTANCE=new Xi,t}(N),yu=function(r){Q(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.createAggregator=function(e){switch(e.type){case v.COUNTER:case v.OBSERVABLE_COUNTER:case v.HISTOGRAM:return t.MONOTONIC_INSTANCE;default:return t.NON_MONOTONIC_INSTANCE}},t.MONOTONIC_INSTANCE=new wr(!0),t.NON_MONOTONIC_INSTANCE=new wr(!1),t}(N),mu=function(r){Q(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.createAggregator=function(e){return t.DEFAULT_INSTANCE},t.DEFAULT_INSTANCE=new _u,t}(N),gu=function(r){Q(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.createAggregator=function(e){return t.DEFAULT_INSTANCE},t.DEFAULT_INSTANCE=new dn([0,5,10,25,50,75,100,250,500,750,1e3,2500,5e3,7500,1e4],!0),t}(N),Vn=function(r){Q(t,r);function t(e,n){n===void 0&&(n=!0);var o=r.call(this)||this;if(o._recordMinMax=n,e==null)throw new Error("ExplicitBucketHistogramAggregation should be created with explicit boundaries, if a single bucket histogram is required, please pass an empty array");e=e.concat(),e=e.sort(function(s,c){return s-c});var i=e.lastIndexOf(-1/0),u=e.indexOf(1/0);return u===-1&&(u=void 0),o._boundaries=e.slice(i+1,u),o}return t.prototype.createAggregator=function(e){return new dn(this._boundaries,this._recordMinMax)},t}(N),Xn=function(r){Q(t,r);function t(e,n){e===void 0&&(e=160),n===void 0&&(n=!0);var o=r.call(this)||this;return o._maxSize=e,o._recordMinMax=n,o}return t.prototype.createAggregator=function(e){return new lo(this._maxSize,this._recordMinMax)},t}(N),Eu=function(r){Q(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype._resolve=function(e){switch(e.type){case v.COUNTER:case v.UP_DOWN_COUNTER:case v.OBSERVABLE_COUNTER:case v.OBSERVABLE_UP_DOWN_COUNTER:return zn;case v.GAUGE:case v.OBSERVABLE_GAUGE:return Yn;case v.HISTOGRAM:return e.advice.explicitBucketBoundaries?new Vn(e.advice.explicitBucketBoundaries):Wn}return h.warn("Unable to recognize instrument type: "+e.type),$n},t.prototype.createAggregator=function(e){return this._resolve(e).createAggregator(e)},t}(N),$n=new vu,zn=new yu,Yn=new mu,Wn=new gu,Tu=new Xn,Su=new Eu,bu=function(r){return N.Default()},Kn=function(r){return L.CUMULATIVE},le=function(r,t,e,n){function o(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function s(l){try{a(n.next(l))}catch(f){u(f)}}function c(l){try{a(n.throw(l))}catch(f){u(f)}}function a(l){l.done?i(l.value):o(l.value).then(s,c)}a((n=n.apply(r,t||[])).next())})},fe=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(l){return c([a,l])}}function c(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,o=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(l){a=[6,l],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Or=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},wu=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},Ou=function(){function r(t){var e,n,o;this._shutdown=!1,this._aggregationSelector=(e=t==null?void 0:t.aggregationSelector)!==null&&e!==void 0?e:bu,this._aggregationTemporalitySelector=(n=t==null?void 0:t.aggregationTemporalitySelector)!==null&&n!==void 0?n:Kn,this._metricProducers=(o=t==null?void 0:t.metricProducers)!==null&&o!==void 0?o:[],this._cardinalitySelector=t==null?void 0:t.cardinalitySelector}return r.prototype.setMetricProducer=function(t){if(this._sdkMetricProducer)throw new Error("MetricReader can not be bound to a MeterProvider again.");this._sdkMetricProducer=t,this.onInitialized()},r.prototype.selectAggregation=function(t){return this._aggregationSelector(t)},r.prototype.selectAggregationTemporality=function(t){return this._aggregationTemporalitySelector(t)},r.prototype.selectCardinalityLimit=function(t){return this._cardinalitySelector?this._cardinalitySelector(t):2e3},r.prototype.onInitialized=function(){},r.prototype.collect=function(t){return le(this,void 0,void 0,function(){var e,n,o,i,u,s;return fe(this,function(c){switch(c.label){case 0:if(this._sdkMetricProducer===void 0)throw new Error("MetricReader is not bound to a MetricProducer");if(this._shutdown)throw new Error("MetricReader is shutdown");return[4,Promise.all(wu([this._sdkMetricProducer.collect({timeoutMillis:t==null?void 0:t.timeoutMillis})],Or(this._metricProducers.map(function(a){return a.collect({timeoutMillis:t==null?void 0:t.timeoutMillis})})),!1))];case 1:return e=Or.apply(void 0,[c.sent()]),n=e[0],o=e.slice(1),i=n.errors.concat(dr(o,function(a){return a.errors})),u=n.resourceMetrics.resource,s=n.resourceMetrics.scopeMetrics.concat(dr(o,function(a){return a.resourceMetrics.scopeMetrics})),[2,{resourceMetrics:{resource:u,scopeMetrics:s},errors:i}]}})})},r.prototype.shutdown=function(t){return le(this,void 0,void 0,function(){return fe(this,function(e){switch(e.label){case 0:return this._shutdown?(h.error("Cannot call shutdown twice."),[2]):(t==null?void 0:t.timeoutMillis)!=null?[3,2]:[4,this.onShutdown()];case 1:return e.sent(),[3,4];case 2:return[4,Nt(this.onShutdown(),t.timeoutMillis)];case 3:e.sent(),e.label=4;case 4:return this._shutdown=!0,[2]}})})},r.prototype.forceFlush=function(t){return le(this,void 0,void 0,function(){return fe(this,function(e){switch(e.label){case 0:return this._shutdown?(h.warn("Cannot forceFlush on already shutdown MetricReader."),[2]):(t==null?void 0:t.timeoutMillis)!=null?[3,2]:[4,this.onForceFlush()];case 1:return e.sent(),[2];case 2:return[4,Nt(this.onForceFlush(),t.timeoutMillis)];case 3:return e.sent(),[2]}})})},r}(),Ar=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Au=function(){function r(t){var e;this._shutdown=!1,this._temporalitySelector=(e=t==null?void 0:t.temporalitySelector)!==null&&e!==void 0?e:Kn}return r.prototype.export=function(t,e){if(this._shutdown){setImmediate(e,{code:T.FAILED});return}return r._sendMetrics(t,e)},r.prototype.forceFlush=function(){return Promise.resolve()},r.prototype.selectAggregationTemporality=function(t){return this._temporalitySelector(t)},r.prototype.shutdown=function(){return this._shutdown=!0,Promise.resolve()},r._sendMetrics=function(t,e){var n,o,i,u;try{for(var s=Ar(t.scopeMetrics),c=s.next();!c.done;c=s.next()){var a=c.value;try{for(var l=(i=void 0,Ar(a.metrics)),f=l.next();!f.done;f=l.next()){var d=f.value;console.dir({descriptor:d.descriptor,dataPointType:d.dataPointType,dataPoints:d.dataPoints},{depth:null})}}catch(_){i={error:_}}finally{try{f&&!f.done&&(u=l.return)&&u.call(l)}finally{if(i)throw i.error}}}}catch(_){n={error:_}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}e({code:T.SUCCESS})},r}();function Ru(){return"unknown_service"}var j=function(){return j=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},j.apply(this,arguments)},Lu=function(r,t,e,n){function o(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function s(l){try{a(n.next(l))}catch(f){u(f)}}function c(l){try{a(n.throw(l))}catch(f){u(f)}}function a(l){l.done?i(l.value):o(l.value).then(s,c)}a((n=n.apply(r,t||[])).next())})},Pu=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(l){return c([a,l])}}function c(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,o=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(l){a=[6,l],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Cu=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},H=function(){function r(t,e){var n=this,o;this._attributes=t,this.asyncAttributesPending=e!=null,this._syncAttributes=(o=this._attributes)!==null&&o!==void 0?o:{},this._asyncAttributesPromise=e==null?void 0:e.then(function(i){return n._attributes=Object.assign({},n._attributes,i),n.asyncAttributesPending=!1,i},function(i){return h.debug("a resource's async attributes promise rejected: %s",i),n.asyncAttributesPending=!1,{}})}return r.empty=function(){return r.EMPTY},r.default=function(){var t;return new r((t={},t[ya]=Ru(),t[Le]=Lt[Le],t[Re]=Lt[Re],t[Pe]=Lt[Pe],t))},Object.defineProperty(r.prototype,"attributes",{get:function(){var t;return this.asyncAttributesPending&&h.error("Accessing resource attributes before async attributes settled"),(t=this._attributes)!==null&&t!==void 0?t:{}},enumerable:!1,configurable:!0}),r.prototype.waitForAsyncAttributes=function(){return Lu(this,void 0,void 0,function(){return Pu(this,function(t){switch(t.label){case 0:return this.asyncAttributesPending?[4,this._asyncAttributesPromise]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},r.prototype.merge=function(t){var e=this,n;if(!t)return this;var o=j(j({},this._syncAttributes),(n=t._syncAttributes)!==null&&n!==void 0?n:t.attributes);if(!this._asyncAttributesPromise&&!t._asyncAttributesPromise)return new r(o);var i=Promise.all([this._asyncAttributesPromise,t._asyncAttributesPromise]).then(function(u){var s,c=Cu(u,2),a=c[0],l=c[1];return j(j(j(j({},e._syncAttributes),a),(s=t._syncAttributes)!==null&&s!==void 0?s:t.attributes),l)});return new r(o,i)},r.EMPTY=new r({}),r}(),xu=function(){function r(){this._registeredViews=[]}return r.prototype.addView=function(t){this._registeredViews.push(t)},r.prototype.findViews=function(t,e){var n=this,o=this._registeredViews.filter(function(i){return n._matchInstrument(i.instrumentSelector,t)&&n._matchMeter(i.meterSelector,e)});return o},r.prototype._matchInstrument=function(t,e){return(t.getType()===void 0||e.type===t.getType())&&t.getNameFilter().match(e.name)&&t.getUnitFilter().match(e.unit)},r.prototype._matchMeter=function(t,e){return t.getNameFilter().match(e.name)&&(e.version===void 0||t.getVersionFilter().match(e.version))&&(e.schemaUrl===void 0||t.getSchemaUrlFilter().match(e.schemaUrl))},r}(),Z=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Wt=function(){function r(t,e){this._writableMetricStorage=t,this._descriptor=e}return r.prototype._record=function(t,e,n){if(e===void 0&&(e={}),n===void 0&&(n=b.active()),typeof t!="number"){h.warn("non-number value provided to metric "+this._descriptor.name+": "+t);return}this._descriptor.valueType===at.INT&&!Number.isInteger(t)&&(h.warn("INT value type cannot accept a floating-point value for "+this._descriptor.name+", ignoring the fractional digits."),t=Math.trunc(t),!Number.isInteger(t))||this._writableMetricStorage.record(t,e,n,R(Date.now()))},r}(),Mu=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.add=function(e,n,o){this._record(e,n,o)},t}(Wt),Iu=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.add=function(e,n,o){if(e<0){h.warn("negative value provided to counter "+this._descriptor.name+": "+e);return}this._record(e,n,o)},t}(Wt),Nu=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.record=function(e,n,o){this._record(e,n,o)},t}(Wt),Uu=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.record=function(e,n,o){if(e<0){h.warn("negative value provided to histogram "+this._descriptor.name+": "+e);return}this._record(e,n,o)},t}(Wt),Kt=function(){function r(t,e,n){this._observableRegistry=n,this._descriptor=t,this._metricStorages=e}return r.prototype.addCallback=function(t){this._observableRegistry.addCallback(t,this)},r.prototype.removeCallback=function(t){this._observableRegistry.removeCallback(t,this)},r}(),Du=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(Kt),Bu=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(Kt),Hu=function(r){Z(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t}(Kt);function Ne(r){return r instanceof Kt}var Gu=function(){function r(t){this._meterSharedState=t}return r.prototype.createGauge=function(t,e){var n=G(t,v.GAUGE,e),o=this._meterSharedState.registerMetricStorage(n);return new Nu(o,n)},r.prototype.createHistogram=function(t,e){var n=G(t,v.HISTOGRAM,e),o=this._meterSharedState.registerMetricStorage(n);return new Uu(o,n)},r.prototype.createCounter=function(t,e){var n=G(t,v.COUNTER,e),o=this._meterSharedState.registerMetricStorage(n);return new Iu(o,n)},r.prototype.createUpDownCounter=function(t,e){var n=G(t,v.UP_DOWN_COUNTER,e),o=this._meterSharedState.registerMetricStorage(n);return new Mu(o,n)},r.prototype.createObservableGauge=function(t,e){var n=G(t,v.OBSERVABLE_GAUGE,e),o=this._meterSharedState.registerAsyncMetricStorage(n);return new Bu(n,o,this._meterSharedState.observableRegistry)},r.prototype.createObservableCounter=function(t,e){var n=G(t,v.OBSERVABLE_COUNTER,e),o=this._meterSharedState.registerAsyncMetricStorage(n);return new Du(n,o,this._meterSharedState.observableRegistry)},r.prototype.createObservableUpDownCounter=function(t,e){var n=G(t,v.OBSERVABLE_UP_DOWN_COUNTER,e),o=this._meterSharedState.registerAsyncMetricStorage(n);return new Hu(n,o,this._meterSharedState.observableRegistry)},r.prototype.addBatchObservableCallback=function(t,e){this._meterSharedState.observableRegistry.addBatchCallback(t,e)},r.prototype.removeBatchObservableCallback=function(t,e){this._meterSharedState.observableRegistry.removeBatchCallback(t,e)},r}(),qn=function(){function r(t){this._instrumentDescriptor=t}return r.prototype.getInstrumentDescriptor=function(){return this._instrumentDescriptor},r.prototype.updateDescription=function(t){this._instrumentDescriptor=G(this._instrumentDescriptor.name,this._instrumentDescriptor.type,{description:t,valueType:this._instrumentDescriptor.valueType,unit:this._instrumentDescriptor.unit,advice:this._instrumentDescriptor.advice})},r}(),ju=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Rr=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(l){return c([a,l])}}function c(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,o=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(l){a=[6,l],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},ku=function(){function r(t){this._hash=t,this._valueMap=new Map,this._keyMap=new Map}return r.prototype.get=function(t,e){return e??(e=this._hash(t)),this._valueMap.get(e)},r.prototype.getOrDefault=function(t,e){var n=this._hash(t);if(this._valueMap.has(n))return this._valueMap.get(n);var o=e();return this._keyMap.has(n)||this._keyMap.set(n,t),this._valueMap.set(n,o),o},r.prototype.set=function(t,e,n){n??(n=this._hash(t)),this._keyMap.has(n)||this._keyMap.set(n,t),this._valueMap.set(n,e)},r.prototype.has=function(t,e){return e??(e=this._hash(t)),this._valueMap.has(e)},r.prototype.keys=function(){var t,e;return Rr(this,function(n){switch(n.label){case 0:t=this._keyMap.entries(),e=t.next(),n.label=1;case 1:return e.done===!0?[3,3]:[4,[e.value[1],e.value[0]]];case 2:return n.sent(),e=t.next(),[3,1];case 3:return[2]}})},r.prototype.entries=function(){var t,e;return Rr(this,function(n){switch(n.label){case 0:t=this._valueMap.entries(),e=t.next(),n.label=1;case 1:return e.done===!0?[3,3]:[4,[this._keyMap.get(e.value[0]),e.value[1],e.value[0]]];case 2:return n.sent(),e=t.next(),[3,1];case 3:return[2]}})},Object.defineProperty(r.prototype,"size",{get:function(){return this._valueMap.size},enumerable:!1,configurable:!0}),r}(),W=function(r){ju(t,r);function t(){return r.call(this,fn)||this}return t}(ku),Fu=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},Qn=function(){function r(t,e){this._aggregator=t,this._activeCollectionStorage=new W,this._cumulativeMemoStorage=new W,this._overflowAttributes={"otel.metric.overflow":!0},this._cardinalityLimit=(e??2e3)-1,this._overflowHashCode=fn(this._overflowAttributes)}return r.prototype.record=function(t,e,n,o){var i=this,u=this._activeCollectionStorage.get(e);if(!u){if(this._activeCollectionStorage.size>=this._cardinalityLimit){var s=this._activeCollectionStorage.getOrDefault(this._overflowAttributes,function(){return i._aggregator.createAccumulation(o)});s==null||s.record(t);return}u=this._aggregator.createAccumulation(o),this._activeCollectionStorage.set(e,u)}u==null||u.record(t)},r.prototype.batchCumulate=function(t,e){var n=this;Array.from(t.entries()).forEach(function(o){var i=Fu(o,3),u=i[0],s=i[1],c=i[2],a=n._aggregator.createAccumulation(e);a==null||a.record(s);var l=a;if(n._cumulativeMemoStorage.has(u,c)){var f=n._cumulativeMemoStorage.get(u,c);l=n._aggregator.diff(f,a)}else if(n._cumulativeMemoStorage.size>=n._cardinalityLimit&&(u=n._overflowAttributes,c=n._overflowHashCode,n._cumulativeMemoStorage.has(u,c))){var f=n._cumulativeMemoStorage.get(u,c);l=n._aggregator.diff(f,a)}if(n._activeCollectionStorage.has(u,c)){var d=n._activeCollectionStorage.get(u,c);l=n._aggregator.merge(d,l)}n._cumulativeMemoStorage.set(u,a,c),n._activeCollectionStorage.set(u,l,c)})},r.prototype.collect=function(){var t=this._activeCollectionStorage;return this._activeCollectionStorage=new W,t},r}(),de=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Lr=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},Zn=function(){function r(t,e){var n=this;this._aggregator=t,this._unreportedAccumulations=new Map,this._reportHistory=new Map,e.forEach(function(o){n._unreportedAccumulations.set(o,[])})}return r.prototype.buildMetrics=function(t,e,n,o){this._stashAccumulations(n);var i=this._getMergedUnreportedAccumulations(t),u=i,s;if(this._reportHistory.has(t)){var c=this._reportHistory.get(t),a=c.collectionTime;s=c.aggregationTemporality,s===L.CUMULATIVE?u=r.merge(c.accumulations,i,this._aggregator):u=r.calibrateStartTime(c.accumulations,i,a)}else s=t.selectAggregationTemporality(e.type);this._reportHistory.set(t,{accumulations:u,collectionTime:o,aggregationTemporality:s});var l=Vu(u);if(l.length!==0)return this._aggregator.toMetricData(e,s,l,o)},r.prototype._stashAccumulations=function(t){var e,n,o=this._unreportedAccumulations.keys();try{for(var i=de(o),u=i.next();!u.done;u=i.next()){var s=u.value,c=this._unreportedAccumulations.get(s);c===void 0&&(c=[],this._unreportedAccumulations.set(s,c)),c.push(t)}}catch(a){e={error:a}}finally{try{u&&!u.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}},r.prototype._getMergedUnreportedAccumulations=function(t){var e,n,o=new W,i=this._unreportedAccumulations.get(t);if(this._unreportedAccumulations.set(t,[]),i===void 0)return o;try{for(var u=de(i),s=u.next();!s.done;s=u.next()){var c=s.value;o=r.merge(o,c,this._aggregator)}}catch(a){e={error:a}}finally{try{s&&!s.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}return o},r.merge=function(t,e,n){for(var o=t,i=e.entries(),u=i.next();u.done!==!0;){var s=Lr(u.value,3),c=s[0],a=s[1],l=s[2];if(t.has(c,l)){var f=t.get(c,l),d=n.merge(f,a);o.set(c,d,l)}else o.set(c,a,l);u=i.next()}return o},r.calibrateStartTime=function(t,e,n){var o,i;try{for(var u=de(t.keys()),s=u.next();!s.done;s=u.next()){var c=Lr(s.value,2),a=c[0],l=c[1],f=e.get(a,l);f==null||f.setStartTime(n)}}catch(d){o={error:d}}finally{try{s&&!s.done&&(i=u.return)&&i.call(u)}finally{if(o)throw o.error}}return e},r}();function Vu(r){return Array.from(r.entries())}var Xu=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),$u=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},zu=function(r){Xu(t,r);function t(e,n,o,i,u){var s=r.call(this,e)||this;return s._attributesProcessor=o,s._aggregationCardinalityLimit=u,s._deltaMetricStorage=new Qn(n,s._aggregationCardinalityLimit),s._temporalMetricStorage=new Zn(n,i),s}return t.prototype.record=function(e,n){var o=this,i=new W;Array.from(e.entries()).forEach(function(u){var s=$u(u,2),c=s[0],a=s[1];i.set(o._attributesProcessor.process(c),a)}),this._deltaMetricStorage.batchCumulate(i,n)},t.prototype.collect=function(e,n){var o=this._deltaMetricStorage.collect();return this._temporalMetricStorage.buildMetrics(e,this._instrumentDescriptor,o,n)},t}(qn);function Pr(r,t){var e="";return r.unit!==t.unit&&(e+="	- Unit '"+r.unit+"' does not match '"+t.unit+`'
`),r.type!==t.type&&(e+="	- Type '"+r.type+"' does not match '"+t.type+`'
`),r.valueType!==t.valueType&&(e+="	- Value Type '"+r.valueType+"' does not match '"+t.valueType+`'
`),r.description!==t.description&&(e+="	- Description '"+r.description+"' does not match '"+t.description+`'
`),e}function Yu(r,t){return"	- use valueType '"+r.valueType+"' on instrument creation or use an instrument name other than '"+t.name+"'"}function Wu(r,t){return"	- use unit '"+r.unit+"' on instrument creation or use an instrument name other than '"+t.name+"'"}function Ku(r,t){var e={name:t.name,type:t.type,unit:t.unit},n=JSON.stringify(e);return"	- create a new view with a name other than '"+r.name+"' and InstrumentSelector '"+n+"'"}function qu(r,t){var e={name:t.name,type:t.type,unit:t.unit},n=JSON.stringify(e);return"	- create a new view with a name other than '"+r.name+"' and InstrumentSelector '"+n+`'
    	- OR - create a new view with the name `+r.name+" and description '"+r.description+"' and InstrumentSelector "+n+`
    	- OR - create a new view with the name `+t.name+" and description '"+r.description+"' and InstrumentSelector "+n}function Cr(r,t){return r.valueType!==t.valueType?Yu(r,t):r.unit!==t.unit?Wu(r,t):r.type!==t.type?Ku(r,t):r.description!==t.description?qu(r,t):""}var he=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Qu=function(){function r(){this._sharedRegistry=new Map,this._perCollectorRegistry=new Map}return r.create=function(){return new r},r.prototype.getStorages=function(t){var e,n,o,i,u=[];try{for(var s=he(this._sharedRegistry.values()),c=s.next();!c.done;c=s.next()){var a=c.value;u=u.concat(a)}}catch(_){e={error:_}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}var l=this._perCollectorRegistry.get(t);if(l!=null)try{for(var f=he(l.values()),d=f.next();!d.done;d=f.next()){var a=d.value;u=u.concat(a)}}catch(_){o={error:_}}finally{try{d&&!d.done&&(i=f.return)&&i.call(f)}finally{if(o)throw o.error}}return u},r.prototype.register=function(t){this._registerStorage(t,this._sharedRegistry)},r.prototype.registerForCollector=function(t,e){var n=this._perCollectorRegistry.get(t);n==null&&(n=new Map,this._perCollectorRegistry.set(t,n)),this._registerStorage(e,n)},r.prototype.findOrUpdateCompatibleStorage=function(t){var e=this._sharedRegistry.get(t.name);return e===void 0?null:this._findOrUpdateCompatibleStorage(t,e)},r.prototype.findOrUpdateCompatibleCollectorStorage=function(t,e){var n=this._perCollectorRegistry.get(t);if(n===void 0)return null;var o=n.get(e.name);return o===void 0?null:this._findOrUpdateCompatibleStorage(e,o)},r.prototype._registerStorage=function(t,e){var n=t.getInstrumentDescriptor(),o=e.get(n.name);if(o===void 0){e.set(n.name,[t]);return}o.push(t)},r.prototype._findOrUpdateCompatibleStorage=function(t,e){var n,o,i=null;try{for(var u=he(e),s=u.next();!s.done;s=u.next()){var c=s.value,a=c.getInstrumentDescriptor();zi(a,t)?(a.description!==t.description&&(t.description.length>a.description.length&&c.updateDescription(t.description),h.warn("A view or instrument with the name ",t.name,` has already been registered, but has a different description and is incompatible with another registered view.
`,`Details:
`,Pr(a,t),`The longer description will be used.
To resolve the conflict:`,Cr(a,t))),i=c):h.warn("A view or instrument with the name ",t.name,` has already been registered and is incompatible with another registered view.
`,`Details:
`,Pr(a,t),`To resolve the conflict:
`,Cr(a,t))}}catch(l){n={error:l}}finally{try{s&&!s.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}return i},r}(),Zu=function(){function r(t){this._backingStorages=t}return r.prototype.record=function(t,e,n,o){this._backingStorages.forEach(function(i){i.record(t,e,n,o)})},r}(),Ju=function(){function r(t,e){this._instrumentName=t,this._valueType=e,this._buffer=new W}return r.prototype.observe=function(t,e){if(e===void 0&&(e={}),typeof t!="number"){h.warn("non-number value provided to metric "+this._instrumentName+": "+t);return}this._valueType===at.INT&&!Number.isInteger(t)&&(h.warn("INT value type cannot accept a floating-point value for "+this._instrumentName+", ignoring the fractional digits."),t=Math.trunc(t),!Number.isInteger(t))||this._buffer.set(e,t)},r}(),ts=function(){function r(){this._buffer=new Map}return r.prototype.observe=function(t,e,n){if(n===void 0&&(n={}),!!Ne(t)){var o=this._buffer.get(t);if(o==null&&(o=new W,this._buffer.set(t,o)),typeof e!="number"){h.warn("non-number value provided to metric "+t._descriptor.name+": "+e);return}t._descriptor.valueType===at.INT&&!Number.isInteger(e)&&(h.warn("INT value type cannot accept a floating-point value for "+t._descriptor.name+", ignoring the fractional digits."),e=Math.trunc(e),!Number.isInteger(e))||o.set(n,e)}},r}(),_e=function(r,t,e,n){function o(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function s(l){try{a(n.next(l))}catch(f){u(f)}}function c(l){try{a(n.throw(l))}catch(f){u(f)}}function a(l){l.done?i(l.value):o(l.value).then(s,c)}a((n=n.apply(r,t||[])).next())})},pe=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(l){return c([a,l])}}function c(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,o=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(l){a=[6,l],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},xr=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},Mr=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},es=function(){function r(){this._callbacks=[],this._batchCallbacks=[]}return r.prototype.addCallback=function(t,e){var n=this._findCallback(t,e);n>=0||this._callbacks.push({callback:t,instrument:e})},r.prototype.removeCallback=function(t,e){var n=this._findCallback(t,e);n<0||this._callbacks.splice(n,1)},r.prototype.addBatchCallback=function(t,e){var n=new Set(e.filter(Ne));if(n.size===0){h.error("BatchObservableCallback is not associated with valid instruments",e);return}var o=this._findBatchCallback(t,n);o>=0||this._batchCallbacks.push({callback:t,instruments:n})},r.prototype.removeBatchCallback=function(t,e){var n=new Set(e.filter(Ne)),o=this._findBatchCallback(t,n);o<0||this._batchCallbacks.splice(o,1)},r.prototype.observe=function(t,e){return _e(this,void 0,void 0,function(){var n,o,i,u;return pe(this,function(s){switch(s.label){case 0:return n=this._observeCallbacks(t,e),o=this._observeBatchCallbacks(t,e),[4,Gi(Mr(Mr([],xr(n),!1),xr(o),!1))];case 1:return i=s.sent(),u=i.filter(ji).map(function(c){return c.reason}),[2,u]}})})},r.prototype._observeCallbacks=function(t,e){var n=this;return this._callbacks.map(function(o){var i=o.callback,u=o.instrument;return _e(n,void 0,void 0,function(){var s,c;return pe(this,function(a){switch(a.label){case 0:return s=new Ju(u._descriptor.name,u._descriptor.valueType),c=Promise.resolve(i(s)),e!=null&&(c=Nt(c,e)),[4,c];case 1:return a.sent(),u._metricStorages.forEach(function(l){l.record(s._buffer,t)}),[2]}})})})},r.prototype._observeBatchCallbacks=function(t,e){var n=this;return this._batchCallbacks.map(function(o){var i=o.callback,u=o.instruments;return _e(n,void 0,void 0,function(){var s,c;return pe(this,function(a){switch(a.label){case 0:return s=new ts,c=Promise.resolve(i(s)),e!=null&&(c=Nt(c,e)),[4,c];case 1:return a.sent(),u.forEach(function(l){var f=s._buffer.get(l);f!=null&&l._metricStorages.forEach(function(d){d.record(f,t)})}),[2]}})})})},r.prototype._findCallback=function(t,e){return this._callbacks.findIndex(function(n){return n.callback===t&&n.instrument===e})},r.prototype._findBatchCallback=function(t,e){return this._batchCallbacks.findIndex(function(n){return n.callback===t&&ki(n.instruments,e)})},r}(),rs=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),ns=function(r){rs(t,r);function t(e,n,o,i,u){var s=r.call(this,e)||this;return s._attributesProcessor=o,s._aggregationCardinalityLimit=u,s._deltaMetricStorage=new Qn(n,s._aggregationCardinalityLimit),s._temporalMetricStorage=new Zn(n,i),s}return t.prototype.record=function(e,n,o,i){n=this._attributesProcessor.process(n,o),this._deltaMetricStorage.record(e,n,o,i)},t.prototype.collect=function(e,n){var o=this._deltaMetricStorage.collect();return this._temporalMetricStorage.buildMetrics(e,this._instrumentDescriptor,o,n)},t}(qn),Jn=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),qt=function(){function r(){}return r.Noop=function(){return as},r}(),is=function(r){Jn(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.process=function(e,n){return e},t}(qt),os=function(r){Jn(t,r);function t(e){var n=r.call(this)||this;return n._allowedAttributeNames=e,n}return t.prototype.process=function(e,n){var o=this,i={};return Object.keys(e).filter(function(u){return o._allowedAttributeNames.includes(u)}).forEach(function(u){return i[u]=e[u]}),i},t}(qt),as=new is,us=function(r,t,e,n){function o(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function s(l){try{a(n.next(l))}catch(f){u(f)}}function c(l){try{a(n.throw(l))}catch(f){u(f)}}function a(l){l.done?i(l.value):o(l.value).then(s,c)}a((n=n.apply(r,t||[])).next())})},ss=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(l){return c([a,l])}}function c(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,o=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(l){a=[6,l],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},cs=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},ls=function(){function r(t,e){this._meterProviderSharedState=t,this._instrumentationScope=e,this.metricStorageRegistry=new Qu,this.observableRegistry=new es,this.meter=new Gu(this)}return r.prototype.registerMetricStorage=function(t){var e=this._registerMetricStorage(t,ns);return e.length===1?e[0]:new Zu(e)},r.prototype.registerAsyncMetricStorage=function(t){var e=this._registerMetricStorage(t,zu);return e},r.prototype.collect=function(t,e,n){return us(this,void 0,void 0,function(){var o,i,u;return ss(this,function(s){switch(s.label){case 0:return[4,this.observableRegistry.observe(e,n==null?void 0:n.timeoutMillis)];case 1:return o=s.sent(),i=this.metricStorageRegistry.getStorages(t),i.length===0?[2,null]:(u=i.map(function(c){return c.collect(t,e)}).filter(Di),u.length===0?[2,{errors:o}]:[2,{scopeMetrics:{scope:this._instrumentationScope,metrics:u},errors:o}])}})})},r.prototype._registerMetricStorage=function(t,e){var n=this,o=this._meterProviderSharedState.viewRegistry.findViews(t,this._instrumentationScope),i=o.map(function(c){var a=$i(c,t),l=n.metricStorageRegistry.findOrUpdateCompatibleStorage(a);if(l!=null)return l;var f=c.aggregation.createAggregator(a),d=new e(a,f,c.attributesProcessor,n._meterProviderSharedState.metricCollectors,c.aggregationCardinalityLimit);return n.metricStorageRegistry.register(d),d});if(i.length===0){var u=this._meterProviderSharedState.selectAggregations(t.type),s=u.map(function(c){var a=cs(c,2),l=a[0],f=a[1],d=n.metricStorageRegistry.findOrUpdateCompatibleCollectorStorage(l,t);if(d!=null)return d;var _=f.createAggregator(t),p=l.selectCardinalityLimit(t.type),y=new e(t,_,qt.Noop(),[l],p);return n.metricStorageRegistry.registerForCollector(l,y),y});i=i.concat(s)}return i},r}(),fs=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},ds=function(){function r(t){this.resource=t,this.viewRegistry=new xu,this.metricCollectors=[],this.meterSharedStates=new Map}return r.prototype.getMeterSharedState=function(t){var e=Bi(t),n=this.meterSharedStates.get(e);return n==null&&(n=new ls(this,t),this.meterSharedStates.set(e,n)),n},r.prototype.selectAggregations=function(t){var e,n,o=[];try{for(var i=fs(this.metricCollectors),u=i.next();!u.done;u=i.next()){var s=u.value;o.push([s,s.selectAggregation(t)])}}catch(c){e={error:c}}finally{try{u&&!u.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return o},r}(),St=function(r,t,e,n){function o(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function s(l){try{a(n.next(l))}catch(f){u(f)}}function c(l){try{a(n.throw(l))}catch(f){u(f)}}function a(l){l.done?i(l.value):o(l.value).then(s,c)}a((n=n.apply(r,t||[])).next())})},bt=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(l){return c([a,l])}}function c(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,o=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(l){a=[6,l],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},hs=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},_s=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},ps=function(){function r(t,e){this._sharedState=t,this._metricReader=e}return r.prototype.collect=function(t){return St(this,void 0,void 0,function(){var e,n,o,i,u=this;return bt(this,function(s){switch(s.label){case 0:return e=R(Date.now()),n=[],o=[],i=Array.from(this._sharedState.meterSharedStates.values()).map(function(c){return St(u,void 0,void 0,function(){var a;return bt(this,function(l){switch(l.label){case 0:return[4,c.collect(this,e,t)];case 1:return a=l.sent(),(a==null?void 0:a.scopeMetrics)!=null&&n.push(a.scopeMetrics),(a==null?void 0:a.errors)!=null&&o.push.apply(o,_s([],hs(a.errors),!1)),[2]}})})}),[4,Promise.all(i)];case 1:return s.sent(),[2,{resourceMetrics:{resource:this._sharedState.resource,scopeMetrics:n},errors:o}]}})})},r.prototype.forceFlush=function(t){return St(this,void 0,void 0,function(){return bt(this,function(e){switch(e.label){case 0:return[4,this._metricReader.forceFlush(t)];case 1:return e.sent(),[2]}})})},r.prototype.shutdown=function(t){return St(this,void 0,void 0,function(){return bt(this,function(e){switch(e.label){case 0:return[4,this._metricReader.shutdown(t)];case 1:return e.sent(),[2]}})})},r.prototype.selectAggregationTemporality=function(t){return this._metricReader.selectAggregationTemporality(t)},r.prototype.selectAggregation=function(t){return this._metricReader.selectAggregation(t)},r.prototype.selectCardinalityLimit=function(t){var e,n,o;return(o=(n=(e=this._metricReader).selectCardinalityLimit)===null||n===void 0?void 0:n.call(e,t))!==null&&o!==void 0?o:2e3},r}(),Ir=function(r,t,e,n){function o(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function s(l){try{a(n.next(l))}catch(f){u(f)}}function c(l){try{a(n.throw(l))}catch(f){u(f)}}function a(l){l.done?i(l.value):o(l.value).then(s,c)}a((n=n.apply(r,t||[])).next())})},Nr=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(l){return c([a,l])}}function c(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,o=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(l){a=[6,l],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Ur=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function vs(r,t){var e=t??H.empty();return r?H.default().merge(e):e}var ys=function(){function r(t){var e,n,o,i,u;if(this._shutdown=!1,this._sharedState=new ds(vs((u=t==null?void 0:t.mergeResourceWithDefaults)!==null&&u!==void 0?u:!0,t==null?void 0:t.resource)),(t==null?void 0:t.views)!=null&&t.views.length>0)try{for(var s=Ur(t.views),c=s.next();!c.done;c=s.next()){var a=c.value;this._sharedState.viewRegistry.addView(a)}}catch(_){e={error:_}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}if((t==null?void 0:t.readers)!=null&&t.readers.length>0)try{for(var l=Ur(t.readers),f=l.next();!f.done;f=l.next()){var d=f.value;this.addMetricReader(d)}}catch(_){o={error:_}}finally{try{f&&!f.done&&(i=l.return)&&i.call(l)}finally{if(o)throw o.error}}}return r.prototype.getMeter=function(t,e,n){return e===void 0&&(e=""),n===void 0&&(n={}),this._shutdown?(h.warn("A shutdown MeterProvider cannot provide a Meter"),Ai()):this._sharedState.getMeterSharedState({name:t,version:e,schemaUrl:n.schemaUrl}).meter},r.prototype.addMetricReader=function(t){var e=new ps(this._sharedState,t);t.setMetricProducer(e),this._sharedState.metricCollectors.push(e)},r.prototype.shutdown=function(t){return Ir(this,void 0,void 0,function(){return Nr(this,function(e){switch(e.label){case 0:return this._shutdown?(h.warn("shutdown may only be called once per MeterProvider"),[2]):(this._shutdown=!0,[4,Promise.all(this._sharedState.metricCollectors.map(function(n){return n.shutdown(t)}))]);case 1:return e.sent(),[2]}})})},r.prototype.forceFlush=function(t){return Ir(this,void 0,void 0,function(){return Nr(this,function(e){switch(e.label){case 0:return this._shutdown?(h.warn("invalid attempt to force flush after MeterProvider shutdown"),[2]):[4,Promise.all(this._sharedState.metricCollectors.map(function(n){return n.forceFlush(t)}))];case 1:return e.sent(),[2]}})})},r}(),ms=/[\^$\\.+?()[\]{}|]/g,ti=function(){function r(t){t==="*"?(this._matchAll=!0,this._regexp=/.*/):(this._matchAll=!1,this._regexp=new RegExp(r.escapePattern(t)))}return r.prototype.match=function(t){return this._matchAll?!0:this._regexp.test(t)},r.escapePattern=function(t){return"^"+t.replace(ms,"\\$&").replace("*",".*")+"$"},r.hasWildcard=function(t){return t.includes("*")},r}(),It=function(){function r(t){this._matchAll=t===void 0,this._pattern=t}return r.prototype.match=function(t){return!!(this._matchAll||t===this._pattern)},r}(),gs=function(){function r(t){var e;this._nameFilter=new ti((e=t==null?void 0:t.name)!==null&&e!==void 0?e:"*"),this._type=t==null?void 0:t.type,this._unitFilter=new It(t==null?void 0:t.unit)}return r.prototype.getType=function(){return this._type},r.prototype.getNameFilter=function(){return this._nameFilter},r.prototype.getUnitFilter=function(){return this._unitFilter},r}(),Es=function(){function r(t){this._nameFilter=new It(t==null?void 0:t.name),this._versionFilter=new It(t==null?void 0:t.version),this._schemaUrlFilter=new It(t==null?void 0:t.schemaUrl)}return r.prototype.getNameFilter=function(){return this._nameFilter},r.prototype.getVersionFilter=function(){return this._versionFilter},r.prototype.getSchemaUrlFilter=function(){return this._schemaUrlFilter},r}();function Ts(r){return r.instrumentName==null&&r.instrumentType==null&&r.instrumentUnit==null&&r.meterName==null&&r.meterVersion==null&&r.meterSchemaUrl==null}var Ss=function(){function r(t){var e;if(Ts(t))throw new Error("Cannot create view with no selector arguments supplied");if(t.name!=null&&((t==null?void 0:t.instrumentName)==null||ti.hasWildcard(t.instrumentName)))throw new Error("Views with a specified name must be declared with an instrument selector that selects at most one instrument per meter.");t.attributeKeys!=null?this.attributesProcessor=new os(t.attributeKeys):this.attributesProcessor=qt.Noop(),this.name=t.name,this.description=t.description,this.aggregation=(e=t.aggregation)!==null&&e!==void 0?e:N.Default(),this.instrumentSelector=new gs({name:t.instrumentName,type:t.instrumentType,unit:t.instrumentUnit}),this.meterSelector=new Es({name:t.meterName,version:t.meterVersion,schemaUrl:t.meterSchemaUrl}),this.aggregationCardinalityLimit=t.aggregationCardinalityLimit}return r}();function bs(r,t,{leading:e=!0,trailing:n=!0}={}){let o,i,u,s=null,c=0;function a(){c=e===!1?0:Date.now(),s=null,o&&(i=r.apply(u,o)),u=null,o=null}return function(...l){const f=Date.now();!c&&e===!1&&(c=f);const d=t-(f-c);return u=this,o=l,d<=0||d>t?(s&&(clearTimeout(s),s=null),c=f,o&&(i=r.apply(u,o)),u=null,o=null):!s&&n!==!1&&(s=setTimeout(a,d)),i}}class Dr extends Ou{constructor({exporter:t,throttleLimit:e}){var n,o;super({aggregationSelector:(n=t.selectAggregation)===null||n===void 0?void 0:n.bind(t),aggregationTemporalitySelector:(o=t.selectAggregationTemporality)===null||o===void 0?void 0:o.bind(t)}),this._exporter=void 0,this._exporter=t,this.onForceFlush=bs(this.onForceFlush,e)}async onForceFlush(){const{resourceMetrics:t,errors:e}=await this.collect({});return e.length>0&&h.error("PeriodicExportingMetricReader: metrics collection errors",...e),new Promise((n,o)=>{this._exporter.export(t,i=>{if(i.code===T.SUCCESS)n();else{var u;o((u=i.error)!==null&&u!==void 0?u:new Error(`InstantaneousMetricReader: metrics export failed (error ${i.error})`))}})})}async onShutdown(){await this._exporter.shutdown()}}var Ht;(function(r){r[r.DELTA=0]="DELTA",r[r.CUMULATIVE=1]="CUMULATIVE",r[r.LOWMEMORY=2]="LOWMEMORY"})(Ht||(Ht={}));var Je=function(){function r(t){this._delegate=t}return r.prototype.export=function(t,e){this._delegate.export(t,e)},r.prototype.forceFlush=function(){return this._delegate.forceFlush()},r.prototype.shutdown=function(){return this._delegate.shutdown()},r}(),ws=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Br=function(r){ws(t,r);function t(e,n,o){var i=r.call(this,e)||this;return i.name="OTLPExporterError",i.data=o,i.code=n,i}return t}(Error);function Os(r){if(!Number.isNaN(r)&&Number.isFinite(r)&&r>0)return r;throw new Error("Configuration: timeoutMillis is invalid, expected number greater than 0 (actual: '"+r+"')")}function As(r){if(r!=null)return function(){return r}}function Rs(r,t,e){var n,o,i,u,s,c;return{timeoutMillis:Os((o=(n=r.timeoutMillis)!==null&&n!==void 0?n:t.timeoutMillis)!==null&&o!==void 0?o:e.timeoutMillis),concurrencyLimit:(u=(i=r.concurrencyLimit)!==null&&i!==void 0?i:t.concurrencyLimit)!==null&&u!==void 0?u:e.concurrencyLimit,compression:(c=(s=r.compression)!==null&&s!==void 0?s:t.compression)!==null&&c!==void 0?c:e.compression}}function Ls(){return{timeoutMillis:1e4,concurrencyLimit:30,compression:"none"}}var Ps=function(r,t,e,n){function o(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function s(l){try{a(n.next(l))}catch(f){u(f)}}function c(l){try{a(n.throw(l))}catch(f){u(f)}}function a(l){l.done?i(l.value):o(l.value).then(s,c)}a((n=n.apply(r,t||[])).next())})},Cs=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(l){return c([a,l])}}function c(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,o=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(l){a=[6,l],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},xs=function(){function r(t){this._sendingPromises=[],this._concurrencyLimit=t}return r.prototype.pushPromise=function(t){var e=this;if(this.hasReachedLimit())throw new Error("Concurrency Limit reached");this._sendingPromises.push(t);var n=function(){var o=e._sendingPromises.indexOf(t);e._sendingPromises.splice(o,1)};t.then(n,n)},r.prototype.hasReachedLimit=function(){return this._sendingPromises.length>=this._concurrencyLimit},r.prototype.awaitAll=function(){return Ps(this,void 0,void 0,function(){return Cs(this,function(t){switch(t.label){case 0:return[4,Promise.all(this._sendingPromises)];case 1:return t.sent(),[2]}})})},r}();function Ms(r){return new xs(r.concurrencyLimit)}function Is(r){return Object.prototype.hasOwnProperty.call(r,"partialSuccess")}function Ns(){return{handleResponse:function(r){r==null||!Is(r)||r.partialSuccess==null||Object.keys(r.partialSuccess).length===0||h.warn("Received Partial Success response:",JSON.stringify(r.partialSuccess))}}}var Us=function(r,t,e,n){function o(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function s(l){try{a(n.next(l))}catch(f){u(f)}}function c(l){try{a(n.throw(l))}catch(f){u(f)}}function a(l){l.done?i(l.value):o(l.value).then(s,c)}a((n=n.apply(r,t||[])).next())})},Ds=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(l){return c([a,l])}}function c(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,o=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(l){a=[6,l],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Bs=function(){function r(t,e,n,o,i){this._transport=t,this._serializer=e,this._responseHandler=n,this._promiseQueue=o,this._timeout=i,this._diagLogger=h.createComponentLogger({namespace:"OTLPExportDelegate"})}return r.prototype.export=function(t,e){var n=this;if(this._diagLogger.debug("items to be sent",t),this._promiseQueue.hasReachedLimit()){e({code:T.FAILED,error:new Error("Concurrent export limit reached")});return}var o=this._serializer.serializeRequest(t);if(o==null){e({code:T.FAILED,error:new Error("Nothing to send")});return}this._promiseQueue.pushPromise(this._transport.send(o,this._timeout).then(function(i){if(i.status==="success"){if(i.data!=null)try{n._responseHandler.handleResponse(n._serializer.deserializeResponse(i.data))}catch(u){n._diagLogger.warn("Export succeeded but could not deserialize response - is the response specification compliant?",u,i.data)}e({code:T.SUCCESS});return}else if(i.status==="failure"&&i.error){e({code:T.FAILED,error:i.error});return}else i.status==="retryable"?e({code:T.FAILED,error:new Br("Export failed with retryable status")}):e({code:T.FAILED,error:new Br("Export failed with unknown error")})},function(i){return e({code:T.FAILED,error:i})}))},r.prototype.forceFlush=function(){return this._promiseQueue.awaitAll()},r.prototype.shutdown=function(){return Us(this,void 0,void 0,function(){return Ds(this,function(t){switch(t.label){case 0:return this._diagLogger.debug("shutdown started"),[4,this.forceFlush()];case 1:return t.sent(),this._transport.shutdown(),[2]}})})},r}();function Hs(r,t){return new Bs(r.transport,r.serializer,Ns(),r.promiseHandler,t.timeout)}function ei(r,t,e){return Hs({transport:e,serializer:t,promiseHandler:Ms(r)},{timeout:r.timeoutMillis})}var Gs=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Ue=function(){return L.CUMULATIVE},ri=function(r){switch(r){case v.COUNTER:case v.OBSERVABLE_COUNTER:case v.GAUGE:case v.HISTOGRAM:case v.OBSERVABLE_GAUGE:return L.DELTA;case v.UP_DOWN_COUNTER:case v.OBSERVABLE_UP_DOWN_COUNTER:return L.CUMULATIVE}},ni=function(r){switch(r){case v.COUNTER:case v.HISTOGRAM:return L.DELTA;case v.GAUGE:case v.UP_DOWN_COUNTER:case v.OBSERVABLE_UP_DOWN_COUNTER:case v.OBSERVABLE_COUNTER:case v.OBSERVABLE_GAUGE:return L.CUMULATIVE}};function js(){var r=I(),t=r.OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE.trim().toLowerCase();return t==="cumulative"?Ue:t==="delta"?ri:t==="lowmemory"?ni:(h.warn("OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE is set to '"+r.OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE+"', but only 'cumulative' and 'delta' are allowed. Using default ('cumulative') instead."),Ue)}function ks(r){return r!=null?r===Ht.DELTA?ri:r===Ht.LOWMEMORY?ni:Ue:js()}function Fs(r){return r!=null&&r.aggregationPreference?r.aggregationPreference:function(t){return N.Default()}}var Vs=function(r){Gs(t,r);function t(e,n){var o=r.call(this,e)||this;return o._aggregationSelector=Fs(n),o._aggregationTemporalitySelector=ks(n==null?void 0:n.temporalityPreference),o}return t.prototype.selectAggregation=function(e){return this._aggregationSelector(e)},t.prototype.selectAggregationTemporality=function(e){return this._aggregationTemporalitySelector(e)},t}(Je);function ii(r){var t=BigInt(1e9);return BigInt(r[0])*t+BigInt(r[1])}function Xs(r){var t=Number(BigInt.asUintN(32,r)),e=Number(BigInt.asUintN(32,r>>BigInt(32)));return{low:t,high:e}}function oi(r){var t=ii(r);return Xs(t)}function $s(r){var t=ii(r);return t.toString()}var zs=typeof BigInt<"u"?$s:M;function Hr(r){return r}function ai(r){if(r!==void 0)return gt(r)}var Ys={encodeHrTime:oi,encodeSpanContext:gt,encodeOptionalSpanContext:ai};function tr(r){var t,e;if(r===void 0)return Ys;var n=(t=r.useLongBits)!==null&&t!==void 0?t:!0,o=(e=r.useHex)!==null&&e!==void 0?e:!1;return{encodeHrTime:n?oi:zs,encodeSpanContext:o?Hr:gt,encodeOptionalSpanContext:o?Hr:ai}}var Ws=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i};function er(r){return{attributes:J(r.attributes),droppedAttributesCount:0}}function rr(r){return{name:r.name,version:r.version}}function J(r){return Object.keys(r).map(function(t){return nr(t,r[t])})}function nr(r,t){return{key:r,value:ir(t)}}function ir(r){var t=typeof r;return t==="string"?{stringValue:r}:t==="number"?Number.isInteger(r)?{intValue:r}:{doubleValue:r}:t==="boolean"?{boolValue:r}:r instanceof Uint8Array?{bytesValue:r}:Array.isArray(r)?{arrayValue:{values:r.map(ir)}}:t==="object"&&r!=null?{kvlistValue:{values:Object.entries(r).map(function(e){var n=Ws(e,2),o=n[0],i=n[1];return nr(o,i)})}}:{}}var Ks=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Gr=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i};function qs(r,t){var e=tr(t);return{resourceLogs:Zs(r,e)}}function Qs(r){var t,e,n=new Map;try{for(var o=Ks(r),i=o.next();!i.done;i=o.next()){var u=i.value,s=u.resource,c=u.instrumentationScope,a=c.name,l=c.version,f=l===void 0?"":l,d=c.schemaUrl,_=d===void 0?"":d,p=n.get(s);p||(p=new Map,n.set(s,p));var y=a+"@"+f+":"+_,O=p.get(y);O||(O=[],p.set(y,O)),O.push(u)}}catch(m){t={error:m}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return n}function Zs(r,t){var e=Qs(r);return Array.from(e,function(n){var o=Gr(n,2),i=o[0],u=o[1];return{resource:er(i),scopeLogs:Array.from(u,function(s){var c=Gr(s,2),a=c[1];return{scope:rr(a[0].instrumentationScope),logRecords:a.map(function(l){return Js(l,t)}),schemaUrl:a[0].instrumentationScope.schemaUrl}}),schemaUrl:void 0}})}function Js(r,t){var e,n,o;return{timeUnixNano:t.encodeHrTime(r.hrTime),observedTimeUnixNano:t.encodeHrTime(r.hrTimeObserved),severityNumber:r.severityNumber,severityText:r.severityText,body:ir(r.body),attributes:tc(r.attributes),droppedAttributesCount:r.droppedAttributesCount,flags:(e=r.spanContext)===null||e===void 0?void 0:e.traceFlags,traceId:t.encodeOptionalSpanContext((n=r.spanContext)===null||n===void 0?void 0:n.traceId),spanId:t.encodeOptionalSpanContext((o=r.spanContext)===null||o===void 0?void 0:o.spanId)}}function tc(r){return Object.keys(r).map(function(t){return nr(t,r[t])})}function ec(r,t){var e=tr(t);return{resource:er(r.resource),schemaUrl:void 0,scopeMetrics:rc(r.scopeMetrics,e)}}function rc(r,t){return Array.from(r.map(function(e){return{scope:rr(e.scope),metrics:e.metrics.map(function(n){return nc(n,t)}),schemaUrl:e.scope.schemaUrl}}))}function nc(r,t){var e={name:r.descriptor.name,description:r.descriptor.description,unit:r.descriptor.unit},n=uc(r.aggregationTemporality);switch(r.dataPointType){case x.SUM:e.sum={aggregationTemporality:n,isMonotonic:r.isMonotonic,dataPoints:jr(r,t)};break;case x.GAUGE:e.gauge={dataPoints:jr(r,t)};break;case x.HISTOGRAM:e.histogram={aggregationTemporality:n,dataPoints:oc(r,t)};break;case x.EXPONENTIAL_HISTOGRAM:e.exponentialHistogram={aggregationTemporality:n,dataPoints:ac(r,t)};break}return e}function ic(r,t,e){var n={attributes:J(r.attributes),startTimeUnixNano:e.encodeHrTime(r.startTime),timeUnixNano:e.encodeHrTime(r.endTime)};switch(t){case at.INT:n.asInt=r.value;break;case at.DOUBLE:n.asDouble=r.value;break}return n}function jr(r,t){return r.dataPoints.map(function(e){return ic(e,r.descriptor.valueType,t)})}function oc(r,t){return r.dataPoints.map(function(e){var n=e.value;return{attributes:J(e.attributes),bucketCounts:n.buckets.counts,explicitBounds:n.buckets.boundaries,count:n.count,sum:n.sum,min:n.min,max:n.max,startTimeUnixNano:t.encodeHrTime(e.startTime),timeUnixNano:t.encodeHrTime(e.endTime)}})}function ac(r,t){return r.dataPoints.map(function(e){var n=e.value;return{attributes:J(e.attributes),count:n.count,min:n.min,max:n.max,sum:n.sum,positive:{offset:n.positive.offset,bucketCounts:n.positive.bucketCounts},negative:{offset:n.negative.offset,bucketCounts:n.negative.bucketCounts},scale:n.scale,zeroCount:n.zeroCount,startTimeUnixNano:t.encodeHrTime(e.startTime),timeUnixNano:t.encodeHrTime(e.endTime)}})}function uc(r){switch(r){case L.DELTA:return 1;case L.CUMULATIVE:return 2}}function sc(r,t){return{resourceMetrics:r.map(function(e){return ec(e,t)})}}var cc=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},lc=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i};function fc(r,t){var e,n=r.spanContext(),o=r.status;return{traceId:t.encodeSpanContext(n.traceId),spanId:t.encodeSpanContext(n.spanId),parentSpanId:t.encodeOptionalSpanContext(r.parentSpanId),traceState:(e=n.traceState)===null||e===void 0?void 0:e.serialize(),name:r.name,kind:r.kind==null?0:r.kind+1,startTimeUnixNano:t.encodeHrTime(r.startTime),endTimeUnixNano:t.encodeHrTime(r.endTime),attributes:J(r.attributes),droppedAttributesCount:r.droppedAttributesCount,events:r.events.map(function(i){return hc(i,t)}),droppedEventsCount:r.droppedEventsCount,status:{code:o.code,message:o.message},links:r.links.map(function(i){return dc(i,t)}),droppedLinksCount:r.droppedLinksCount}}function dc(r,t){var e;return{attributes:r.attributes?J(r.attributes):[],spanId:t.encodeSpanContext(r.context.spanId),traceId:t.encodeSpanContext(r.context.traceId),traceState:(e=r.context.traceState)===null||e===void 0?void 0:e.serialize(),droppedAttributesCount:r.droppedAttributesCount||0}}function hc(r,t){return{attributes:r.attributes?J(r.attributes):[],name:r.name,timeUnixNano:t.encodeHrTime(r.time),droppedAttributesCount:r.droppedAttributesCount||0}}function _c(r,t){var e=tr(t);return{resourceSpans:vc(r,e)}}function pc(r){var t,e,n=new Map;try{for(var o=cc(r),i=o.next();!i.done;i=o.next()){var u=i.value,s=n.get(u.resource);s||(s=new Map,n.set(u.resource,s));var c=u.instrumentationLibrary.name+"@"+(u.instrumentationLibrary.version||"")+":"+(u.instrumentationLibrary.schemaUrl||""),a=s.get(c);a||(a=[],s.set(c,a)),a.push(u)}}catch(l){t={error:l}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return n}function vc(r,t){for(var e=pc(r),n=[],o=e.entries(),i=o.next();!i.done;){for(var u=lc(i.value,2),s=u[0],c=u[1],a=[],l=c.values(),f=l.next();!f.done;){var d=f.value;if(d.length>0){var _=d.map(function(y){return fc(y,t)});a.push({scope:rr(d[0].instrumentationLibrary),spans:_,schemaUrl:d[0].instrumentationLibrary.schemaUrl})}f=l.next()}var p={resource:er(s),scopeSpans:a,schemaUrl:void 0};n.push(p),i=o.next()}return n}var yc={serializeRequest:function(r){var t=qs(r,{useHex:!0,useLongBits:!1}),e=new TextEncoder;return e.encode(JSON.stringify(t))},deserializeResponse:function(r){var t=new TextDecoder;return JSON.parse(t.decode(r))}},mc={serializeRequest:function(r){var t=sc([r],{useLongBits:!1}),e=new TextEncoder;return e.encode(JSON.stringify(t))},deserializeResponse:function(r){var t=new TextDecoder;return JSON.parse(t.decode(r))}},gc={serializeRequest:function(r){var t=_c(r,{useHex:!0,useLongBits:!1}),e=new TextEncoder;return e.encode(JSON.stringify(t))},deserializeResponse:function(r){var t=new TextDecoder;return JSON.parse(t.decode(r))}},Ec=function(r,t,e,n){function o(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function s(l){try{a(n.next(l))}catch(f){u(f)}}function c(l){try{a(n.throw(l))}catch(f){u(f)}}function a(l){l.done?i(l.value):o(l.value).then(s,c)}a((n=n.apply(r,t||[])).next())})},Tc=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(l){return c([a,l])}}function c(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,o=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(l){a=[6,l],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Sc=5,bc=1e3,wc=5e3,Oc=1.5,kr=.2;function Ac(){return Math.random()*(2*kr)-kr}var Rc=function(){function r(t){this._transport=t}return r.prototype.retry=function(t,e,n){var o=this;return new Promise(function(i,u){setTimeout(function(){o._transport.send(t,e).then(i,u)},n)})},r.prototype.send=function(t,e){var n;return Ec(this,void 0,void 0,function(){var o,i,u,s,c,a,l;return Tc(this,function(f){switch(f.label){case 0:return o=Date.now()+e,[4,this._transport.send(t,e)];case 1:i=f.sent(),u=Sc,s=bc,f.label=2;case 2:return i.status==="retryable"&&u>0?(u--,c=Math.max(Math.min(s,wc)+Ac(),0),s=s*Oc,a=(n=i.retryInMillis)!==null&&n!==void 0?n:c,l=o-Date.now(),a>l?[2,i]:[4,this.retry(t,l,a)]):[3,4];case 3:return i=f.sent(),[3,2];case 4:return[2,i]}})})},r.prototype.shutdown=function(){return this._transport.shutdown()},r}();function ui(r){return new Rc(r.transport)}function Lc(r){var t=[429,502,503,504];return t.includes(r)}function Pc(r){if(r!=null){var t=Number.parseInt(r,10);if(Number.isInteger(t))return t>0?t*1e3:-1;var e=new Date(r).getTime()-Date.now();return e>=0?e:0}}var Cc=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},xc=function(){function r(t){this._parameters=t}return r.prototype.send=function(t,e){var n=this;return new Promise(function(o){var i=new XMLHttpRequest;i.timeout=e,i.open("POST",n._parameters.url);var u=n._parameters.headers();Object.entries(u).forEach(function(s){var c=Cc(s,2),a=c[0],l=c[1];i.setRequestHeader(a,l)}),i.ontimeout=function(s){o({status:"failure",error:new Error("XHR request timed out")})},i.onreadystatechange=function(){i.status>=200&&i.status<=299?(h.debug("XHR success"),o({status:"success"})):i.status&&Lc(i.status)?o({status:"retryable",retryInMillis:Pc(i.getResponseHeader("Retry-After"))}):i.status!==0&&o({status:"failure",error:new Error("XHR request failed with non-retryable status")})},i.onabort=function(){o({status:"failure",error:new Error("XHR request aborted")})},i.onerror=function(){o({status:"failure",error:new Error("XHR request errored")})},i.send(t)})},r.prototype.shutdown=function(){},r}();function Mc(r){return new xc(r)}var Ic=function(){function r(t){this._params=t}return r.prototype.send=function(t){var e=this;return new Promise(function(n){navigator.sendBeacon(e._params.url,new Blob([t],{type:e._params.blobType}))?(h.debug("SendBeacon success"),n({status:"success"})):n({status:"failure",error:new Error("SendBeacon failed")})})},r.prototype.shutdown=function(){},r}();function Nc(r){return new Ic(r)}function Uc(r,t){return ei(r,t,ui({transport:Mc(r)}))}function Dc(r,t){return ei(r,t,ui({transport:Nc({url:r.url,blobType:r.headers()["Content-Type"]})}))}var Bc=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i};function Hc(r){return function(){var t,e={};return Object.entries((t=r==null?void 0:r())!==null&&t!==void 0?t:{}).forEach(function(n){var o=Bc(n,2),i=o[0],u=o[1];typeof u<"u"?e[i]=String(u):h.warn('Header "'+i+'" has invalid value ('+u+") and will be ignored")}),e}}var q=function(){return q=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},q.apply(this,arguments)};function Gc(r,t,e){var n=q({},e()),o={};return function(){return t!=null&&Object.assign(o,t()),r!=null&&Object.assign(o,r()),Object.assign(o,n)}}function jc(r){if(r!=null)try{return new URL(r),r}catch{throw new Error("Configuration: Could not parse user-provided export URL: '"+r+"'")}}function kc(r,t,e){var n,o,i,u;return q(q({},Rs(r,t,e)),{headers:Gc(Hc(r.headers),t.headers,e.headers),url:(o=(n=jc(r.url))!==null&&n!==void 0?n:t.url)!==null&&o!==void 0?o:e.url,agentOptions:(u=(i=r.agentOptions)!==null&&i!==void 0?i:t.agentOptions)!==null&&u!==void 0?u:e.agentOptions})}function Fc(r,t){return q(q({},Ls()),{headers:function(){return r},url:"http://localhost:4318/"+t,agentOptions:{keepAlive:!0}})}function Vc(r,t,e){return kc({url:r.url,timeoutMillis:r.timeoutMillis,headers:As(r.headers),concurrencyLimit:r.concurrencyLimit},{},Fc(e,t))}function or(r,t,e,n){var o=!!r.headers||typeof navigator.sendBeacon!="function",i=Vc(r,e,n);return o?Uc(i,t):Dc(i,t)}var Xc=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),$c=function(r){Xc(t,r);function t(e){return r.call(this,or(e??{},mc,"v1/metrics",{"Content-Type":"application/json"}),e)||this}return t}(Vs);const Gt={production:"https://otlp-http-production.shopifysvc.com",staging:"https://otlp-http-staging.shopifysvc.com",local:"http://localhost:4318"},zc="/v1/metrics",Yc="/v1/traces",Wc="/v1/logs",ar="service.name",si="deployment.environment";class Kc extends ys{constructor({serviceName:t,env:e,throttleLimit:n,useXhr:o,dev:i,otlpBaseURL:u}){super({resource:new H({[ar]:t})});const c={url:(typeof u=="string"?u:Gt[e]||e)+zc,temporalityPreference:L.DELTA};o&&(c.headers={});const a=new $c(c);this.addMetricReader(new Dr({exporter:a,throttleLimit:n})),i&&this.addMetricReader(new Dr({exporter:new Au,throttleLimit:n}))}}var qc=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Qc=function(r){qc(t,r);function t(e){return e===void 0&&(e={}),r.call(this,or(e,gc,"v1/traces",{"Content-Type":"application/json"}))||this}return t}(Je),Zc="exception",De=function(){return De=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},De.apply(this,arguments)},Jc=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Fr=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},tl=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},el=function(){function r(t,e,n,o,i,u,s,c,a,l){s===void 0&&(s=[]),this.attributes={},this.links=[],this.events=[],this._droppedAttributesCount=0,this._droppedEventsCount=0,this._droppedLinksCount=0,this.status={code:Ri.UNSET},this.endTime=[0,0],this._ended=!1,this._duration=[-1,-1],this.name=n,this._spanContext=o,this.parentSpanId=u,this.kind=i,this.links=s;var f=Date.now();this._performanceStartTime=Y.now(),this._performanceOffset=f-(this._performanceStartTime+$t()),this._startTimeProvided=c!=null,this.startTime=this._getTime(c??f),this.resource=t.resource,this.instrumentationLibrary=t.instrumentationLibrary,this._spanLimits=t.getSpanLimits(),this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0,l!=null&&this.setAttributes(l),this._spanProcessor=t.getActiveSpanProcessor(),this._spanProcessor.onStart(this,e)}return r.prototype.spanContext=function(){return this._spanContext},r.prototype.setAttribute=function(t,e){return e==null||this._isSpanEnded()?this:t.length===0?(h.warn("Invalid attribute key: "+t),this):yt(e)?Object.keys(this.attributes).length>=this._spanLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,t)?(this._droppedAttributesCount++,this):(this.attributes[t]=this._truncateToSize(e),this):(h.warn("Invalid attribute value set for key: "+t),this)},r.prototype.setAttributes=function(t){var e,n;try{for(var o=Jc(Object.entries(t)),i=o.next();!i.done;i=o.next()){var u=Fr(i.value,2),s=u[0],c=u[1];this.setAttribute(s,c)}}catch(a){e={error:a}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return this},r.prototype.addEvent=function(t,e,n){if(this._isSpanEnded())return this;if(this._spanLimits.eventCountLimit===0)return h.warn("No events allowed."),this._droppedEventsCount++,this;this.events.length>=this._spanLimits.eventCountLimit&&(this._droppedEventsCount===0&&h.debug("Dropping extra events."),this.events.shift(),this._droppedEventsCount++),Ce(e)&&(Ce(n)||(n=e),e=void 0);var o=pt(e);return this.events.push({name:t,attributes:o,time:this._getTime(n),droppedAttributesCount:0}),this},r.prototype.addLink=function(t){return this.links.push(t),this},r.prototype.addLinks=function(t){var e;return(e=this.links).push.apply(e,tl([],Fr(t),!1)),this},r.prototype.setStatus=function(t){return this._isSpanEnded()?this:(this.status=De({},t),this.status.message!=null&&typeof t.message!="string"&&(h.warn("Dropping invalid status.message of type '"+typeof t.message+"', expected 'string'"),delete this.status.message),this)},r.prototype.updateName=function(t){return this._isSpanEnded()?this:(this.name=t,this)},r.prototype.end=function(t){if(this._isSpanEnded()){h.error(this.name+" "+this._spanContext.traceId+"-"+this._spanContext.spanId+" - You can only call end() on a span once.");return}this._ended=!0,this.endTime=this._getTime(t),this._duration=Cn(this.startTime,this.endTime),this._duration[0]<0&&(h.warn("Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.",this.startTime,this.endTime),this.endTime=this.startTime.slice(),this._duration=[0,0]),this._droppedEventsCount>0&&h.warn("Dropped "+this._droppedEventsCount+" events because eventCountLimit reached"),this._spanProcessor.onEnd(this)},r.prototype._getTime=function(t){if(typeof t=="number"&&t<=Y.now())return mt(t+this._performanceOffset);if(typeof t=="number")return R(t);if(t instanceof Date)return R(t.getTime());if(zt(t))return t;if(this._startTimeProvided)return R(Date.now());var e=Y.now()-this._performanceStartTime;return We(this.startTime,R(e))},r.prototype.isRecording=function(){return this._ended===!1},r.prototype.recordException=function(t,e){var n={};typeof t=="string"?n[ue]=t:t&&(t.code?n[ae]=t.code.toString():t.name&&(n[ae]=t.name),t.message&&(n[ue]=t.message),t.stack&&(n[ea]=t.stack)),n[ae]||n[ue]?this.addEvent(Zc,n,e):h.warn("Failed to record an exception "+t)},Object.defineProperty(r.prototype,"duration",{get:function(){return this._duration},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"ended",{get:function(){return this._ended},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"droppedAttributesCount",{get:function(){return this._droppedAttributesCount},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"droppedEventsCount",{get:function(){return this._droppedEventsCount},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"droppedLinksCount",{get:function(){return this._droppedLinksCount},enumerable:!1,configurable:!0}),r.prototype._isSpanEnded=function(){return this._ended&&h.warn("Can not execute the operation on ended Span {traceId: "+this._spanContext.traceId+", spanId: "+this._spanContext.spanId+"}"),this._ended},r.prototype._truncateToLimitUtil=function(t,e){return t.length<=e?t:t.substring(0,e)},r.prototype._truncateToSize=function(t){var e=this,n=this._attributeValueLengthLimit;return n<=0?(h.warn("Attribute value limit must be positive, got "+n),t):typeof t=="string"?this._truncateToLimitUtil(t,n):Array.isArray(t)?t.map(function(o){return typeof o=="string"?e._truncateToLimitUtil(o,n):o}):t},r}(),st;(function(r){r[r.NOT_RECORD=0]="NOT_RECORD",r[r.RECORD=1]="RECORD",r[r.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(st||(st={}));var jt=function(){function r(){}return r.prototype.shouldSample=function(){return{decision:st.NOT_RECORD}},r.prototype.toString=function(){return"AlwaysOffSampler"},r}(),ot=function(){function r(){}return r.prototype.shouldSample=function(){return{decision:st.RECORD_AND_SAMPLED}},r.prototype.toString=function(){return"AlwaysOnSampler"},r}(),ve=function(){function r(t){var e,n,o,i;this._root=t.root,this._root||(w(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new ot),this._remoteParentSampled=(e=t.remoteParentSampled)!==null&&e!==void 0?e:new ot,this._remoteParentNotSampled=(n=t.remoteParentNotSampled)!==null&&n!==void 0?n:new jt,this._localParentSampled=(o=t.localParentSampled)!==null&&o!==void 0?o:new ot,this._localParentNotSampled=(i=t.localParentNotSampled)!==null&&i!==void 0?i:new jt}return r.prototype.shouldSample=function(t,e,n,o,i,u){var s=A.getSpanContext(t);return!s||!Vt(s)?this._root.shouldSample(t,e,n,o,i,u):s.isRemote?s.traceFlags&B.SAMPLED?this._remoteParentSampled.shouldSample(t,e,n,o,i,u):this._remoteParentNotSampled.shouldSample(t,e,n,o,i,u):s.traceFlags&B.SAMPLED?this._localParentSampled.shouldSample(t,e,n,o,i,u):this._localParentNotSampled.shouldSample(t,e,n,o,i,u)},r.prototype.toString=function(){return"ParentBased{root="+this._root.toString()+", remoteParentSampled="+this._remoteParentSampled.toString()+", remoteParentNotSampled="+this._remoteParentNotSampled.toString()+", localParentSampled="+this._localParentSampled.toString()+", localParentNotSampled="+this._localParentNotSampled.toString()+"}"},r}(),Be=function(){function r(t){t===void 0&&(t=0),this._ratio=t,this._ratio=this._normalize(t),this._upperBound=Math.floor(this._ratio*4294967295)}return r.prototype.shouldSample=function(t,e){return{decision:cn(e)&&this._accumulate(e)<this._upperBound?st.RECORD_AND_SAMPLED:st.NOT_RECORD}},r.prototype.toString=function(){return"TraceIdRatioBased{"+this._ratio+"}"},r.prototype._normalize=function(t){return typeof t!="number"||isNaN(t)?0:t>=1?1:t<=0?0:t},r.prototype._accumulate=function(t){for(var e=0,n=0;n<t.length/8;n++){var o=n*8,i=parseInt(t.slice(o,o+8),16);e=(e^i)>>>0}return e},r}(),rl=P.AlwaysOn,et=1;function ci(){var r=I();return{sampler:li(r),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:r.OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:r.OTEL_ATTRIBUTE_COUNT_LIMIT},spanLimits:{attributeValueLengthLimit:r.OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:r.OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT,linkCountLimit:r.OTEL_SPAN_LINK_COUNT_LIMIT,eventCountLimit:r.OTEL_SPAN_EVENT_COUNT_LIMIT,attributePerEventCountLimit:r.OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT,attributePerLinkCountLimit:r.OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT},mergeResourceWithDefaults:!0}}function li(r){switch(r===void 0&&(r=I()),r.OTEL_TRACES_SAMPLER){case P.AlwaysOn:return new ot;case P.AlwaysOff:return new jt;case P.ParentBasedAlwaysOn:return new ve({root:new ot});case P.ParentBasedAlwaysOff:return new ve({root:new jt});case P.TraceIdRatio:return new Be(Vr(r));case P.ParentBasedTraceIdRatio:return new ve({root:new Be(Vr(r))});default:return h.error('OTEL_TRACES_SAMPLER value "'+r.OTEL_TRACES_SAMPLER+" invalid, defaulting to "+rl+'".'),new ot}}function Vr(r){if(r.OTEL_TRACES_SAMPLER_ARG===void 0||r.OTEL_TRACES_SAMPLER_ARG==="")return h.error("OTEL_TRACES_SAMPLER_ARG is blank, defaulting to "+et+"."),et;var t=Number(r.OTEL_TRACES_SAMPLER_ARG);return isNaN(t)?(h.error("OTEL_TRACES_SAMPLER_ARG="+r.OTEL_TRACES_SAMPLER_ARG+" was given, but it is invalid, defaulting to "+et+"."),et):t<0||t>1?(h.error("OTEL_TRACES_SAMPLER_ARG="+r.OTEL_TRACES_SAMPLER_ARG+" was given, but it is out of range ([0..1]), defaulting to "+et+"."),et):t}function nl(r){var t={sampler:li()},e=ci(),n=Object.assign({},e,t,r);return n.generalLimits=Object.assign({},e.generalLimits,r.generalLimits||{}),n.spanLimits=Object.assign({},e.spanLimits,r.spanLimits||{}),n}function il(r){var t,e,n,o,i,u,s,c,a,l,f,d,_=Object.assign({},r.spanLimits),p=Ye();return _.attributeCountLimit=(u=(i=(o=(e=(t=r.spanLimits)===null||t===void 0?void 0:t.attributeCountLimit)!==null&&e!==void 0?e:(n=r.generalLimits)===null||n===void 0?void 0:n.attributeCountLimit)!==null&&o!==void 0?o:p.OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT)!==null&&i!==void 0?i:p.OTEL_ATTRIBUTE_COUNT_LIMIT)!==null&&u!==void 0?u:nt,_.attributeValueLengthLimit=(d=(f=(l=(c=(s=r.spanLimits)===null||s===void 0?void 0:s.attributeValueLengthLimit)!==null&&c!==void 0?c:(a=r.generalLimits)===null||a===void 0?void 0:a.attributeValueLengthLimit)!==null&&l!==void 0?l:p.OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT)!==null&&f!==void 0?f:p.OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT)!==null&&d!==void 0?d:rt,Object.assign({},r,{spanLimits:_})}var ol=function(){function r(t,e){this._exporter=t,this._isExporting=!1,this._finishedSpans=[],this._droppedSpansCount=0;var n=I();this._maxExportBatchSize=typeof(e==null?void 0:e.maxExportBatchSize)=="number"?e.maxExportBatchSize:n.OTEL_BSP_MAX_EXPORT_BATCH_SIZE,this._maxQueueSize=typeof(e==null?void 0:e.maxQueueSize)=="number"?e.maxQueueSize:n.OTEL_BSP_MAX_QUEUE_SIZE,this._scheduledDelayMillis=typeof(e==null?void 0:e.scheduledDelayMillis)=="number"?e.scheduledDelayMillis:n.OTEL_BSP_SCHEDULE_DELAY,this._exportTimeoutMillis=typeof(e==null?void 0:e.exportTimeoutMillis)=="number"?e.exportTimeoutMillis:n.OTEL_BSP_EXPORT_TIMEOUT,this._shutdownOnce=new ct(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(h.warn("BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}return r.prototype.forceFlush=function(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()},r.prototype.onStart=function(t,e){},r.prototype.onEnd=function(t){this._shutdownOnce.isCalled||t.spanContext().traceFlags&B.SAMPLED&&this._addToBuffer(t)},r.prototype.shutdown=function(){return this._shutdownOnce.call()},r.prototype._shutdown=function(){var t=this;return Promise.resolve().then(function(){return t.onShutdown()}).then(function(){return t._flushAll()}).then(function(){return t._exporter.shutdown()})},r.prototype._addToBuffer=function(t){if(this._finishedSpans.length>=this._maxQueueSize){this._droppedSpansCount===0&&h.debug("maxQueueSize reached, dropping spans"),this._droppedSpansCount++;return}this._droppedSpansCount>0&&(h.warn("Dropped "+this._droppedSpansCount+" spans because maxQueueSize reached"),this._droppedSpansCount=0),this._finishedSpans.push(t),this._maybeStartTimer()},r.prototype._flushAll=function(){var t=this;return new Promise(function(e,n){for(var o=[],i=Math.ceil(t._finishedSpans.length/t._maxExportBatchSize),u=0,s=i;u<s;u++)o.push(t._flushOneBatch());Promise.all(o).then(function(){e()}).catch(n)})},r.prototype._flushOneBatch=function(){var t=this;return this._clearTimer(),this._finishedSpans.length===0?Promise.resolve():new Promise(function(e,n){var o=setTimeout(function(){n(new Error("Timeout"))},t._exportTimeoutMillis);b.with(Ve(b.active()),function(){var i;t._finishedSpans.length<=t._maxExportBatchSize?(i=t._finishedSpans,t._finishedSpans=[]):i=t._finishedSpans.splice(0,t._maxExportBatchSize);for(var u=function(){return t._exporter.export(i,function(f){var d;clearTimeout(o),f.code===T.SUCCESS?e():n((d=f.error)!==null&&d!==void 0?d:new Error("BatchSpanProcessor: span export failed"))})},s=null,c=0,a=i.length;c<a;c++){var l=i[c];l.resource.asyncAttributesPending&&l.resource.waitForAsyncAttributes&&(s??(s=[]),s.push(l.resource.waitForAsyncAttributes()))}s===null?u():Promise.all(s).then(u,function(f){w(f),n(f)})})})},r.prototype._maybeStartTimer=function(){var t=this;if(!this._isExporting){var e=function(){t._isExporting=!0,t._flushOneBatch().finally(function(){t._isExporting=!1,t._finishedSpans.length>0&&(t._clearTimer(),t._maybeStartTimer())}).catch(function(n){t._isExporting=!1,w(n)})};if(this._finishedSpans.length>=this._maxExportBatchSize)return e();this._timer===void 0&&(this._timer=setTimeout(function(){return e()},this._scheduledDelayMillis),this._timer,void 0)}},r.prototype._clearTimer=function(){this._timer!==void 0&&(clearTimeout(this._timer),this._timer=void 0)},r}(),al=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),fi=function(r){al(t,r);function t(e,n){var o=r.call(this,e,n)||this;return o.onInit(n),o}return t.prototype.onInit=function(e){var n=this;(e==null?void 0:e.disableAutoFlushOnDocumentHide)!==!0&&typeof document<"u"&&(this._visibilityChangeListener=function(){document.visibilityState==="hidden"&&n.forceFlush().catch(function(o){w(o)})},this._pageHideListener=function(){n.forceFlush().catch(function(o){w(o)})},document.addEventListener("visibilitychange",this._visibilityChangeListener),document.addEventListener("pagehide",this._pageHideListener))},t.prototype.onShutdown=function(){typeof document<"u"&&(this._visibilityChangeListener&&document.removeEventListener("visibilitychange",this._visibilityChangeListener),this._pageHideListener&&document.removeEventListener("pagehide",this._pageHideListener))},t}(ol),ul=8,sl=16,cl=function(){function r(){this.generateTraceId=Xr(sl),this.generateSpanId=Xr(ul)}return r}(),wt=Array(32);function Xr(r){return function(){for(var e=0;e<r*2;e++)wt[e]=Math.floor(Math.random()*16)+48,wt[e]>=58&&(wt[e]+=39);return String.fromCharCode.apply(null,wt.slice(0,r*2))}}var ll=function(){function r(t,e,n){this._tracerProvider=n;var o=nl(e);this._sampler=o.sampler,this._generalLimits=o.generalLimits,this._spanLimits=o.spanLimits,this._idGenerator=e.idGenerator||new cl,this.resource=n.resource,this.instrumentationLibrary=t}return r.prototype.startSpan=function(t,e,n){var o,i,u;e===void 0&&(e={}),n===void 0&&(n=b.active()),e.root&&(n=A.deleteSpan(n));var s=A.getSpan(n);if(Xt(n)){h.debug("Instrumentation suppressed, returning Noop Span");var c=A.wrapSpanContext(Li);return c}var a=s==null?void 0:s.spanContext(),l=this._idGenerator.generateSpanId(),f,d,_;!a||!A.isSpanContextValid(a)?f=this._idGenerator.generateTraceId():(f=a.traceId,d=a.traceState,_=a.spanId);var p=(o=e.kind)!==null&&o!==void 0?o:ln.INTERNAL,y=((i=e.links)!==null&&i!==void 0?i:[]).map(function(lt){return{context:lt.context,attributes:pt(lt.attributes)}}),O=pt(e.attributes),m=this._sampler.shouldSample(n,f,t,p,O,y);d=(u=m.traceState)!==null&&u!==void 0?u:d;var E=m.decision===ut.RECORD_AND_SAMPLED?B.SAMPLED:B.NONE,S={traceId:f,spanId:l,traceFlags:E,traceState:d};if(m.decision===ut.NOT_RECORD){h.debug("Recording is off, propagating context in a non-recording span");var c=A.wrapSpanContext(S);return c}var Qt=pt(Object.assign(O,m.attributes)),Zt=new el(this,n,t,S,p,_,y,e.startTime,void 0,Qt);return Zt},r.prototype.startActiveSpan=function(t,e,n,o){var i,u,s;if(!(arguments.length<2)){arguments.length===2?s=e:arguments.length===3?(i=e,s=n):(i=e,u=n,s=o);var c=u??b.active(),a=this.startSpan(t,i,c),l=A.setSpan(c,a);return b.with(l,s,void 0,a)}},r.prototype.getGeneralLimits=function(){return this._generalLimits},r.prototype.getSpanLimits=function(){return this._spanLimits},r.prototype.getActiveSpanProcessor=function(){return this._tracerProvider.getActiveSpanProcessor()},r}(),Ot=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},$r=function(){function r(t){this._spanProcessors=t}return r.prototype.forceFlush=function(){var t,e,n=[];try{for(var o=Ot(this._spanProcessors),i=o.next();!i.done;i=o.next()){var u=i.value;n.push(u.forceFlush())}}catch(s){t={error:s}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return new Promise(function(s){Promise.all(n).then(function(){s()}).catch(function(c){w(c||new Error("MultiSpanProcessor: forceFlush failed")),s()})})},r.prototype.onStart=function(t,e){var n,o;try{for(var i=Ot(this._spanProcessors),u=i.next();!u.done;u=i.next()){var s=u.value;s.onStart(t,e)}}catch(c){n={error:c}}finally{try{u&&!u.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}},r.prototype.onEnd=function(t){var e,n;try{for(var o=Ot(this._spanProcessors),i=o.next();!i.done;i=o.next()){var u=i.value;u.onEnd(t)}}catch(s){e={error:s}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}},r.prototype.shutdown=function(){var t,e,n=[];try{for(var o=Ot(this._spanProcessors),i=o.next();!i.done;i=o.next()){var u=i.value;n.push(u.shutdown())}}catch(s){t={error:s}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return new Promise(function(s,c){Promise.all(n).then(function(){s()},c)})},r}(),fl=function(){function r(){}return r.prototype.onStart=function(t,e){},r.prototype.onEnd=function(t){},r.prototype.shutdown=function(){return Promise.resolve()},r.prototype.forceFlush=function(){return Promise.resolve()},r}(),dl=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},hl=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},z;(function(r){r[r.resolved=0]="resolved",r[r.timeout=1]="timeout",r[r.error=2]="error",r[r.unresolved=3]="unresolved"})(z||(z={}));var _l=function(){function r(t){t===void 0&&(t={});var e,n;this._registeredSpanProcessors=[],this._tracers=new Map;var o=qe({},ci(),il(t));if(this.resource=(e=o.resource)!==null&&e!==void 0?e:H.empty(),o.mergeResourceWithDefaults&&(this.resource=H.default().merge(this.resource)),this._config=Object.assign({},o,{resource:this.resource}),!((n=t.spanProcessors)===null||n===void 0)&&n.length)this._registeredSpanProcessors=hl([],dl(t.spanProcessors),!1),this.activeSpanProcessor=new $r(this._registeredSpanProcessors);else{var i=this._buildExporterFromEnv();if(i!==void 0){var u=new fi(i);this.activeSpanProcessor=u}else this.activeSpanProcessor=new fl}}return r.prototype.getTracer=function(t,e,n){var o=t+"@"+(e||"")+":"+((n==null?void 0:n.schemaUrl)||"");return this._tracers.has(o)||this._tracers.set(o,new ll({name:t,version:e,schemaUrl:n==null?void 0:n.schemaUrl},this._config,this)),this._tracers.get(o)},r.prototype.addSpanProcessor=function(t){this._registeredSpanProcessors.length===0&&this.activeSpanProcessor.shutdown().catch(function(e){return h.error("Error while trying to shutdown current span processor",e)}),this._registeredSpanProcessors.push(t),this.activeSpanProcessor=new $r(this._registeredSpanProcessors)},r.prototype.getActiveSpanProcessor=function(){return this.activeSpanProcessor},r.prototype.register=function(t){t===void 0&&(t={}),A.setGlobalTracerProvider(this),t.propagator===void 0&&(t.propagator=this._buildPropagatorFromEnv()),t.contextManager&&b.setGlobalContextManager(t.contextManager),t.propagator&&D.setGlobalPropagator(t.propagator)},r.prototype.forceFlush=function(){var t=this._config.forceFlushTimeoutMillis,e=this._registeredSpanProcessors.map(function(n){return new Promise(function(o){var i,u=setTimeout(function(){o(new Error("Span processor did not completed within timeout period of "+t+" ms")),i=z.timeout},t);n.forceFlush().then(function(){clearTimeout(u),i!==z.timeout&&(i=z.resolved,o(i))}).catch(function(s){clearTimeout(u),i=z.error,o(s)})})});return new Promise(function(n,o){Promise.all(e).then(function(i){var u=i.filter(function(s){return s!==z.resolved});u.length>0?o(u):n()}).catch(function(i){return o([i])})})},r.prototype.shutdown=function(){return this.activeSpanProcessor.shutdown()},r.prototype._getPropagator=function(t){var e;return(e=this.constructor._registeredPropagators.get(t))===null||e===void 0?void 0:e()},r.prototype._getSpanExporter=function(t){var e;return(e=this.constructor._registeredExporters.get(t))===null||e===void 0?void 0:e()},r.prototype._buildPropagatorFromEnv=function(){var t=this,e=Array.from(new Set(I().OTEL_PROPAGATORS)),n=e.map(function(i){var u=t._getPropagator(i);return u||h.warn('Propagator "'+i+'" requested through environment variable is unavailable.'),u}),o=n.reduce(function(i,u){return u&&i.push(u),i},[]);if(o.length!==0)return e.length===1?o[0]:new xn({propagators:o})},r.prototype._buildExporterFromEnv=function(){var t=I().OTEL_TRACES_EXPORTER;if(!(t==="none"||t==="")){var e=this._getSpanExporter(t);return e||h.error('Exporter "'+t+'" requested through environment variable is unavailable.'),e}},r._registeredPropagators=new Map([["tracecontext",function(){return new Nn}],["baggage",function(){return new En}]]),r._registeredExporters=new Map,r}(),pl=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},vl=function(){function r(){}return r.prototype.export=function(t,e){return this._sendSpans(t,e)},r.prototype.shutdown=function(){return this._sendSpans([]),this.forceFlush()},r.prototype.forceFlush=function(){return Promise.resolve()},r.prototype._exportInfo=function(t){var e;return{resource:{attributes:t.resource.attributes},instrumentationScope:t.instrumentationLibrary,traceId:t.spanContext().traceId,parentId:t.parentSpanId,traceState:(e=t.spanContext().traceState)===null||e===void 0?void 0:e.serialize(),name:t.name,id:t.spanContext().spanId,kind:t.kind,timestamp:k(t.startTime),duration:k(t.duration),attributes:t.attributes,status:t.status,events:t.events,links:t.links}},r.prototype._sendSpans=function(t,e){var n,o;try{for(var i=pl(t),u=i.next();!u.done;u=i.next()){var s=u.value;console.dir(this._exportInfo(s),{depth:3})}}catch(c){n={error:c}}finally{try{u&&!u.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}if(e)return e({code:T.SUCCESS})},r}(),yl=function(r,t,e,n){function o(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function s(l){try{a(n.next(l))}catch(f){u(f)}}function c(l){try{a(n.throw(l))}catch(f){u(f)}}function a(l){l.done?i(l.value):o(l.value).then(s,c)}a((n=n.apply(r,t||[])).next())})},ml=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(l){return c([a,l])}}function c(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,o=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(l){a=[6,l],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},gl=function(){function r(t){this._exporter=t,this._shutdownOnce=new ct(this._shutdown,this),this._unresolvedExports=new Set}return r.prototype.forceFlush=function(){return yl(this,void 0,void 0,function(){return ml(this,function(t){switch(t.label){case 0:return[4,Promise.all(Array.from(this._unresolvedExports))];case 1:return t.sent(),this._exporter.forceFlush?[4,this._exporter.forceFlush()]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2]}})})},r.prototype.onStart=function(t,e){},r.prototype.onEnd=function(t){var e=this,n,o;if(!this._shutdownOnce.isCalled&&t.spanContext().traceFlags&B.SAMPLED){var i=function(){return Yt._export(e._exporter,[t]).then(function(s){var c;s.code!==T.SUCCESS&&w((c=s.error)!==null&&c!==void 0?c:new Error("SimpleSpanProcessor: span export failed (status "+s+")"))}).catch(function(s){w(s)})};if(t.resource.asyncAttributesPending){var u=(o=(n=t.resource).waitForAsyncAttributes)===null||o===void 0?void 0:o.call(n).then(function(){return u!=null&&e._unresolvedExports.delete(u),i()},function(s){return w(s)});u!=null&&this._unresolvedExports.add(u)}else i()}},r.prototype.shutdown=function(){return this._shutdownOnce.call()},r.prototype._shutdown=function(){return this._exporter.shutdown()},r}(),El=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},Tl=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},Sl=function(){function r(){this._enabled=!1,this._currentContext=ft}return r.prototype._bindFunction=function(t,e){t===void 0&&(t=ft);var n=this,o=function(){for(var i=this,u=[],s=0;s<arguments.length;s++)u[s]=arguments[s];return n.with(t,function(){return e.apply(i,u)})};return Object.defineProperty(o,"length",{enumerable:!1,configurable:!0,writable:!1,value:e.length}),o},r.prototype.active=function(){return this._currentContext},r.prototype.bind=function(t,e){return t===void 0&&(t=this.active()),typeof e=="function"?this._bindFunction(t,e):e},r.prototype.disable=function(){return this._currentContext=ft,this._enabled=!1,this},r.prototype.enable=function(){return this._enabled?this:(this._enabled=!0,this._currentContext=ft,this)},r.prototype.with=function(t,e,n){for(var o=[],i=3;i<arguments.length;i++)o[i-3]=arguments[i];var u=this._currentContext;this._currentContext=t||ft;try{return e.call.apply(e,Tl([n],El(o),!1))}finally{this._currentContext=u}},r}(),bl=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),wl=function(r){bl(t,r);function t(e){e===void 0&&(e={});var n=r.call(this,e)||this;if(e.contextManager)throw"contextManager should be defined in register method not in constructor";if(e.propagator)throw"propagator should be defined in register method not in constructor";return n}return t.prototype.register=function(e){e===void 0&&(e={}),e.contextManager===void 0&&(e.contextManager=new Sl),e.contextManager&&e.contextManager.enable(),r.prototype.register.call(this,e)},t}(_l),g;(function(r){r.CONNECT_END="connectEnd",r.CONNECT_START="connectStart",r.DECODED_BODY_SIZE="decodedBodySize",r.DOM_COMPLETE="domComplete",r.DOM_CONTENT_LOADED_EVENT_END="domContentLoadedEventEnd",r.DOM_CONTENT_LOADED_EVENT_START="domContentLoadedEventStart",r.DOM_INTERACTIVE="domInteractive",r.DOMAIN_LOOKUP_END="domainLookupEnd",r.DOMAIN_LOOKUP_START="domainLookupStart",r.ENCODED_BODY_SIZE="encodedBodySize",r.FETCH_START="fetchStart",r.LOAD_EVENT_END="loadEventEnd",r.LOAD_EVENT_START="loadEventStart",r.NAVIGATION_START="navigationStart",r.REDIRECT_END="redirectEnd",r.REDIRECT_START="redirectStart",r.REQUEST_START="requestStart",r.RESPONSE_END="responseEnd",r.RESPONSE_START="responseStart",r.SECURE_CONNECTION_START="secureConnectionStart",r.UNLOAD_EVENT_END="unloadEventEnd",r.UNLOAD_EVENT_START="unloadEventStart"})(g||(g={}));var ye;function Ol(){return ye||(ye=document.createElement("a")),ye}function He(r,t){return t in r}function U(r,t,e,n){var o=void 0,i=void 0;He(e,t)&&typeof e[t]=="number"&&(o=e[t]);var u=g.FETCH_START;if(He(e,u)&&typeof e[u]=="number"&&(i=e[u]),o!==void 0&&i!==void 0&&o>=i)return r.addEvent(t,o),r}function zr(r,t,e){e===void 0&&(e=!1),e||(U(r,g.FETCH_START,t),U(r,g.DOMAIN_LOOKUP_START,t),U(r,g.DOMAIN_LOOKUP_END,t),U(r,g.CONNECT_START,t),He(t,"name")&&t.name.startsWith("https:")&&U(r,g.SECURE_CONNECTION_START,t),U(r,g.CONNECT_END,t),U(r,g.REQUEST_START,t),U(r,g.RESPONSE_START,t),U(r,g.RESPONSE_END,t));var n=t[g.ENCODED_BODY_SIZE];n!==void 0&&r.setAttribute(ca,n);var o=t[g.DECODED_BODY_SIZE];o!==void 0&&n!==o&&r.setAttribute(la,o)}function Al(r){return r.slice().sort(function(t,e){var n=t[g.FETCH_START],o=e[g.FETCH_START];return n>o?1:n<o?-1:0})}function di(){return typeof location<"u"?location.origin:void 0}function Rl(r,t,e,n,o,i){o===void 0&&(o=new WeakSet);var u=kt(r);r=u.toString();var s=Pl(r,t,e,n,o,i);if(s.length===0)return{mainRequest:void 0};if(s.length===1)return{mainRequest:s[0]};var c=Al(s);if(u.origin!==di()&&c.length>1){var a=c[0],l=Ll(c,a[g.RESPONSE_END],e),f=a[g.RESPONSE_END],d=l[g.FETCH_START];return d<f&&(l=a,a=void 0),{corsPreFlightRequest:a,mainRequest:l}}else return{mainRequest:s[0]}}function Ll(r,t,e){for(var n=M(e),o=M(F(t)),i=r[1],u,s=r.length,c=1;c<s;c++){var a=r[c],l=M(F(a[g.FETCH_START])),f=M(F(a[g.RESPONSE_END])),d=n-f;l>=o&&(!u||d<u)&&(u=d,i=a)}return i}function Pl(r,t,e,n,o,i){var u=M(t),s=M(e),c=n.filter(function(a){var l=M(F(a[g.FETCH_START])),f=M(F(a[g.RESPONSE_END]));return a.initiatorType.toLowerCase()===i&&a.name===r&&l>=u&&f<=s});return c.length>0&&(c=c.filter(function(a){return!o.has(a)})),c}function kt(r){if(typeof URL=="function")return new URL(r,typeof document<"u"?document.baseURI:typeof location<"u"?location.href:void 0);var t=Ol();return t.href=r,t}function Cl(r,t){var e=t||[];(typeof e=="string"||e instanceof RegExp)&&(e=[e]);var n=kt(r);return n.origin===di()?!0:e.some(function(o){return Ze(r,o)})}var hi=function(){function r(){}return r.prototype.emit=function(t){},r}(),_i=new hi,xl=function(){function r(){}return r.prototype.getLogger=function(t,e,n){return new hi},r}(),pi=new xl,Ml=function(){function r(t,e,n,o){this._provider=t,this.name=e,this.version=n,this.options=o}return r.prototype.emit=function(t){this._getLogger().emit(t)},r.prototype._getLogger=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateLogger(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):_i},r}(),Yr=function(){function r(){}return r.prototype.getLogger=function(t,e,n){var o;return(o=this.getDelegateLogger(t,e,n))!==null&&o!==void 0?o:new Ml(this,t,e,n)},r.prototype.getDelegate=function(){var t;return(t=this._delegate)!==null&&t!==void 0?t:pi},r.prototype.setDelegate=function(t){this._delegate=t},r.prototype.getDelegateLogger=function(t,e,n){var o;return(o=this._delegate)===null||o===void 0?void 0:o.getLogger(t,e,n)},r}(),Il=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof global=="object"?global:{},At=Symbol.for("io.opentelemetry.js.api.logs"),_t=Il;function Nl(r,t,e){return function(n){return n===r?t:e}}var Wr=1,Ul=function(){function r(){this._proxyLoggerProvider=new Yr}return r.getInstance=function(){return this._instance||(this._instance=new r),this._instance},r.prototype.setGlobalLoggerProvider=function(t){return _t[At]?this.getLoggerProvider():(_t[At]=Nl(Wr,t,pi),this._proxyLoggerProvider.setDelegate(t),t)},r.prototype.getLoggerProvider=function(){var t,e;return(e=(t=_t[At])===null||t===void 0?void 0:t.call(_t,Wr))!==null&&e!==void 0?e:this._proxyLoggerProvider},r.prototype.getLogger=function(t,e,n){return this.getLoggerProvider().getLogger(t,e,n)},r.prototype.disable=function(){delete _t[At],this._proxyLoggerProvider=new Yr},r}(),Dl=Ul.getInstance(),me,Kr;function Bl(){if(Kr)return me;Kr=1;function r(c){return typeof c=="function"}var t=console.error.bind(console);function e(c,a,l){var f=!!c[a]&&c.propertyIsEnumerable(a);Object.defineProperty(c,a,{configurable:!0,enumerable:f,writable:!0,value:l})}function n(c){c&&c.logger&&(r(c.logger)?t=c.logger:t("new logger isn't a function, not replacing"))}function o(c,a,l){if(!c||!c[a]){t("no original function "+a+" to wrap");return}if(!l){t("no wrapper function"),t(new Error().stack);return}if(!r(c[a])||!r(l)){t("original object and wrapper must be functions");return}var f=c[a],d=l(f,a);return e(d,"__original",f),e(d,"__unwrap",function(){c[a]===d&&e(c,a,f)}),e(d,"__wrapped",!0),e(c,a,d),d}function i(c,a,l){if(c)Array.isArray(c)||(c=[c]);else{t("must provide one or more modules to patch"),t(new Error().stack);return}if(!(a&&Array.isArray(a))){t("must provide one or more functions to wrap on modules");return}c.forEach(function(f){a.forEach(function(d){o(f,d,l)})})}function u(c,a){if(!c||!c[a]){t("no function to unwrap."),t(new Error().stack);return}if(!c[a].__unwrap)t("no original to unwrap to -- has "+a+" already been unwrapped?");else return c[a].__unwrap()}function s(c,a){if(c)Array.isArray(c)||(c=[c]);else{t("must provide one or more modules to patch"),t(new Error().stack);return}if(!(a&&Array.isArray(a))){t("must provide one or more functions to unwrap on modules");return}c.forEach(function(l){a.forEach(function(f){u(l,f)})})}return n.wrap=o,n.massWrap=i,n.unwrap=u,n.massUnwrap=s,me=n,me}var Rt=Bl(),Ge=function(){return Ge=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},Ge.apply(this,arguments)},Hl=function(){function r(t,e,n){this.instrumentationName=t,this.instrumentationVersion=e,this._config={},this._wrap=Rt.wrap,this._unwrap=Rt.unwrap,this._massWrap=Rt.massWrap,this._massUnwrap=Rt.massUnwrap,this.setConfig(n),this._diag=h.createComponentLogger({namespace:t}),this._tracer=A.getTracer(t,e),this._meter=Pi.getMeter(t,e),this._logger=Dl.getLogger(t,e),this._updateMetricInstruments()}return Object.defineProperty(r.prototype,"meter",{get:function(){return this._meter},enumerable:!1,configurable:!0}),r.prototype.setMeterProvider=function(t){this._meter=t.getMeter(this.instrumentationName,this.instrumentationVersion),this._updateMetricInstruments()},Object.defineProperty(r.prototype,"logger",{get:function(){return this._logger},enumerable:!1,configurable:!0}),r.prototype.setLoggerProvider=function(t){this._logger=t.getLogger(this.instrumentationName,this.instrumentationVersion)},r.prototype.getModuleDefinitions=function(){var t,e=(t=this.init())!==null&&t!==void 0?t:[];return Array.isArray(e)?e:[e]},r.prototype._updateMetricInstruments=function(){},r.prototype.getConfig=function(){return this._config},r.prototype.setConfig=function(t){this._config=Ge({enabled:!0},t)},r.prototype.setTracerProvider=function(t){this._tracer=t.getTracer(this.instrumentationName,this.instrumentationVersion)},Object.defineProperty(r.prototype,"tracer",{get:function(){return this._tracer},enumerable:!1,configurable:!0}),r.prototype._runSpanCustomizationHook=function(t,e,n,o){if(t)try{t(n,o)}catch(i){this._diag.error("Error running span customization hook due to exception in handler",{triggerName:e},i)}},r}(),Gl=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),jl=function(r){Gl(t,r);function t(e,n,o){var i=r.call(this,e,n,o)||this;return i._config.enabled&&i.enable(),i}return t}(Hl);function kl(r,t,e){var n,o;try{o=r()}catch(i){n=i}finally{return t(n,o),o}}function Fl(r){return typeof r=="function"&&typeof r.__original=="function"&&typeof r.__unwrap=="function"&&r.__wrapped===!0}var Ft;(function(r){r.COMPONENT="component",r.HTTP_ERROR_NAME="http.error_name",r.HTTP_STATUS_TEXT="http.status_text"})(Ft||(Ft={}));var Vl=function(r,t,e,n){function o(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function s(l){try{a(n.next(l))}catch(f){u(f)}}function c(l){try{a(n.throw(l))}catch(f){u(f)}}function a(l){l.done?i(l.value):o(l.value).then(s,c)}a((n=n.apply(r,t||[])).next())})},Xl=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(l){return c([a,l])}}function c(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,o=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(l){a=[6,l],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},$l=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},zl=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},vi=h.createComponentLogger({namespace:"@opentelemetry/opentelemetry-instrumentation-fetch/utils"});function Yl(){for(var r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];if(r[0]instanceof URL||typeof r[0]=="string"){var e=r[1];if(!(e!=null&&e.body))return Promise.resolve();if(e.body instanceof ReadableStream){var n=Wl(e.body),o=n.body,i=n.length;return e.body=o,i}else return Promise.resolve(Kl(e.body))}else{var u=r[0];return u!=null&&u.body?u.clone().text().then(function(s){return je(s)}):Promise.resolve()}}function Wl(r){if(!r.pipeThrough)return vi.warn("Platform has ReadableStream but not pipeThrough!"),{body:r,length:Promise.resolve(void 0)};var t=0,e,n=new Promise(function(i){e=i}),o=new TransformStream({start:function(){},transform:function(i,u){return Vl(this,void 0,void 0,function(){var s;return Xl(this,function(c){switch(c.label){case 0:return[4,i];case 1:return s=c.sent(),t+=s.byteLength,u.enqueue(i),[2]}})})},flush:function(){e(t)}});return{body:r.pipeThrough(o),length:n}}function Kl(r){if(typeof Document<"u"&&r instanceof Document)return new XMLSerializer().serializeToString(document).length;if(r instanceof Blob)return r.size;if(r.byteLength!==void 0)return r.byteLength;if(r instanceof FormData)return Ql(r);if(r instanceof URLSearchParams)return je(r.toString());if(typeof r=="string")return je(r);vi.warn("unknown body type")}var ql=new TextEncoder;function je(r){return ql.encode(r).byteLength}function Ql(r){var t,e,n=0;try{for(var o=$l(r.entries()),i=o.next();!i.done;i=o.next()){var u=zl(i.value,2),s=u[0],c=u[1];n+=s.length,c instanceof Blob?n+=c.size:n+=c.length}}catch(a){t={error:a}}finally{try{i&&!i.done&&(e=o.return)&&e.call(o)}finally{if(t)throw t.error}}return n}var qr="0.57.1",Zl=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Jl=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},tf=function(r,t,e){if(e||arguments.length===2)for(var n=0,o=t.length,i;n<o;n++)(i||!(n in t))&&(i||(i=Array.prototype.slice.call(t,0,n)),i[n]=t[n]);return r.concat(i||Array.prototype.slice.call(t))},ge,ef=300,Qr=typeof process=="object"&&((ge=process.release)===null||ge===void 0?void 0:ge.name)==="node",rf=function(r){Zl(t,r);function t(e){e===void 0&&(e={});var n=r.call(this,"@opentelemetry/instrumentation-fetch",qr,e)||this;return n.component="fetch",n.version=qr,n.moduleName=n.component,n._usedResources=new WeakSet,n._tasksCount=0,n}return t.prototype.init=function(){},t.prototype._addChildSpan=function(e,n){var o=this.tracer.startSpan("CORS Preflight",{startTime:n[g.FETCH_START]},A.setSpan(b.active(),e));zr(o,n,this.getConfig().ignoreNetworkEvents),o.end(n[g.RESPONSE_END])},t.prototype._addFinalSpanAttributes=function(e,n){var o=kt(n.url);e.setAttribute(aa,n.status),n.statusText!=null&&e.setAttribute(Ft.HTTP_STATUS_TEXT,n.statusText),e.setAttribute(ia,o.host),e.setAttribute(oa,o.protocol.replace(":","")),typeof navigator<"u"&&e.setAttribute(ua,navigator.userAgent)},t.prototype._addHeaders=function(e,n){if(!Cl(n,this.getConfig().propagateTraceHeaderCorsUrls)){var o={};D.inject(b.active(),o),Object.keys(o).length>0&&this._diag.debug("headers inject skipped due to CORS policy");return}if(e instanceof Request)D.inject(b.active(),e.headers,{set:function(i,u,s){return i.set(u,typeof s=="string"?s:String(s))}});else if(e.headers instanceof Headers)D.inject(b.active(),e.headers,{set:function(i,u,s){return i.set(u,typeof s=="string"?s:String(s))}});else if(e.headers instanceof Map)D.inject(b.active(),e.headers,{set:function(i,u,s){return i.set(u,typeof s=="string"?s:String(s))}});else{var o={};D.inject(b.active(),o),e.headers=Object.assign({},o,e.headers||{})}},t.prototype._clearResources=function(){this._tasksCount===0&&this.getConfig().clearTimingResources&&(performance.clearResourceTimings(),this._usedResources=new WeakSet)},t.prototype._createSpan=function(e,n){var o;if(n===void 0&&(n={}),Fn(e,this.getConfig().ignoreUrls)){this._diag.debug("ignoring span as url matches ignored url");return}var i=(n.method||"GET").toUpperCase(),u="HTTP "+i;return this.tracer.startSpan(u,{kind:ln.CLIENT,attributes:(o={},o[Ft.COMPONENT]=this.moduleName,o[ra]=i,o[na]=e,o)})},t.prototype._findResourceAndAddNetworkEvents=function(e,n,o){var i=n.entries;if(!i.length){if(!performance.getEntriesByType)return;i=performance.getEntriesByType("resource")}var u=Rl(n.spanUrl,n.startTime,o,i,this._usedResources,"fetch");if(u.mainRequest){var s=u.mainRequest;this._markResourceAsUsed(s);var c=u.corsPreFlightRequest;c&&(this._addChildSpan(e,c),this._markResourceAsUsed(c)),zr(e,s,this.getConfig().ignoreNetworkEvents)}},t.prototype._markResourceAsUsed=function(e){this._usedResources.add(e)},t.prototype._endSpan=function(e,n,o){var i=this,u=R(Date.now()),s=mt();this._addFinalSpanAttributes(e,o),setTimeout(function(){var c;(c=n.observer)===null||c===void 0||c.disconnect(),i._findResourceAndAddNetworkEvents(e,n,s),i._tasksCount--,i._clearResources(),e.end(u)},ef)},t.prototype._patchConstructor=function(){var e=this;return function(n){var o=e;return function(){for(var u=[],s=0;s<arguments.length;s++)u[s]=arguments[s];var c=this,a=kt(u[0]instanceof Request?u[0].url:String(u[0])).href,l=u[0]instanceof Request?u[0]:u[1]||{},f=o._createSpan(a,l);if(!f)return n.apply(this,u);var d=o._prepareSpanData(a);o.getConfig().measureRequestSize&&Yl.apply(void 0,tf([],Jl(u),!1)).then(function(m){m&&f.setAttribute(sa,m)}).catch(function(m){o._diag.warn("getFetchBodyLength",m)});function _(m,E){o._applyAttributesAfterFetch(m,l,E),o._endSpan(m,d,{status:E.status||0,statusText:E.message,url:a})}function p(m,E){o._applyAttributesAfterFetch(m,l,E),E.status>=200&&E.status<400?o._endSpan(m,d,E):o._endSpan(m,d,{status:E.status,statusText:E.statusText,url:a})}function y(m,E,S){try{var Qt=S.clone(),Zt=S.clone(),lt=Qt.body;if(lt){var mi=lt.getReader(),ur=function(){mi.read().then(function(Jt){var gi=Jt.done;gi?p(m,Zt):ur()},function(Jt){_(m,Jt)})};ur()}else p(m,S)}finally{E(S)}}function O(m,E,S){try{_(m,S)}finally{E(S)}}return new Promise(function(m,E){return b.with(A.setSpan(b.active(),f),function(){return o._addHeaders(l,a),o._tasksCount++,n.apply(c,l instanceof Request?[l]:[a,l]).then(y.bind(c,f,m),O.bind(c,f,E))})})}}},t.prototype._applyAttributesAfterFetch=function(e,n,o){var i=this,u=this.getConfig().applyCustomAttributesOnSpan;u&&kl(function(){return u(e,n,o)},function(s){s&&i._diag.error("applyCustomAttributesOnSpan",s)})},t.prototype._prepareSpanData=function(e){var n=mt(),o=[];if(typeof PerformanceObserver!="function")return{entries:o,startTime:n,spanUrl:e};var i=new PerformanceObserver(function(u){var s=u.getEntries();s.forEach(function(c){c.initiatorType==="fetch"&&c.name===e&&o.push(c)})});return i.observe({entryTypes:["resource"]}),{entries:o,observer:i,startTime:n,spanUrl:e}},t.prototype.enable=function(){if(Qr){this._diag.warn("this instrumentation is intended for web usage only, it does not instrument Node.js's fetch()");return}Fl(fetch)&&(this._unwrap(it,"fetch"),this._diag.debug("removing previous patch for constructor")),this._wrap(it,"fetch",this._patchConstructor())},t.prototype.disable=function(){Qr||(this._unwrap(it,"fetch"),this._usedResources=new WeakSet)},t}(jl),V={},X={},Ee={};const nf=un(Ci);var Te,Zr;function of(){if(Zr)return Te;Zr=1;function r(u,s,c){for(var a=[],l=Math.max(u.length,s.length),f=0,d=0;d<l||f;){var _=d<u.length?u[d]:0,p=d<s.length?s[d]:0,y=f+_+p;a.push(y%c),f=Math.floor(y/c),d++}return a}function t(u,s,c){if(u<0)return null;if(u==0)return[];for(var a=[],l=s;u&1&&(a=r(a,l,c)),u=u>>1,u!==0;)l=r(l,l,c);return a}function e(u,s){for(var c=u.split(""),a=[],l=c.length-1;l>=0;l--){var f=parseInt(c[l],s);if(isNaN(f))return null;a.push(f)}return a}function n(u,s,c){var a=e(u,s);if(a===null)return null;for(var l=[],f=[1],d=0;d<a.length;d++)a[d]&&(l=r(l,t(a[d],f,c),c)),f=t(s,f,c);for(var _="",d=l.length-1;d>=0;d--)_+=l[d].toString(c);return _===""&&(_="0"),_}function o(u,s){var c=s&&s.prefix===!1,a=n(u,10,16);return a?c?a:"0x"+a:null}function i(u){return u.substring(0,2)==="0x"&&(u=u.substring(2)),u=u.toLowerCase(),n(u,16,10)}return Te={hexToDec:i,decToHex:o},Te}var Jr;function af(){return Jr||(Jr=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.CloudPropagator=r.X_CLOUD_TRACE_HEADER=void 0;const t=nf,e=of();r.X_CLOUD_TRACE_HEADER="x-cloud-trace-context";const n=[r.X_CLOUD_TRACE_HEADER];class o{inject(u,s,c){const a=t.trace.getSpanContext(u);if(!a)return;const l=`${a.traceId}/${(0,e.hexToDec)(a.spanId)};o=${a.traceFlags&t.TraceFlags.SAMPLED}`;c.set(s,r.X_CLOUD_TRACE_HEADER,l)}extract(u,s,c){const a=c.get(s,r.X_CLOUD_TRACE_HEADER),l=Array.isArray(a)?a[0]:a;if(typeof l!="string")return u;const f=l.match(/^([0-9a-fA-F]{32})(?:\/([0-9]+))(?:;o=(.*))?/);if(!f||f[1]==="00000000000000000000000000000000"||f[2]==="0000000000000000")return u;const d={traceId:f[1],spanId:(0,e.decToHex)(f[2],{prefix:!1}).padStart(16,"0"),traceFlags:isNaN(Number(f[3]))||f[3]==="0"?t.TraceFlags.NONE:t.TraceFlags.SAMPLED,isRemote:!0};return t.trace.setSpanContext(u,d)}fields(){return n}}r.CloudPropagator=o}(Ee)),Ee}var tn;function uf(){return tn||(tn=1,function(r){var t=X&&X.__createBinding||(Object.create?function(n,o,i,u){u===void 0&&(u=i);var s=Object.getOwnPropertyDescriptor(o,i);(!s||("get"in s?!o.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return o[i]}}),Object.defineProperty(n,u,s)}:function(n,o,i,u){u===void 0&&(u=i),n[u]=o[i]}),e=X&&X.__exportStar||function(n,o){for(var i in n)i!=="default"&&!Object.prototype.hasOwnProperty.call(o,i)&&t(o,n,i)};Object.defineProperty(r,"__esModule",{value:!0}),e(af(),r)}(X)),X}var Se={},en;function rn(){return en||(en=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.ShopifyHintPropagator=r.SHOPIFY_HINT_HEADER_NAME=void 0,r.SHOPIFY_HINT_HEADER_NAME="X-Shopify-Trace-Hint";class t{extract(n,o,i){return n}inject(n,o,i){i.set(o,r.SHOPIFY_HINT_HEADER_NAME,"true")}fields(){return[r.SHOPIFY_HINT_HEADER_NAME]}}r.ShopifyHintPropagator=t}(Se)),Se}const sf=un(du);var nn;function cf(){return nn||(nn=1,function(r){var t=V&&V.__createBinding||(Object.create?function(d,_,p,y){y===void 0&&(y=p),Object.defineProperty(d,y,{enumerable:!0,get:function(){return _[p]}})}:function(d,_,p,y){y===void 0&&(y=p),d[y]=_[p]}),e=V&&V.__exportStar||function(d,_){for(var p in d)p!=="default"&&!Object.prototype.hasOwnProperty.call(_,p)&&t(_,d,p)};Object.defineProperty(r,"__esModule",{value:!0}),r.shopifyCompositeTextMapPropagator=r.ShopifyPropagator=r.SHOPIFY_TRACE_HEADER_NAME=void 0;const n=uf(),o=rn(),i=sf;e(rn(),r);function u(d){return!(d===void 0||Array.isArray(d)||d===null||d==="")}r.SHOPIFY_TRACE_HEADER_NAME="X-Shopify-Trace-Context";const s=r.SHOPIFY_TRACE_HEADER_NAME.toLowerCase();class c extends n.CloudPropagator{extract(_,p,y){const O=y.get(p,r.SHOPIFY_TRACE_HEADER_NAME)||y.get(p,s);return u(O)?super.extract(_,p,y):_}inject(_,p,y){const O={set:(m,E,S)=>{S!==""&&E===n.X_CLOUD_TRACE_HEADER&&(y.set(m,n.X_CLOUD_TRACE_HEADER,S),y.set(m,r.SHOPIFY_TRACE_HEADER_NAME,S))}};super.inject(_,p,O)}fields(){return[r.SHOPIFY_TRACE_HEADER_NAME,n.X_CLOUD_TRACE_HEADER]}}r.ShopifyPropagator=c;const a=new c,l=new o.ShopifyHintPropagator,f=new i.W3CTraceContextPropagator;r.shopifyCompositeTextMapPropagator=new i.CompositePropagator({propagators:[f,a,l]})}(V)),V}var lf=cf();class ff extends wl{constructor({serviceName:t,env:e,useXhr:n,dev:o,autoInstrumentations:i,samplingRatio:u,otlpBaseURL:s}){super({resource:new H({[ar]:t,[si]:e}),sampler:new Be(u)});const a={url:(typeof s=="string"?s:Gt[e]||e)+Yc};n&&(a.headers={});const l=new Qc(a);if(this.addSpanProcessor(new fi(l,{scheduledDelayMillis:1e3})),o&&this.addSpanProcessor(new gl(new vl)),this.register({propagator:lf.shopifyCompositeTextMapPropagator}),i.includes("fetch")){const f=Object.values(Gt);new rf({ignoreUrls:f,propagateTraceHeaderCorsUrls:[new RegExp(".*")]}).setTracerProvider(this)}}}var df=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),hf=function(r){df(t,r);function t(e){return e===void 0&&(e={}),r.call(this,or(e,yc,"v1/logs",{"Content-Type":"application/json"}))||this}return t}(Je),_f=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},pf=function(r,t){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var n=e.call(r),o,i=[],u;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)i.push(o.value)}catch(s){u={error:s}}finally{try{o&&!o.done&&(e=n.return)&&e.call(n)}finally{if(u)throw u.error}}return i},vf=function(){function r(t,e,n){this.attributes={},this.totalAttributesCount=0,this._isReadonly=!1;var o=n.timestamp,i=n.observedTimestamp,u=n.severityNumber,s=n.severityText,c=n.body,a=n.attributes,l=a===void 0?{}:a,f=n.context,d=Date.now();if(this.hrTime=F(o??d),this.hrTimeObserved=F(i??d),f){var _=A.getSpanContext(f);_&&Vt(_)&&(this.spanContext=_)}this.severityNumber=u,this.severityText=s,this.body=c,this.resource=t.resource,this.instrumentationScope=e,this._logRecordLimits=t.logRecordLimits,this.setAttributes(l)}return Object.defineProperty(r.prototype,"severityText",{get:function(){return this._severityText},set:function(t){this._isLogRecordReadonly()||(this._severityText=t)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"severityNumber",{get:function(){return this._severityNumber},set:function(t){this._isLogRecordReadonly()||(this._severityNumber=t)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"body",{get:function(){return this._body},set:function(t){this._isLogRecordReadonly()||(this._body=t)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"droppedAttributesCount",{get:function(){return this.totalAttributesCount-Object.keys(this.attributes).length},enumerable:!1,configurable:!0}),r.prototype.setAttribute=function(t,e){return this._isLogRecordReadonly()?this:e===null?this:t.length===0?(h.warn("Invalid attribute key: "+t),this):!yt(e)&&!(typeof e=="object"&&!Array.isArray(e)&&Object.keys(e).length>0)?(h.warn("Invalid attribute value set for key: "+t),this):(this.totalAttributesCount+=1,Object.keys(this.attributes).length>=this._logRecordLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,t)?(this.droppedAttributesCount===1&&h.warn("Dropping extra attributes."),this):(yt(e)?this.attributes[t]=this._truncateToSize(e):this.attributes[t]=e,this))},r.prototype.setAttributes=function(t){var e,n;try{for(var o=_f(Object.entries(t)),i=o.next();!i.done;i=o.next()){var u=pf(i.value,2),s=u[0],c=u[1];this.setAttribute(s,c)}}catch(a){e={error:a}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return this},r.prototype.setBody=function(t){return this.body=t,this},r.prototype.setSeverityNumber=function(t){return this.severityNumber=t,this},r.prototype.setSeverityText=function(t){return this.severityText=t,this},r.prototype._makeReadonly=function(){this._isReadonly=!0},r.prototype._truncateToSize=function(t){var e=this,n=this._logRecordLimits.attributeValueLengthLimit;return n<=0?(h.warn("Attribute value limit must be positive, got "+n),t):typeof t=="string"?this._truncateToLimitUtil(t,n):Array.isArray(t)?t.map(function(o){return typeof o=="string"?e._truncateToLimitUtil(o,n):o}):t},r.prototype._truncateToLimitUtil=function(t,e){return t.length<=e?t:t.substring(0,e)},r.prototype._isLogRecordReadonly=function(){return this._isReadonly&&h.warn("Can not execute the operation on emitted log record"),this._isReadonly},r}(),ke=function(){return ke=Object.assign||function(r){for(var t,e=1,n=arguments.length;e<n;e++){t=arguments[e];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=t[o])}return r},ke.apply(this,arguments)},yf=function(){function r(t,e){this.instrumentationScope=t,this._sharedState=e}return r.prototype.emit=function(t){var e=t.context||b.active(),n=new vf(this._sharedState,this.instrumentationScope,ke({context:e},t));this._sharedState.activeProcessor.onEmit(n,e),n._makeReadonly()},r}();function mf(){return{forceFlushTimeoutMillis:3e4,logRecordLimits:{attributeValueLengthLimit:I().OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:I().OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT},includeTraceContext:!0,mergeResourceWithDefaults:!0}}function gf(r){var t,e,n,o,i,u,s=Ye();return{attributeCountLimit:(n=(e=(t=r.attributeCountLimit)!==null&&t!==void 0?t:s.OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT)!==null&&e!==void 0?e:s.OTEL_ATTRIBUTE_COUNT_LIMIT)!==null&&n!==void 0?n:nt,attributeValueLengthLimit:(u=(i=(o=r.attributeValueLengthLimit)!==null&&o!==void 0?o:s.OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT)!==null&&i!==void 0?i:s.OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT)!==null&&u!==void 0?u:rt}}var on=function(r,t,e,n){function o(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function s(l){try{a(n.next(l))}catch(f){u(f)}}function c(l){try{a(n.throw(l))}catch(f){u(f)}}function a(l){l.done?i(l.value):o(l.value).then(s,c)}a((n=n.apply(r,t||[])).next())})},an=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(l){return c([a,l])}}function c(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,o=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(l){a=[6,l],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Ef=function(){function r(t,e){this.processors=t,this.forceFlushTimeoutMillis=e}return r.prototype.forceFlush=function(){return on(this,void 0,void 0,function(){var t;return an(this,function(e){switch(e.label){case 0:return t=this.forceFlushTimeoutMillis,[4,Promise.all(this.processors.map(function(n){return Qe(n.forceFlush(),t)}))];case 1:return e.sent(),[2]}})})},r.prototype.onEmit=function(t,e){this.processors.forEach(function(n){return n.onEmit(t,e)})},r.prototype.shutdown=function(){return on(this,void 0,void 0,function(){return an(this,function(t){switch(t.label){case 0:return[4,Promise.all(this.processors.map(function(e){return e.shutdown()}))];case 1:return t.sent(),[2]}})})},r}(),Tf=function(){function r(){}return r.prototype.forceFlush=function(){return Promise.resolve()},r.prototype.onEmit=function(t,e){},r.prototype.shutdown=function(){return Promise.resolve()},r}(),Sf=function(){function r(t,e,n){this.resource=t,this.forceFlushTimeoutMillis=e,this.logRecordLimits=n,this.loggers=new Map,this.registeredLogRecordProcessors=[],this.activeProcessor=new Tf}return r}(),bf="unknown";function wf(r,t){var e=t??H.empty();return r?H.default().merge(e):e}var Of=function(){function r(t){t===void 0&&(t={});var e=qe({},mf(),t),n=wf(e.mergeResourceWithDefaults,t.resource);this._sharedState=new Sf(n,e.forceFlushTimeoutMillis,gf(e.logRecordLimits)),this._shutdownOnce=new ct(this._shutdown,this)}return r.prototype.getLogger=function(t,e,n){if(this._shutdownOnce.isCalled)return h.warn("A shutdown LoggerProvider cannot provide a Logger"),_i;t||h.warn("Logger requested without instrumentation scope name.");var o=t||bf,i=o+"@"+(e||"")+":"+((n==null?void 0:n.schemaUrl)||"");return this._sharedState.loggers.has(i)||this._sharedState.loggers.set(i,new yf({name:o,version:e,schemaUrl:n==null?void 0:n.schemaUrl},this._sharedState)),this._sharedState.loggers.get(i)},r.prototype.addLogRecordProcessor=function(t){this._sharedState.registeredLogRecordProcessors.length===0&&this._sharedState.activeProcessor.shutdown().catch(function(e){return h.error("Error while trying to shutdown current log record processor",e)}),this._sharedState.registeredLogRecordProcessors.push(t),this._sharedState.activeProcessor=new Ef(this._sharedState.registeredLogRecordProcessors,this._sharedState.forceFlushTimeoutMillis)},r.prototype.forceFlush=function(){return this._shutdownOnce.isCalled?(h.warn("invalid attempt to force flush after LoggerProvider shutdown"),this._shutdownOnce.promise):this._sharedState.activeProcessor.forceFlush()},r.prototype.shutdown=function(){return this._shutdownOnce.isCalled?(h.warn("shutdown may only be called once per LoggerProvider"),this._shutdownOnce.promise):this._shutdownOnce.call()},r.prototype._shutdown=function(){return this._sharedState.activeProcessor.shutdown()},r}(),Af=function(r){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&r[t],n=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&n>=r.length&&(r=void 0),{value:r&&r[n++],done:!r}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Rf=function(){function r(){}return r.prototype.export=function(t,e){this._sendLogRecords(t,e)},r.prototype.shutdown=function(){return Promise.resolve()},r.prototype._exportInfo=function(t){var e,n,o;return{resource:{attributes:t.resource.attributes},instrumentationScope:t.instrumentationScope,timestamp:k(t.hrTime),traceId:(e=t.spanContext)===null||e===void 0?void 0:e.traceId,spanId:(n=t.spanContext)===null||n===void 0?void 0:n.spanId,traceFlags:(o=t.spanContext)===null||o===void 0?void 0:o.traceFlags,severityText:t.severityText,severityNumber:t.severityNumber,body:t.body,attributes:t.attributes}},r.prototype._sendLogRecords=function(t,e){var n,o;try{for(var i=Af(t),u=i.next();!u.done;u=i.next()){var s=u.value;console.dir(this._exportInfo(s),{depth:3})}}catch(c){n={error:c}}finally{try{u&&!u.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}e==null||e({code:T.SUCCESS})},r}(),Lf=function(r,t,e,n){function o(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function s(l){try{a(n.next(l))}catch(f){u(f)}}function c(l){try{a(n.throw(l))}catch(f){u(f)}}function a(l){l.done?i(l.value):o(l.value).then(s,c)}a((n=n.apply(r,t||[])).next())})},Pf=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(l){return c([a,l])}}function c(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,o=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(l){a=[6,l],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},Cf=function(){function r(t){this._exporter=t,this._shutdownOnce=new ct(this._shutdown,this),this._unresolvedExports=new Set}return r.prototype.onEmit=function(t){var e=this,n,o;if(!this._shutdownOnce.isCalled){var i=function(){return Yt._export(e._exporter,[t]).then(function(s){var c;s.code!==T.SUCCESS&&w((c=s.error)!==null&&c!==void 0?c:new Error("SimpleLogRecordProcessor: log record export failed (status "+s+")"))}).catch(w)};if(t.resource.asyncAttributesPending){var u=(o=(n=t.resource).waitForAsyncAttributes)===null||o===void 0?void 0:o.call(n).then(function(){return e._unresolvedExports.delete(u),i()},w);u!=null&&this._unresolvedExports.add(u)}else i()}},r.prototype.forceFlush=function(){return Lf(this,void 0,void 0,function(){return Pf(this,function(t){switch(t.label){case 0:return[4,Promise.all(Array.from(this._unresolvedExports))];case 1:return t.sent(),[2]}})})},r.prototype.shutdown=function(){return this._shutdownOnce.call()},r.prototype._shutdown=function(){return this._exporter.shutdown()},r}(),xf=function(r,t,e,n){function o(i){return i instanceof e?i:new e(function(u){u(i)})}return new(e||(e=Promise))(function(i,u){function s(l){try{a(n.next(l))}catch(f){u(f)}}function c(l){try{a(n.throw(l))}catch(f){u(f)}}function a(l){l.done?i(l.value):o(l.value).then(s,c)}a((n=n.apply(r,t||[])).next())})},Mf=function(r,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},n,o,i,u;return u={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function s(a){return function(l){return c([a,l])}}function c(a){if(n)throw new TypeError("Generator is already executing.");for(;e;)try{if(n=1,o&&(i=a[0]&2?o.return:a[0]?o.throw||((i=o.return)&&i.call(o),0):o.next)&&!(i=i.call(o,a[1])).done)return i;switch(o=0,i&&(a=[a[0]&2,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return e.label++,{value:a[1],done:!1};case 5:e.label++,o=a[1],a=[0];continue;case 7:a=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(a[0]===6||a[0]===2)){e=0;continue}if(a[0]===3&&(!i||a[1]>i[0]&&a[1]<i[3])){e.label=a[1];break}if(a[0]===6&&e.label<i[1]){e.label=i[1],i=a;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(a);break}i[2]&&e.ops.pop(),e.trys.pop();continue}a=t.call(r,e)}catch(l){a=[6,l],o=0}finally{n=i=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}},If=function(){function r(t,e){var n,o,i,u;this._exporter=t,this._finishedLogRecords=[];var s=I();this._maxExportBatchSize=(n=e==null?void 0:e.maxExportBatchSize)!==null&&n!==void 0?n:s.OTEL_BLRP_MAX_EXPORT_BATCH_SIZE,this._maxQueueSize=(o=e==null?void 0:e.maxQueueSize)!==null&&o!==void 0?o:s.OTEL_BLRP_MAX_QUEUE_SIZE,this._scheduledDelayMillis=(i=e==null?void 0:e.scheduledDelayMillis)!==null&&i!==void 0?i:s.OTEL_BLRP_SCHEDULE_DELAY,this._exportTimeoutMillis=(u=e==null?void 0:e.exportTimeoutMillis)!==null&&u!==void 0?u:s.OTEL_BLRP_EXPORT_TIMEOUT,this._shutdownOnce=new ct(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(h.warn("BatchLogRecordProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}return r.prototype.onEmit=function(t){this._shutdownOnce.isCalled||this._addToBuffer(t)},r.prototype.forceFlush=function(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()},r.prototype.shutdown=function(){return this._shutdownOnce.call()},r.prototype._shutdown=function(){return xf(this,void 0,void 0,function(){return Mf(this,function(t){switch(t.label){case 0:return this.onShutdown(),[4,this._flushAll()];case 1:return t.sent(),[4,this._exporter.shutdown()];case 2:return t.sent(),[2]}})})},r.prototype._addToBuffer=function(t){this._finishedLogRecords.length>=this._maxQueueSize||(this._finishedLogRecords.push(t),this._maybeStartTimer())},r.prototype._flushAll=function(){var t=this;return new Promise(function(e,n){for(var o=[],i=Math.ceil(t._finishedLogRecords.length/t._maxExportBatchSize),u=0;u<i;u++)o.push(t._flushOneBatch());Promise.all(o).then(function(){e()}).catch(n)})},r.prototype._flushOneBatch=function(){var t=this;return this._clearTimer(),this._finishedLogRecords.length===0?Promise.resolve():new Promise(function(e,n){Qe(t._export(t._finishedLogRecords.splice(0,t._maxExportBatchSize)),t._exportTimeoutMillis).then(function(){return e()}).catch(n)})},r.prototype._maybeStartTimer=function(){var t=this;this._timer===void 0&&(this._timer=setTimeout(function(){t._flushOneBatch().then(function(){t._finishedLogRecords.length>0&&(t._clearTimer(),t._maybeStartTimer())}).catch(function(e){w(e)})},this._scheduledDelayMillis),this._timer,void 0)},r.prototype._clearTimer=function(){this._timer!==void 0&&(clearTimeout(this._timer),this._timer=void 0)},r.prototype._export=function(t){var e=this,n=function(){return Yt._export(e._exporter,t).then(function(i){var u;i.code!==T.SUCCESS&&w((u=i.error)!==null&&u!==void 0?u:new Error("BatchLogRecordProcessor: log record export failed (status "+i+")"))}).catch(w)},o=t.map(function(i){return i.resource}).filter(function(i){return i.asyncAttributesPending});return o.length===0?n():Promise.all(o.map(function(i){var u;return(u=i.waitForAsyncAttributes)===null||u===void 0?void 0:u.call(i)})).then(n,w)},r}(),Nf=function(){var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(n[i]=o[i])},r(t,e)};return function(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}}(),Uf=function(r){Nf(t,r);function t(e,n){var o=r.call(this,e,n)||this;return o._onInit(n),o}return t.prototype.onShutdown=function(){typeof document>"u"||(this._visibilityChangeListener&&document.removeEventListener("visibilitychange",this._visibilityChangeListener),this._pageHideListener&&document.removeEventListener("pagehide",this._pageHideListener))},t.prototype._onInit=function(e){var n=this;(e==null?void 0:e.disableAutoFlushOnDocumentHide)===!0||typeof document>"u"||(this._visibilityChangeListener=function(){document.visibilityState==="hidden"&&n.forceFlush()},this._pageHideListener=function(){n.forceFlush()},document.addEventListener("visibilitychange",this._visibilityChangeListener),document.addEventListener("pagehide",this._pageHideListener))},t}(If);class Df extends Of{constructor({serviceName:t,env:e,useXhr:n,dev:o,otlpBaseURL:i}){super({resource:new H({[ar]:t,[si]:e})});const s={url:(typeof i=="string"?i:Gt[e]||e)+Wc};n&&(s.headers={});const c=new hf(s);this.addLogRecordProcessor(new Uf(c,{scheduledDelayMillis:1e3})),o&&this.addLogRecordProcessor(new Cf(new Rf))}}let be=function(r){return r.Histogram="Histogram",r.Counter="Counter",r.UpDownCounter="UpDownCounter",r}({});const Bf=new RegExp("[^a-zA-Z_][^a-zA-Z0-9_]*");function Yf(r){return typeof r=="object"&&r!=null&&r.connection!=null&&typeof r.connection=="object"&&Array.isArray(r.events)&&Array.isArray(r.navigations)&&typeof r.pathname=="string"}function Hf(r){return Bf.test(r)?(h.warn(`Metric name ${r} contains invalid characters and will be dropped.
    Service Names and metric names must conform to the following regex %c[a-zA-Z_][a-zA-Z0-9_]*`,"color:red"),!1):!0}const Gf="opentelemetry-js-shopify-web";class jf{constructor({serviceName:t,prefixMetric:e=!1,metrics:n={},onRecord:o,meterProvider:i,loggerProvider:u,tracerProvider:s}){if(this.serviceName=void 0,this.prefixMetric=void 0,this.meterProvider=void 0,this.loggerProvider=void 0,this.tracerProvider=void 0,this.metrics=new Map,this.recordListeners=new Set,!t)throw new Error("Service name is required.");if(this.serviceName=t,this.prefixMetric=e,o&&this.addOnRecord(o),!i)throw new Error("MeterProvider is required.");this.meterProvider=i,this.tracerProvider=s,this.loggerProvider=u,this.register(n)}getMeterProvider(){return this.meterProvider}getTracerProvider(){return this.tracerProvider}getLoggerProvider(){return this.loggerProvider}addView(t){var e,n,o;(e=this.meterProvider._sharedState)===null||e===void 0||(n=e.viewRegistry)===null||n===void 0||(o=n.addView)===null||o===void 0||o.call(n,new Ss(t))}record(t,e,n){const o=this.metrics.get(t);if(!o)throw new Error(`Service ${this.serviceName} has no metrics registered for name: ${t}. Can't record value for unknown metric.`);o(e,n)}registerMetric(t,{type:e,...n}){if(this.metrics.has(t))return;const o=this.meterProvider.getMeter(Gf),i=this.prefixMetric?`${this.serviceName}_${t}`:t;if(!Hf(i))return;const u=()=>{switch(e){case be.Counter:return o.createCounter(i,n);case be.UpDownCounter:return o.createUpDownCounter(i,n);case be.Histogram:{let s;return"boundaries"in n&&n.boundaries?s=new Vn(n.boundaries,!0):s=new Xn,this.addView({instrumentName:i,aggregation:s}),o.createHistogram(i,n)}}};this.metrics.set(t,(s,c)=>{const a=u(),l=(f,d)=>{const[_,p]=this.notifyRecordListeners(t,f,{...d});"record"in a?a.record(_,p):a.add(_,p),this.meterProvider.forceFlush({})};l(s,c),this.metrics.set(t,l)})}register(t){Object.entries(t).forEach(([e,n])=>{this.registerMetric(e,n)})}addOnRecord(t){return this.recordListeners.add(t),()=>{this.recordListeners.delete(t)}}removeOnRecord(t){this.recordListeners.delete(t)}shutdown(){return this.metrics.clear(),this.recordListeners.clear(),this.meterProvider.shutdown().then(()=>{this.tracerProvider&&this.tracerProvider.shutdown(),this.loggerProvider&&this.loggerProvider.shutdown()})}notifyRecordListeners(t,e,n){return Array.from(this.recordListeners).reduce((o,i)=>i(t,...o)||o,[e,n])}}class kf extends jf{constructor({throttleLimit:t=5e3,env:e="local",serviceName:n,prefixMetric:o=!1,metrics:i={},onRecord:u,meterProvider:s,tracerProvider:c,loggerProvider:a,useXhr:l=!1,dev:f=!1,enableDefaultTracer:d=!1,samplingRatio:_=.1,autoInstrumentations:p=[],enableDefaultLogger:y=!1,otlpBaseURL:O}){h.setLogger(new xi,{logLevel:["production","staging"].includes(e)?C.ERROR:C.INFO,suppressOverrideMessage:!0});const m=s??new Kc({serviceName:n,env:e,throttleLimit:t,useXhr:l,dev:f,otlpBaseURL:O});let E;c?E=c:d&&(E=new ff({serviceName:n,env:e,useXhr:l,dev:f,autoInstrumentations:p,samplingRatio:_,otlpBaseURL:O}));let S;a?S=a:y&&(S=new Df({serviceName:n,env:e,useXhr:l,dev:f,otlpBaseURL:O})),super({serviceName:n,meterProvider:m,tracerProvider:E,loggerProvider:S,prefixMetric:o,metrics:i,onRecord:u})}shutdown(){return h.disable(),super.shutdown()}}function Wf(r){const t={};for(const e in r)t[e]=r[e];return t}class Ff extends kf{constructor(){super(...arguments);te(this,"logAttributesCallback");te(this,"traceAttributesCallback")}record(e,n,...o){return super.record(e,n,...o)}registerLogAttributesCallback(e){this.logAttributesCallback=e}registerTraceAttributesCallback(e){this.traceAttributesCallback=e}log(e,n,o){var s;const i=this.getLoggerProvider();return i?i.getLogger("client-logger","0.0.1").emit({severityText:e,body:n,attributes:{...o,level:e,...((s=this.logAttributesCallback)==null?void 0:s.call(this))??{}}}):void 0}startSpan(e,n){var u,s;const o=(u=this.getTracerProvider())==null?void 0:u.getTracer("web","1.0.0");if(!o)return;const i=o.startSpan(e,n);return i.setAttributes(((s=this.traceAttributesCallback)==null?void 0:s.call(this))??{}),i}}let yi;yi="production";const Vf=Si(async({ensure:r,ensureSync:t})=>{const{browser:e,router:n,serverData:o}=await r(["browser","router","serverData"]),i=new Ff({serviceName:"web",env:yi,enableDefaultLogger:!0,enableDefaultTracer:!0,autoInstrumentations:[],samplingRatio:1,metrics:bi,onRecord(s,c,a){var l;return[c,{browser_name:e.name,browser_connection_type:(l=navigator.connection)==null?void 0:l.effectiveType,mobile:e.isMobile,native_app:e.isNativeApp,page:cr(n.state.location.pathname),section:sr(n.state.location.pathname),deploy_stage:o.deployStage,...a}]}});function u(){var d,_;const s=n.getRouteId(),c=n.getRouteInfo(),a={"environment.stage":o.deployStage,"environment.release":(d=o.bugsnag)==null?void 0:d.appVersion,"url.host":window.location.hostname,"url.path":window.location.pathname,"url.search":window.location.search,"url.hash":window.location.hash,"route.route_id":s,"route.manifest_route_id":c.manifestRouteId,"route.path_pattern":c.pathPattern,"route.slice_name":c.sliceName,"route.__deprecated__.page":cr(n.state.location.pathname),"route.__deprecated__.section":sr(n.state.location.pathname),"browser.useragent":e.userAgent,"browser.name":e.name,"browser.version":e.version,"browser.connection_type":(_=navigator.connection)==null?void 0:_.effectiveType,"browser.mobile":e.isMobile,"browser.native_app":e.isNativeApp,"user.uuid":wi()};let l,f;try{const p=t(["shop","flags"]);l=p.shop,f=p.flags}catch{return a}return{...a,flags:f.enabled.join(","),"shop.id":l.shopId,"shop.domain":l.shopDomain,"user.is_shopify_employee":l.isShopifyEmployee}}return i.registerLogAttributesCallback(u),i.registerTraceAttributesCallback(u),i}),Kf=Object.freeze(Object.defineProperty({__proto__:null,default:Vf},Symbol.toStringTag,{value:"Module"}));export{kf as D,be as M,Yf as i,Kf as m,Wf as s};
//# sourceMappingURL=https://web-sourcemaps.shopify.io/v1/en/context-slice-metrics-dyxi7iJePk2a.js.map
