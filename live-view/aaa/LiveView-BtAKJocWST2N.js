const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["Globe-6NZnt_5f_Jwm.js","router-D2A3v33YTGz9.js","common-BQgXWrz2O5Bt.js","render-common-CBDTO_er9s96.js","context-slice-graphql-B0DOwuSsR7A9.js","context-slice-metrics-dyxi7iJePk2a.js","assets/render-common-CCZBw7ZsekEq.css","useTranslateCountryName-0ZtP4OlhiMZx.js","range-CcLKX20GV7HR.js","extent-DJTi1Ll1A6EW.js","linear-CXDBUpXMebsN.js","string-rljVTuBHpzxT.js","Controls-yFxEvP7O_vjV.js","assets/Controls-9c75Kij31WJz.css","index.umd-gVYuEkYaCFL2.js","ShopLocationQuery-nKu8oi_q0thD.js","AdminPolarisVizProvider-CAy08mVsgpzb.js","PolarisVizProvider-DgM3nCcwdhFE.js","react-spring-web.esm-BOY3iVmaUFuM.js","react-spring-animated.esm-BsTr4d3RJ02a.js","PolarisVizContext-DMg2GlMLMFOp.js","usePageProps-DnNRMGaGPlq5.js","assets/usePageProps-BLNbsauhnx2z.css","use-element-size-B-ZiVkQbPEru.js","clamp-DpsXwMULzJoR.js","ViewReportButton-BpGxwIk2DslN.js","ChartContainer-XfUOX9D3-me7.js","estimateStringWidthWithOffset-BtLey8F0hhhu.js","ResizeObserver-D_CoWKkzIdYR.js","useUniqueId-DgOphXTvxuqE.js","useFormatChartNumber-h9kncrxRN9cU.js","SimpleBarChart-CwouO5YiErT6.js","getAxisOptions-ZBfQL9C9uyF_.js","array-Bfc_6sabVbOq.js","TrendIndicator-ForsXhGLj1mL.js","HorizontalGroup-DLTyJ-8-GaQs.js","uniqueId-CCVbRzRzP8__.js","assets/Globe-xhhAf09Bc3q4.css","Map-Ar-O8PpawOTh.js","icon-layer-CjzxTIuy4B-y.js","assets/Map-0vsoad8gf-us.css"])))=>i.map(i=>d[i]);
import{W as u,X as t,x as re,ad as oe,a1 as st,ao as rt,cy as jt}from"./router-D2A3v33YTGz9.js";import{b6 as f,bc as O,bv as de,db as ot,gj as It,ds as wt,cl as Ot,aJ as Dt,dE as at,dP as Ie,aW as ae,ed as it,ag as Lt,gW as Pe,_ as lt,b5 as Rt,dY as $e,fj as Nt}from"./common-BQgXWrz2O5Bt.js";import{i as At}from"./index.umd-gVYuEkYaCFL2.js";import{T as L,Q as w,an as Mt,Z as te,cx as Pt,af as $t,ac as we,bJ as M,ae as ct,bk as Oe,a0 as Ft,e as Ht,eg as ut,a as Vt,u as Z,n as dt,ef as ft,i as Fe,bN as Bt,o as mt,bV as Gt,aQ as He,aH as Wt,v as qt,O as Ut,s as zt,W as Yt,dY as Qt,ai as Zt}from"./render-common-CBDTO_er9s96.js";import{S as Xt,G as Kt,M as Jt,a as en,A as tn}from"./ShopLocationQuery-nKu8oi_q0thD.js";import{A as nn}from"./AdminPolarisVizProvider-CAy08mVsgpzb.js";import{u as sn}from"./usePageProps-DnNRMGaGPlq5.js";import{u as fe}from"./use-element-size-B-ZiVkQbPEru.js";import{u as pt,c as De,a as ne,b as _e}from"./react-spring-web.esm-BOY3iVmaUFuM.js";import{c as Ve}from"./clamp-DpsXwMULzJoR.js";import{a as ke}from"./linear-CXDBUpXMebsN.js";import{e as ht}from"./extent-DJTi1Ll1A6EW.js";import{V as ie}from"./ViewReportButton-BpGxwIk2DslN.js";import{q as Be}from"./ChartContainer-XfUOX9D3-me7.js";import{b as rn}from"./string-rljVTuBHpzxT.js";import{u as _t}from"./useFormatChartNumber-h9kncrxRN9cU.js";import{S as yt}from"./SimpleBarChart-CwouO5YiErT6.js";import{u as on}from"./uniqueId-CCVbRzRzP8__.js";const an="LiveViewContext should not be used directly; please use LiveViewContextProvider and useLiveViewContext",gt=f.createContext({getTime(){throw new Error(an)}});function ln({children:e}){var n=u(1);try{var s=u(1);try{const[r,a]=f.useState({date:new Date,timestamp:new Date().getTime()}),o=f.useRef(0),i=f.useCallback(()=>{l();function l(){o.current=window.setInterval(()=>{c()},1e3)}function c(){const m=new Date;a({date:m,timestamp:m.getTime()})}},[]);return f.useEffect(()=>(clearInterval(o.current),i(),()=>{clearInterval(o.current)}),[i]),t.jsx(gt.Provider,{value:{getTime:()=>r},children:e})}finally{s.f()}}finally{n.f()}}function cn(){return f.useContext(gt)}const un=f.createContext({map:null,setMap:()=>{}}),dn=({children:e})=>{var n=u(1);try{var s=u(1);try{const[r,a]=f.useState(null);return t.jsx(un.Provider,{value:{map:r,setMap:a},children:e})}finally{s.f()}}finally{n.f()}},fn=e=>+e,mn=5*60*1e3,pn=11*1e3,P=2e4,hn=1024,_n={duration:P*.7,easing:fn},yn="insights_live_view_click/2.0",gn="insights_live_view_hover/1.0",vn="insights_live_view_location_selection/2.0",bn="insights_live_view_page_view/1.0";var A=function(e){return e.EnterFullScreen="enter_full_screen",e.ExitFullScreen="exit_full_screen",e.EnableStreamerMode="enable_streamer_mode",e.DisableStreamerMode="disable_streamer_mode",e.EnableMap="enable_map",e.EnableGlobe="enable_globe",e.InteractWithGlobe="interact_with_globe",e.InteractWithFlatMap="interact_with_map",e.ShopPin="shop_pin",e.OrderDot="order_dot",e.MapView="google_map_view",e.GlobeView="globe_view",e.ShowMetrics="show_metrics",e.HideMetrics="hide_metrics",e.ZoomIn="zoom_in",e.ZoomOut="zoom_out",e.TotalSales="total_sales",e.TotalSessions="total_sessions",e.TotalOrders="total_orders",e.TopLocations="top_locations",e.TopProducts="top_products",e.DebugMenu="debug_menu",e.CountryTooltip="country_tooltip",e.Live="live",e.Customers="customers",e}({});const Yo=500,Qo={TIME_TO_LIVE:mn},Zo={TIME_TO_LIVE:pn},Xo=12,Ko=3;var Jo=function(e){return e[e.Shop=0]="Shop",e[e.Order=1]="Order",e[e.Country=2]="Country",e}({});const xn={yAxis:{labelColor:"var(--p-color-text)"},xAxis:{labelColor:"var(--p-color-text-secondary)"},chartContainer:{minHeight:0,backgroundColor:"transparent"}},Cn={Light:xn};var W=function(e){return e[e.Globe=0]="Globe",e[e.Flat=1]="Flat",e}({});const Sn={dateTime:"{date} at {time}"},kn={Clock:Sn},En={[Symbol.for("i18n-id")]:"Clock_gmfuls",en:kn};function Tn({streamerMode:e}){var n=u(1);try{var s=u(1);try{const[r]=O(En),{ianaTimezone:a}=re(),{getTime:o}=cn(),{date:i}=o();if(i==null)return null;const l=r.translate("Clock.dateTime",{date:r.formatDate(i,{style:de.Short,timeZone:a}),time:r.formatDate(i,{style:de.Time,timeZone:a,timeZoneName:"short"})});return t.jsxs(t.Fragment,{children:[t.jsx("span",{suppressHydrationWarning:!0,children:t.jsx(L,{variant:"bodySm",as:"span",tone:"subdued",children:l})}),e?t.jsx(w,{position:"relative",paddingInlineStart:"200",children:t.jsx(Mt,{tone:"neutral",color:"subdued",type:"hide"})}):null]})}finally{s.f()}}finally{n.f()}}const jn="Live View. This page is ready",In={pageReadyAccessibilityLabel:jn},wn={[Symbol.for("i18n-id")]:"Page_wk6tr8",en:In},On="_Page_5s36q_3",Dn="_Page_Header_5s36q_20",Ge={Page:On,Page_Header:Dn};function Ln({title:e,titleHidden:n,children:s,streamerMode:r}){var a=u(1);try{var o=u(1);try{const[i]=O(wn),l=sn({title:e,children:s});return t.jsxs("main",{className:Ge.Page,children:[t.jsx("div",{className:Ge.Page_Header,children:t.jsxs(te,{blockAlign:"center",wrap:!1,children:[!n&&t.jsx(w,{paddingInlineEnd:"400",children:t.jsx(L,{variant:"headingLg",as:"h1",breakWord:!0,children:e})}),t.jsx("div",{role:"status",children:t.jsx(L,{visuallyHidden:!0,as:"p",children:i.translate("pageReadyAccessibilityLabel")})}),t.jsx(Tn,{streamerMode:r})]})}),l.children]})}finally{o.f()}}finally{a.f()}}const Rn={visitor:"Visitors right now",order:"Orders"},Nn={GlobeLegend:Rn},An={[Symbol.for("i18n-id")]:"Legend_vk3svq",en:Nn};function Mn({mapMode:e}){var n=u(1);try{var s=u(1);try{const[r]=O(An);return t.jsxs(te,{gap:"500",children:[t.jsxs(te,{blockAlign:"center",children:[t.jsx(Xt,{}),t.jsx(We,{children:r.translate("GlobeLegend.order")})]}),t.jsxs(te,{blockAlign:"center",children:[e===W.Globe?t.jsx("img",{src:Kt,alt:""}):t.jsx("img",{src:Jt,alt:""}),t.jsx(We,{children:r.translate("GlobeLegend.visitor")})]})]})}finally{s.f()}}finally{n.f()}}function We({children:e}){var n=u(1);try{return t.jsx(w,{paddingInlineStart:"100",color:"text",children:t.jsx(L,{variant:"headingSm",as:"span",fontWeight:"regular",children:e})})}finally{n.f()}}function H({query:e,pollInterval:n,skip:s=!1}){return Pt(e,{skip:s,pollInterval:n,dataOnly:!0,source:"shopify-live-view"})}const q={visitorsRightNow:{query:`
      SHOW total_active_sessions
      FROM pageviews
      SINCE -300s
      UNTIL -2s
    `},totalSessions:{query:`
      SHOW total_sessions
      OVER hour
      FROM visits
      SINCE today
      UNTIL today
      ORDER BY hour ASC
    `},totalOrders:{query:`
      SHOW total_orders
      OVER hour
      FROM sales
      SINCE today
      UNTIL 0h
      ORDER BY hour ASC
    `},totalSales:{query:`
      SHOW total_sales
      OVER hour
      FROM sales
      SINCE today
      UNTIL 0h
      ORDER BY hour ASC
    `},customers:{query:`
      SHOW customers
      BY customer_type
      FROM sales
      WHERE customer_type != ""
      SINCE today UNTIL today
      ORDER BY customer_type
    `},customerBehavior:{query:`
      SHOW total_carts, total_checkouts, total_orders
      FROM pageviews
      SINCE -10min
    `},topProducts:{query:`
      SHOW total_sales
      BY variant_id, product_title, variant_title, product_id
      FROM sales
      WHERE sale_line_type == 'product'
      SINCE today UNTIL today
      ORDER BY total_sales DESC, variant_title ASC, product_title ASC
      LIMIT 3
    `},topLocations:{query:`
      SHOW total_sessions
      BY location_country, location_city
      FROM visits
      WHERE location_city != ""
      AND location_country != ""
      SINCE today UNTIL today
      ORDER BY total_sessions DESC, location_country ASC, location_city ASC
      LIMIT 3
    `}};function Pn(){const e=H({query:q.visitorsRightNow.query,pollInterval:P}),n=H({query:q.totalSessions.query,pollInterval:P}),s=H({query:q.totalOrders.query,pollInterval:P}),r=H({query:q.totalSales.query,pollInterval:P}),a=H({query:q.customers.query,pollInterval:P}),o=H({query:q.customerBehavior.query,pollInterval:P}),i=H({query:q.topLocations.query,pollInterval:P}),l=H({query:q.topProducts.query,pollInterval:P}),c={visitorsRightNow:e,totalSessions:n,totalOrders:s,totalSales:r,customerBehavior:o,topLocations:i,topProducts:l,customers:a},m=Object.values(c).find(d=>d!=null&&d.hasError),p=Object.values(c).find(d=>d!=null&&d.response!=null);return{...c,hasErrors:m,hasData:p}}const $n="_MetricCard_106et_3",Fn="_obfuscated_106et_11",Hn="_tall_106et_18",Vn="_compact_106et_22",Bn="_autoHeight_106et_26",le={MetricCard:$n,obfuscated:Fn,tall:Hn,compact:Vn,autoHeight:Bn};function U({autoHeight:e=!1,children:n,compact:s=!1,heading:r,streamerMode:a=!1,reportLink:o,headingSize:i="bodySm"}){var l=u(1);try{var c=u(1);try{return t.jsx($t,{roundedAbove:"xs",padding:"0",children:t.jsx("div",{className:M(le.MetricCard,e&&le.autoHeight,s&&le.compact,a&&le.obfuscated),children:t.jsx(w,{paddingBlockStart:s?"0":"100",paddingBlockEnd:s?"0":"200",paddingInlineStart:"200",paddingInlineEnd:"200",minHeight:"100%",children:t.jsxs(we,{gap:"100",children:[t.jsx(L,{variant:i,as:"h2",truncate:!0,children:r}),o&&t.jsx(w,{position:"absolute",insetBlockStart:"200",insetInlineEnd:"200",children:o}),n]})})})})}finally{c.f()}}finally{l.f()}}function Le(){const[e,n]=f.useState(ot?!1:window.matchMedia("(prefers-reduced-motion: reduce)").matches);return f.useEffect(()=>{n(window.matchMedia("(prefers-reduced-motion: reduce)").matches)},[]),e}const Gn="_AnimatedNumber_1ignp_1",Wn="_WidthReference_1ignp_6",qe={AnimatedNumber:Gn,WidthReference:Wn},Ue="M";function Re({value:e,formatNumber:n,config:s=De.default,className:r}){var a=u(1);try{var o=u(1);try{const i=f.useRef(null),[l,c]=f.useState({previousCount:null,currentCount:null,widthReference:`${n(e)}${Ue}`}),m=Le();It(e,(d,y)=>{if(y===null)return c({...l,previousCount:d,currentCount:d});if(`${d}`.length>`${y}`.length)return c({widthReference:`${n(d)}${Ue}`,previousCount:y,currentCount:d});c({...l,previousCount:y,currentCount:d})});const p=pt({from:{value:l.previousCount==null?e+.001:l.previousCount},to:{value:l.currentCount==null?e:l.currentCount},config:s,default:{immediate:m}});return t.jsxs(t.Fragment,{children:[t.jsx(ne.span,{ref:i,className:M(qe.AnimatedNumber,r!=null&&r),children:p.value.to(d=>n(d))}),t.jsx("span",{"aria-hidden":!0,className:qe.WidthReference,children:l.widthReference})]})}finally{o.f()}}finally{a.f()}}const Ne="255,255,255",qn="143, 113, 239",Un="60, 107, 251",zn="53, 180, 238",Ee=zn,Yn=Ne,ue=qn,Qn=Ne,Te=Un,Zn=Ne,Xn="#D6D9DD",Kn=20,Jn=200,es=10,Y=30,ts=1,ns=1,ss=5,ze=20,rs="_Obfuscated_17xjk_3",os="_Chart_17xjk_8",as="_Circle_17xjk_12",J={Obfuscated:rs,Chart:os,Circle:as},is="Customer behavior on your store",ls="Active carts",cs="Checking out",us="Purchased",ds={title:is,activeCarts:ls,checkingOut:cs,purchased:us},fs={[Symbol.for("i18n-id")]:"CustomerBehavior_cxbn33",en:ds},Ye=({quantity:e,fromCx:n,toCx:s,radius:r})=>Array(e).fill({fromCx:n,toCx:s,radius:r}),F=(e,n)=>`rgba(${e}, ${n})`,ms=(e,n)=>{switch(n){case"total_carts":return e.translate("activeCarts");case"total_checkouts":return e.translate("checkingOut");case"total_orders":return e.translate("purchased");default:return n}},ye={totalCarts:Ee,totalCheckouts:ue,totalOrders:Te},ps=({data:e,width:n,maxRunningDotsPerBucket:s=Kn,bigIncrementThreshold:r=Jn,isLoading:a=!1,hasError:o=!1,streamerMode:i=!1})=>{var l=u(1);try{var c=u(1);try{const[m]=O(fs),p=wt(e),[d,y]=f.useState([]),[E,C]=f.useState([]),x=Le(),k=n/3,v=f.useMemo(()=>ke().domain([0,e.length-1]).range([0,n-k]),[e.length,n,k]),[S,_]=f.useMemo(()=>{const b=ht(e,G=>G.count),I=b[0]?b[0]:0,B=b[1]?b[1]:0;return[I,B]},[e]),h=f.useMemo(()=>ke().domain([S,_]).range([es,Y]),[_,S]),R=_e(e.length,e.map(b=>({radius:h(b.count),config:De.molasses,default:{immediate:x}})));f.useEffect(()=>{if(!p)return;const b=N=>N>r?ss:ns,I=e.find(N=>N.label==="total_checkouts"),B=e.find(N=>N.label==="total_orders"),G=p.find(N=>N.label==="total_checkouts"),z=p.find(N=>N.label==="total_orders");if(I!=null&&G!=null&&I.count>G.count){const N=I.count-G.count,pe=b(N),he=Ve(N,1,s);y(Ye({quantity:he,fromCx:v(0),toCx:v(1),radius:pe}))}if(B!=null&&z!=null&&B.count>z.count){const N=B.count-z.count,pe=b(N),he=Ve(N,1,s);C(Ye({quantity:he,fromCx:v(1),toCx:v(2),radius:pe}))}},[e,p,v,s,r]);const T=()=>y([]),D=()=>C([]),g=_e(d.length,d.map((b,I)=>({reset:!0,delay:I*ze,default:{immediate:x},from:{cx:b.fromCx,fill:F(Ee,1),radius:b.radius},to:{cx:b.toCx,fill:F(ue,1),radius:b.radius},onRest:T}))),j=_e(E.length,E.map((b,I)=>({reset:!0,delay:I*ze,default:{immediate:x},from:{cx:b.fromCx,fill:F(ue,1),radius:b.radius},to:{cx:b.toCx,fill:F(Te,1),radius:b.radius},onRest:D}))),$=f.useCallback(b=>m.formatNumber(b,{precision:0}),[m]);return t.jsxs(t.Fragment,{children:[t.jsxs("svg",{className:J.Chart,viewBox:`${-(k/2)} 0 ${n} ${Y*2}`,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",children:[t.jsxs("defs",{children:[t.jsxs("radialGradient",{id:"totalCartsGradient",children:[t.jsx("stop",{offset:"0%",stopColor:F(Yn,.1)}),t.jsx("stop",{offset:"100%",stopColor:F(Ee,1)})]}),t.jsxs("radialGradient",{id:"totalCheckoutsGradient",children:[t.jsx("stop",{offset:"0%",stopColor:F(Qn,.1)}),t.jsx("stop",{offset:"100%",stopColor:F(ue,1)})]}),t.jsxs("radialGradient",{id:"totalOrdersGradient",children:[t.jsx("stop",{offset:"0%",stopColor:F(Zn,.1)}),t.jsx("stop",{offset:"100%",stopColor:F(Te,1)})]})]}),t.jsx("rect",{x:-.5,y:Y,width:v(e.length-1),height:.5,fill:Xn}),e.map((b,I)=>t.jsxs("g",{children:[t.jsx(ne.circle,{className:J.Circle,cx:v(I),cy:Y,r:R[I].radius,fill:`url(#${Object.keys(ye)[I]}Gradient)`}),t.jsx("circle",{cx:v(I),cy:Y,r:ts,fill:F(ye[Object.keys(ye)[I]],1)})]},b.label)),t.jsxs("g",{children:[g.map(({cx:b,fill:I,radius:B},G)=>t.jsx(ne.circle,{className:J.Circle,style:{transform:b.to(z=>`translate3d(${z}px, 0, 0)`)},fill:I,cy:Y,r:B},`checkouts-${G}`)),j.map(({cx:b,fill:I,radius:B},G)=>t.jsx(ne.circle,{className:J.Circle,style:{transform:b.to(z=>`translate3d(${z}px, 0, 0)`)},fill:I,cy:Y,r:B},`orders-${G}`))]})]}),t.jsx(w,{paddingBlockStart:"200",children:t.jsx(ct,{columns:3,children:e.map(b=>t.jsxs(w,{children:[t.jsx(te,{gap:"200",align:"space-evenly","aria-labelledby":b.label,children:t.jsx(L,{variant:"headingLg",as:"span",alignment:"center",children:a||o?t.jsx(Oe,{size:"small"}):t.jsx("div",{className:M(i&&J.Obfuscated),children:t.jsx(Re,{value:b.count,formatNumber:$})})})}),t.jsx(w,{id:b.label,paddingBlockStart:"100",children:t.jsx(L,{variant:"bodySm",as:"span",alignment:"center",children:ms(m,b.label)})})]},b.label))})})]})}finally{c.f()}}finally{l.f()}},hs=[{label:"total_carts",count:0},{label:"total_checkouts",count:0},{label:"total_orders",count:0}],_s="Customer behavior",ys="Sessions within the last 10 minutes that had items in the shopping cart, reached the checkout, or completed a purchase.",gs="10 min",vs={title:_s,definition:ys,timeBadge:gs},bs={[Symbol.for("i18n-id")]:"CustomerBehaviorMetric_14vbhbv",en:vs},xs=({result:e})=>{const[n]=e.data;return e.columns.map((s,r)=>({label:s.field,count:n[r]}))},Cs=({data:e,width:n,height:s,streamerMode:r})=>{var a=u(1);try{var o=u(1);try{const[i]=O(bs),[l,c]=f.useState(hs),m=!e.isLoading&&e.response==null;return f.useEffect(()=>{e.response&&c(xs(e.response))},[e.response]),t.jsxs(U,{autoHeight:!0,heading:i.translate("title"),headingSize:"bodyMd",children:[t.jsx(w,{position:"absolute",insetBlockStart:"300",insetInlineEnd:"300",children:t.jsx(Ft,{size:"small",children:i.translate("timeBadge")})}),t.jsx(we,{children:n==null||s==null?null:t.jsx(ps,{width:n,height:s,data:l,isLoading:m,hasError:e.hasError,streamerMode:r})})]})}finally{o.f()}}finally{a.f()}},vt="143, 113, 239",Ss="46, 185, 245",Qe=200,ea=500,ks=240,ta=300,na=100,Es="#079EE1",Ts="#6A42E9",js="_Container_pv9yg_1",Is={Container:js};function ws({x:e,y:n,show:s,id:r,children:a,position:o="absolute",placeAboveCursor:i=!1,disableTransition:l=!1}){var c=u(1);try{var m=u(1);try{const p=f.useRef(null),d=fe(p),y=Le(),E=f.useMemo(()=>{if(!d)return e;const{innerWidth:v}=window,{width:S}=d;return e+S<=v?e:v-S},[d,e]),C=f.useMemo(()=>{if(!d)return n;const{height:v}=d,S=n-v;return S<0?n:S},[d,n]),x=pt({config:{duration:Qe},opacity:s?1:0,default:{immediate:y}}),k={position:o,transition:i||l?"null":`transform ${Qe}ms ease`,transform:`translate3d(${E}px, ${i?C:n}px, 0)`,display:s?"block":"none"};return t.jsx(ne.div,{style:{...x,...k},ref:p,id:r,className:Is.Container,children:a})}finally{m.f()}}finally{c.f()}}function Os({title:e,timestamp:n}){var s=u(1);try{var r=u(1);try{const[a]=O(),o=60*60*1e3,i=a.formatDate(n,{style:de.Time}).toLowerCase(),l=new Date(n.valueOf()+o),c=a.formatDate(l,{style:de.Time}).toLowerCase();return t.jsxs(Ht,{alignment:"center",vertical:!0,spacing:"extraTight",children:[t.jsx(L,{as:"p",children:e}),t.jsxs(L,{variant:"bodyMd",as:"span",tone:"subdued",children:[i," - ",c]})]})}finally{r.f()}}finally{s.f()}}const Ds="_Cell_p5k91_6",Ls="_isActive_p5k91_27",ge={Cell:Ds,isActive:Ls};function Rs({index:e,backgroundColor:n,width:s,height:r,isLast:a,isActive:o,tooltipId:i,onMouseEnter:l,onFocus:c,onBlur:m}){var p=u(1);try{var d=u(1);try{const y=M(ge.Cell,o&&ge.isActive,a&&ge.isLast),E=f.useCallback(x=>{l(x,e)},[e,l]),C=f.useCallback(()=>{c(e)},[e,c]);return t.jsx("div",{tabIndex:0,onMouseEnter:E,onFocus:C,onBlur:m,style:{height:r,width:s,backgroundColor:n},className:y,"aria-labelledby":i})}finally{d.f()}}finally{p.f()}}const Ns=24,As=106,Ms="var(--p-color-bg-surface-secondary)";var se=function(e){return e[e.ResetActiveDataPoint=0]="ResetActiveDataPoint",e[e.Update=1]="Update",e}({});const Ps="_HeatMap_1b0ln_1",$s="_HidePointerEvents_1b0ln_15",Ze={HeatMap:Ps,HidePointerEvents:$s},Fs=(e,n)=>{switch(n.type){case se.ResetActiveDataPoint:return{...e,activeDataPoint:null};case se.Update:return{...e,...n.payload};default:return e}},Hs="rgba(227,227,227,1)",Vs=16,Xe=7;function Bs({color:e,data:n,width:s,maxLength:r=Ns,streamerMode:a=!1}){var o=u(1);try{var i=u(1);try{const l=f.useRef(null),c=fe(l),m=s/r;n.length>r&&n.splice(r);const p=f.useCallback(({x:g,y:j})=>c==null?{x:0,y:0}:{x:Be({amount:g-ks-(c==null?void 0:c.width)/2,min:Vs,max:window.innerWidth}),y:j-Xe-As},[c]),d={activeDataPoint:null,tooltipPosition:p({x:1,y:0})},[y,E]=f.useReducer(Fs,d),C=()=>{E({type:se.ResetActiveDataPoint})},[x,k]=f.useMemo(()=>{const g=ht(n,({rawValue:b})=>Number(b)),j=g[0]?g[0]:0,$=g[1]?g[1]:1;return[j,$]},[n]),v=f.useMemo(()=>ke().range([Hs,`rgb(${e})`]).domain([x,k]).interpolate(rn),[e,x,k]),S=f.useCallback(g=>{c!=null&&E({type:se.Update,payload:{activeDataPoint:g,tooltipPosition:p({x:c.left+g*m,y:c.top})}})},[p,c,m]),_=f.useCallback((g,j)=>{c!=null&&E({type:se.Update,payload:{activeDataPoint:j,tooltipPosition:p({x:g.pageX,y:c.top})}})},[p,c]),h=f.useMemo(()=>{const g=Ot(n,`[${y.activeDataPoint}]`,null);if(!g)return null;const j=typeof g.time=="string"?Dt(g.time):g.time;return j?t.jsx(Os,{timestamp:j,title:g.tooltipTitle}):null},[y.activeDataPoint,n]),T=`tooltip-${at(()=>Ie()).current}`,D=Be({amount:m,min:0,max:Xe});return t.jsxs("div",{ref:l,className:M(a&&Ze.HidePointerEvents,Ze.HeatMap),style:{height:D},onMouseLeave:C,children:[t.jsx(ut,{event:"scroll",handler:C}),n.map((g,j)=>{const $=y.activeDataPoint===j,b=j+1===r;return t.jsx(Rs,{backgroundColor:v(g.rawValue),onMouseEnter:_,index:j,onFocus:S,onBlur:C,isActive:$,height:D,width:m,isLast:b,tooltipId:T},`${g.time}-${g.rawValue}`)}),t.jsx("span",{onMouseEnter:C,style:{width:m*(r-n.length),background:Ms}}),t.jsx(ws,{id:T,x:y.tooltipPosition.x,y:y.tooltipPosition.y,show:!!h,position:"fixed",children:h})]})}finally{i.f()}}finally{o.f()}}const Gs="_Wrapper_is0dk_3",Ws="_Obfuscated_is0dk_8",qs="_SmallerText_is0dk_13",Ke={Wrapper:Gs,Obfuscated:Ws,SmallerText:qs},Us=8;function Ae({color:e,total:n,formatNumber:s,formattedData:r,hoursInDay:a,streamerMode:o=!1,config:i=De.default}){var l=u(1);try{var c=u(1);try{const m=f.useRef(null),p=fe(m),d=p==null?void 0:p.width,y=n==null;return t.jsxs("div",{ref:m,className:Ke.Wrapper,children:[y?t.jsx(Oe,{size:"small"}):t.jsx("div",{className:M(o&&Ke.Obfuscated),children:t.jsx(L,{variant:"headingMd",as:"span",children:t.jsx(Re,{value:n,formatNumber:s,config:i,width:d})})}),y||d==null?null:t.jsx(Bs,{color:e,data:r,width:d,height:Us,maxLength:a,streamerMode:o})]})}finally{c.f()}}finally{l.f()}}const zs=-6,ve=-5,ce=-2,Ys=60;function Me({startingDate:e,endingDate:n}){const s=n.slice(zs,ve)==="-"?-1:1,r=parseInt(e.slice(ce),10),a=parseInt(e.slice(ve,ce),10),o=(r+a*60)*s,i=parseInt(n.slice(ce),10),l=parseInt(n.slice(ve,ce),10),c=(i+l*Ys)*s;return c<o?25:c>o?23:24}function X(){const{produce:e}=Vt(),n=f.useRef(Ie()),s=f.useCallback(i=>{e({payload:{...i,liveViewViewId:n.current},schemaId:gn})},[e]),r=f.useCallback(i=>{e({payload:{...i,liveViewViewId:n.current},schemaId:yn})},[e]),a=f.useCallback(i=>{e({payload:{...i,liveViewViewId:n.current},schemaId:vn})},[e]),o=f.useCallback(i=>{e({payload:{...i,liveViewViewId:n.current},schemaId:bn})},[e]);return{produceClickEvent:r,produceHoverElementEvent:s,produceLocationSelectionEvent:a,producePageViewEvent:o}}const Qs={title:"Total sales",linkAriaLabel:"View total sales report",tooltip:"{count} sales"},Zs={TotalSales:Qs},Xs={[Symbol.for("i18n-id")]:"TotalSales_zyve65",en:Zs};function be(e){return!(e.isLoading&&e.response==null||e.hasError||e.response==null)}function Ks({totalSales:e,viewState:n,streamerMode:s}){var r=u(1);try{var a=u(1);try{const[o]=O(Xs),i=Z(),l=oe(),{hasReports:c}=re(),m=be(e)?e.response.result.data.map(([_,h])=>({time:new Date(_),rawValue:h,tooltipTitle:o.translate("TotalSales.tooltip",{count:o.formatCurrency(h,{form:"short"})})})):[],p=be(e)?Me({startingDate:e.response.result.data[0][0],endingDate:e.response.result.data[e.response.result.data.length-1][0]}):24,d=be(e)?e.response.result.data.reduce((_,[,h])=>_+h,0):null,y=_=>o.formatCurrency(_,{form:"short"}),C=l.include(ae.Reports)&&c&&!s,{produceClickEvent:x}=X(),k=f.useCallback(()=>{x({viewState:n,buttonHandle:A.TotalSales})},[x,n]),v=o.translate("TotalSales.title"),S={url:i.reportShow("sales_over_time",{since:"today",until:"today",over:"hour"}),reportTitle:v,external:!0};return t.jsx(U,{reportLink:C?t.jsx(ie,{...S,onClick:k}):void 0,compact:!0,heading:v,children:t.jsx(Ae,{color:vt,total:d,formatNumber:y,formattedData:m,hoursInDay:p,streamerMode:s})})}finally{a.f()}}finally{r.f()}}const Js={title:"Total sessions",linkAriaLabel:"View total sessions report",tooltip:{one:"{count} session",other:"{count} sessions"}},er={TotalSessions:Js},tr={[Symbol.for("i18n-id")]:"TotalSessions_1c16vrs",en:er};function xe(e){return!(e.isLoading&&e.response==null||e.hasError||e.response==null)}function nr(e){const{data:n}=e.response.result,s=Date.now();return n.map(([a,o])=>[new Date(a).valueOf(),o]).filter(([a])=>a<=s)}function sr({totalSessions:e,viewState:n,streamerMode:s=!1}){var r=u(1);try{var a=u(1);try{const[o]=O(tr),i=oe(),l=Z(),[c]=st(it),m=xe(e)?nr(e).map(([_,h])=>({time:new Date(_),rawValue:h,tooltipTitle:o.translate("TotalSessions.tooltip",{count:h})})):[],p=xe(e)?Me({startingDate:e.response.result.data[0][0],endingDate:e.response.result.data[e.response.result.data.length-1][0]}):24,d=xe(e)?e.response.result.data.reduce((_,[,h])=>_+h,0):null,y=_=>o.formatNumber(Math.round(_)),E=i.include(ae.Reports),{produceClickEvent:C}=X(),x=f.useCallback(()=>{C({viewState:n,buttonHandle:A.TotalSessions})},[C,n]),k=o.translate("TotalSessions.title"),v={url:l.reportShow("sessions_over_time",{since:"today",until:"today",over:"hour"}),reportTitle:k,external:!0},S=!c&&E&&!s;return t.jsx(U,{compact:!0,reportLink:S?t.jsx(ie,{...v,onClick:x}):null,heading:k,children:t.jsx(Ae,{color:Ss,total:d,formatNumber:y,formattedData:m,hoursInDay:p,streamerMode:s})})}finally{a.f()}}finally{r.f()}}const rr={title:"Total orders",linkAriaLabel:"View total orders report",tooltip:{one:"{count} order",other:"{count} orders"}},or={TotalOrders:rr},ar={[Symbol.for("i18n-id")]:"TotalOrders_qy8eko",en:or};function Ce(e){return!(e.isLoading&&e.response==null||e.hasError||e.response==null)}function ir({totalOrders:e,viewState:n,streamerMode:s=!1}){var r=u(1);try{var a=u(1);try{const[o]=O(ar),i=Z(),l=oe(),{hasReports:c}=re(),m=Ce(e)?e.response.result.data.map(([_,h])=>({time:new Date(_),rawValue:h,tooltipTitle:o.translate("TotalOrders.tooltip",{count:h})})):[],p=Ce(e)?Me({startingDate:e.response.result.data[0][0],endingDate:e.response.result.data[e.response.result.data.length-1][0]}):24,d=Ce(e)?e.response.result.data.reduce((_,[,h])=>_+h,0):null,y=_=>o.formatNumber(Math.round(_)),C=l.include(ae.Reports)&&c&&!s,{produceClickEvent:x}=X(),k=f.useCallback(()=>{x({viewState:n,buttonHandle:A.TotalOrders})},[x,n]),v=o.translate("TotalOrders.title"),S={url:i.reportShow("orders_over_time",{since:"today",until:"today",over:"hour"}),reportTitle:v,external:!0};return t.jsx(U,{compact:!0,reportLink:C&&t.jsx(ie,{...S,onClick:k}),heading:o.translate("TotalOrders.title"),children:t.jsx(w,{as:"div",children:t.jsx(Ae,{color:vt,total:d,formatNumber:y,formattedData:m,hoursInDay:p,streamerMode:s})})})}finally{a.f()}}finally{r.f()}}const lr="_Obfuscated_13lyc_3",Je={Obfuscated:lr},cr={title:"Visitors right now",definition:"Number of sessions that were active within the last five minutes."},ur={VisitorsRightNow:cr},dr={[Symbol.for("i18n-id")]:"VisitorsRightNow_21r1dq",en:ur};function fr({data:e,streamerMode:n=!1}){var s=u(1);try{var r=u(1);try{const[a]=O(dr),o=f.useCallback(c=>a.formatNumber(c,{precision:0}),[a]),i=f.useMemo(()=>{var m,p,d;const c=(d=(p=(m=e==null?void 0:e.response)==null?void 0:m.result)==null?void 0:p.data)==null?void 0:d[0];return c?c[0]==null?0:c[0]:0},[e]),l=(e==null?void 0:e.isLoading)&&(e==null?void 0:e.response)==null||(e==null?void 0:e.hasError)||i===null;return t.jsx(U,{streamerMode:n,compact:!0,heading:a.translate("VisitorsRightNow.title"),children:l?t.jsx(Oe,{size:"small"}):t.jsx("div",{className:M(n&&Je.Obfuscated),children:t.jsx(L,{variant:"headingMd",as:"h2",children:t.jsx(Re,{value:i,formatNumber:o,config:_n,className:Je.Number})})})})}finally{r.f()}}finally{s.f()}}const mr="_Bar_q4jvd_4",pr="_BarSmall_q4jvd_11",hr="_BarMedium_q4jvd_15",et={Bar:mr,BarSmall:pr,BarMedium:hr};var bt=function(e){return e.Small="BarSmall",e.Medium="BarMedium",e}({});function xt({lines:e,barHeight:n}){var s=u(1);try{var r=u(1);try{const a=[];for(let o=0;o<e;o++)a.push(t.jsx("div",{className:M(et.Bar,et[n])},`LoadingBar-${o}`));return t.jsx(w,{as:"div",paddingBlockStart:"200",children:t.jsx(we,{gap:"300",align:"space-evenly",children:a})})}finally{r.f()}}finally{s.f()}}const _r={1:29,2:74,3:121};function Ct({children:e,dataLength:n}){var s=u(1);try{var r=u(1);try{return t.jsx("div",{style:{height:_r[n]},children:e},`metric-card-length-${n}`)}finally{r.f()}}finally{s.f()}}const yr={title:"Top locations",emptyState:"No locations",location:"{city} • {country}",linkAriaLabel:"View top locations report",sessions:{one:"{formattedCount} session",other:"{formattedCount} sessions"}},gr={TopLocations:yr},St={[Symbol.for("i18n-id")]:"TopLocations_q89z4i",en:gr};function vr({series:e}){var n=u(1);try{var s=u(1);try{let r=function(i){const l=typeof i=="string"?parseInt(i,10):i,c=o({value:Number(l),type:"number",isCondensed:!0});return`${a.translate("TopLocations.sessions",{count:l,formattedCount:c})}`};const[a]=O(St),o=_t();return t.jsx(yt,{showLegend:!1,data:e,xAxisOptions:{labelFormatter:r}})}finally{s.f()}}finally{n.f()}}const br=({data:e,viewState:n,streamerMode:s})=>{var r=u(1);try{var a=u(1);try{let o=function({result:T}){const{data:D}=T;return[{name:"Top Locations",color:Es,data:D.map(([g,j,$])=>({key:i.translate("TopLocations.location",{city:j,country:g}),value:$}))}]};const[i]=O(St),l=Z(),c=oe(),{isLoading:m,hasError:p,response:d}=e,[y]=st(it),E={since:"today",until:"today","by%5B0%5D":"location_country","by%5B1%5D":"location_city"},C=c.include(ae.Reports),x=!y&&C&&!s,v={url:l.reportShow("sessions_by_location",E),reportTitle:i.translate("TopLocations.title"),external:!0},{produceClickEvent:S}=X(),_=f.useCallback(()=>{S({viewState:n,buttonHandle:A.TopLocations})},[S,n]),h=f.useMemo(()=>{if(m||p||d==null)return null;const[T]=o(d),D=T.data.every(({value:g})=>g===0);return T.data.length===0||D?t.jsx(L,{variant:"bodyMd",as:"span",children:i.translate("TopLocations.emptyState")}):t.jsx(Ct,{dataLength:T.data.length,children:t.jsx(vr,{series:[T]})})},[d]),R=f.useMemo(()=>m||p||d==null?t.jsx(xt,{lines:3,barHeight:bt.Small}):null,[d]);return t.jsxs(U,{reportLink:x?t.jsx(ie,{...v,onClick:_}):null,streamerMode:s,heading:i.translate("TopLocations.title"),headingSize:"bodyMd",children:[R,h]})}finally{a.f()}}finally{r.f()}},xr={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"TopProductsImageQuery"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"query"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"products"},arguments:[{kind:"Argument",name:{kind:"Name",value:"first"},value:{kind:"IntValue",value:"3"}},{kind:"Argument",name:{kind:"Name",value:"query"},value:{kind:"Variable",name:{kind:"Name",value:"query"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"edges"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"node"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"title"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"featuredImage"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",alias:{kind:"Name",value:"transformedSrc"},name:{kind:"Name",value:"url"},arguments:[{kind:"Argument",name:{kind:"Name",value:"transform"},value:{kind:"ObjectValue",fields:[{kind:"ObjectField",name:{kind:"Name",value:"maxWidth"},value:{kind:"IntValue",value:"50"}},{kind:"ObjectField",name:{kind:"Name",value:"maxHeight"},value:{kind:"IntValue",value:"50"}},{kind:"ObjectField",name:{kind:"Name",value:"scale"},value:{kind:"IntValue",value:"2"}}]}}],directives:[]},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}},{kind:"Field",name:{kind:"Name",value:"__typename"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:221,source:{name:"GraphQL request",locationOffset:{line:1,column:1}}},id:"fe74e018f6bea8f2fc88a742c42c761ba71aec6cf9c37be10774a52c9baac94e"};function Cr(e){const n=e.map(a=>`id:${a}`).join(" OR "),{data:s,loading:r}=dt(xr,{variables:{query:n}});return{isLoading:r,products:Sr(s)}}function Sr(e){return e==null?[]:e.products.edges.map(n=>{var r;const{node:s}=n;return{id:s==null?void 0:s.id,title:s==null?void 0:s.title,image:{url:(r=s==null?void 0:s.featuredImage)==null?void 0:r.transformedSrc}}})}const kr="_ProductsContainer_v118h_3",Er="_Product_v118h_3",Tr="_Image_v118h_38",jr="_Details_v118h_42",Ir="_TotalSales_v118h_47",wr="_Obfuscated_v118h_52",V={ProductsContainer:kr,Product:Er,Image:Tr,Details:jr,TotalSales:Ir,Obfuscated:wr},Or="_DetailsSkeleton_1nlie_1",Dr="_TotalSalesSkeleton_1nlie_5",tt={DetailsSkeleton:Or,TotalSalesSkeleton:Dr},Lr=({numberOfProducts:e=3})=>{var n=u(1);try{var s=u(1);try{return t.jsx("div",{className:V.ProductsContainer,children:Array.from({length:e}).map(()=>t.jsxs("div",{className:V.Product,children:[t.jsx("div",{className:V.Image,children:t.jsx(ft,{size:"extraSmall"})}),t.jsx("div",{className:M(tt.DetailsSkeleton,V.Details),children:t.jsx(Fe,{lines:2})}),t.jsx("div",{className:M(tt.TotalSalesSkeleton,V.TotalSales),children:t.jsx(Fe,{lines:1})})]},Ie()))})}finally{s.f()}}finally{n.f()}},Rr={title:"Top products",emptyState:"No products",productWithVariant:"{name} • {variant}",linkAriaLabel:"View top products report"},Nr={TopProducts:Rr},Ar={[Symbol.for("i18n-id")]:"TopProducts_uwkqdg",en:Nr},Mr=({data:e,streamerMode:n,viewState:s})=>{var r=u(1);try{var a=u(1);try{const[o]=O(Ar),i=Z(),{produceClickEvent:l}=X(),c=f.useCallback(()=>{l({viewState:s,buttonHandle:A.TopProducts})},[l,s]),{isLoading:m,hasError:p,data:d}=e,y=d.map(_=>{const[,,,h]=_;return h.toString()}),{isLoading:E,products:C}=Cr(y),x=d.map(_=>{const[h,R,T,D,g]=_,j=C==null?void 0:C.find($=>$.id===Lt("Product",D));return{productId:D,productTitle:R,variantId:h,variantTitle:T,totalSales:g,image:j==null?void 0:j.image}}),k=m||p||e==null,v=f.useMemo(()=>{if(k)return null;const _=x.every(h=>h.totalSales===0);return x.length===0||_?t.jsx(L,{variant:"bodyMd",as:"span",children:o.translate("TopProducts.emptyState")}):t.jsx("div",{className:V.ProductsContainer,children:x.map(h=>{var R;return t.jsxs("div",{className:M(V.Product,n&&V.Obfuscated),children:[t.jsx("div",{className:V.Image,children:E?t.jsx(ft,{size:"extraSmall"}):t.jsx(Bt,{source:((R=h.image)==null?void 0:R.url)||"image",size:"small",alt:h.productTitle})}),t.jsxs("div",{className:V.Details,children:[t.jsx(L,{variant:"bodySm",as:"h1",truncate:!0,children:t.jsx(mt,{url:i.productDetails(h.productId),onClick:c,target:"_blank",children:h.productTitle})}),t.jsx(L,{variant:"bodySm",as:"p",fontWeight:"regular",truncate:!0,children:h.variantTitle})]}),t.jsx("div",{className:V.TotalSales,children:t.jsx(L,{as:"span",variant:"bodySm",children:o.formatCurrency(h.totalSales,{form:"short"})})})]},h.variantId)})})},[d,E,n]),S=f.useMemo(()=>k?t.jsx(Lr,{}):null,[d]);return t.jsxs(U,{streamerMode:n,heading:o.translate("TopProducts.title"),headingSize:"bodyMd",children:[S,v]})}finally{a.f()}}finally{r.f()}},Pr={title:"Customers",emptyState:"No customers",type:"{type}",linkAriaLabel:"View customers report",sessions:{one:"{formattedCount} customer",other:"{formattedCount} customers"}},$r={Customers:Pr},kt={[Symbol.for("i18n-id")]:"Customers_qdjrwg",en:$r};function Fr({series:e}){var n=u(1);try{var s=u(1);try{let r=function(i){const l=typeof i=="string"?parseInt(i,10):i,c=o({value:l,type:"number",isCondensed:!0});return`${a.translate("Customers.sessions",{count:l,formattedCount:c})}`};const[a]=O(kt),o=_t();return t.jsx(yt,{showLegend:!1,data:e,xAxisOptions:{labelFormatter:r}})}finally{s.f()}}finally{n.f()}}const Hr=({data:e,streamerMode:n,viewState:s})=>{var r=u(1);try{var a=u(1);try{const[o]=O(kt),i=Z(),{hasReports:l}=re(),c=oe(),{isLoading:m,hasError:p,response:d}=e,y=({result:T})=>{const{data:D}=T;return[{name:"Customers",color:Ts,data:D.map(([g,j])=>({key:o.translate("Customers.type",{type:g}),value:j}))}]},E={since:"today",until:"today",over:"hour"},x=c.include(ae.Reports)&&l&&!n,v={url:i.reportShow("customers_over_time",E),reportTitle:o.translate("Customers.title"),external:!0},{produceClickEvent:S}=X(),_=f.useCallback(()=>{S({viewState:s,buttonHandle:A.Customers})},[S,s]),h=f.useMemo(()=>{if(m||p||d==null)return;const[T]=y(d),D=T.data.every(({value:g})=>g===0);return T.data.length===0||D?t.jsx(L,{variant:"bodyMd",as:"span",children:o.translate("Customers.emptyState")}):t.jsx(Ct,{dataLength:T.data.length,children:t.jsx(Fr,{series:[T]})})},[d]),R=f.useMemo(()=>m||p||d==null?t.jsx(xt,{lines:2,barHeight:bt.Small}):null,[d]);return t.jsxs(U,{reportLink:x?t.jsx(ie,{...v,onClick:_}):void 0,streamerMode:n,heading:o.translate("Customers.title"),headingSize:"bodyMd",children:[R,h]})}finally{a.f()}}finally{r.f()}},Vr="_DrawerContent_rbcrb_1",Br="_DrawerContentEnter_rbcrb_8",Gr="_DrawerContentActive_rbcrb_12",Wr="_DrawerContentExiting_rbcrb_17",qr="_DrawerContentExitDone_rbcrb_21",ee={DrawerContent:Vr,DrawerContentEnter:Br,DrawerContentActive:Gr,DrawerContentExiting:Wr,DrawerContentExitDone:qr},Ur=200;function zr({children:e}){var n=u(1);try{var s=u(1);try{const{isActive:r,isDisabled:a}=Jr(),o=M([ee.DrawerContent,r&&!a&&ee.DrawerContentActive]),i={exit:ee.DrawerContentExiting,exitDone:ee.DrawerContentExitDone,enter:ee.DrawerContentEnter};return t.jsx(Gt,{classNames:i,in:r&&!a,timeout:Ur,children:t.jsx("div",{className:o,children:e})})}finally{s.f()}}finally{n.f()}}const Yr="_Drawer_18hb9_1",Qr="_DrawerActive_18hb9_12",nt={Drawer:Yr,DrawerActive:Qr},Zr={ariaLabel:"Toggle metrics"},Xr={Drawer:Zr},Kr={[Symbol.for("i18n-id")]:"Drawer_wv9rpc",en:Xr},Et=f.createContext({});function je({isActive:e,isDisabled:n,children:s}){var r=u(1);try{var a=u(1);try{const[o]=O(Kr),i={isActive:e,isDisabled:n},l=M([nt.Drawer,e&&!n&&nt.DrawerActive]);return t.jsx(Et.Provider,{value:i,children:t.jsx("div",{className:l,role:"dialog","aria-label":o.translate("Drawer.ariaLabel"),"aria-hidden":!e,"aria-modal":"true",children:s})})}finally{a.f()}}finally{r.f()}}function Jr(){return f.useContext(Et)}je.Content=zr;const eo="_SkipLink_1rysk_1",to={SkipLink:eo};function no({children:e,anchor:n}){var s=u(1);try{var r=u(1);try{return t.jsx("a",{className:to.SkipLink,href:`#${n}`,children:e})}finally{r.f()}}finally{s.f()}}function K({children:e,skipLinkText:n}){var s=u(1);try{var r=u(1);try{const a=f.useRef(on("skipContent"));return t.jsxs(t.Fragment,{children:[n==null||n.length===0?null:t.jsx(no,{anchor:a.current,children:n}),e,n==null||n.length===0?null:t.jsx(w,{position:"absolute",insetBlockStart:"0",insetInlineStart:"0",id:a.current,tabIndex:-1})]})}finally{r.f()}}finally{s.f()}}const so="_Metrics_wyhw5_3",ro="_MetricGridItem_wyhw5_18",oo="_ToggleContainer_wyhw5_23",Q={Metrics:so,MetricGridItem:ro,ToggleContainer:oo};function ao({i18n:e,isDrawerActive:n,streamerMode:s,viewState:r}){var a=u(1);try{var o=u(1);try{const i=Pe(`(max-width: ${hn}px)`),l=Pe("(max-width: 64.9975em)"),c=f.useMemo(()=>i?190:240,[i]),m=f.useRef(null),p=fe(m),{customerBehavior:d,totalSales:y,totalSessions:E,totalOrders:C,visitorsRightNow:x,topLocations:k,topProducts:v,hasErrors:S,hasData:_,customers:h}=Pn(),R=_||S?He.Complete:He.Usable,T=t.jsx(w,{paddingBlockEnd:"500",children:t.jsxs(ct,{columns:2,gap:{xs:"200",lg:"400"},children:[t.jsx(fr,{data:x,streamerMode:s}),t.jsx(w,{position:"relative",children:t.jsx(K,{skipLinkText:e.translate("LiveView.skipHeatMapMetric"),children:t.jsx(Ks,{totalSales:y,streamerMode:s,viewState:r})})}),t.jsx(w,{position:"relative",children:t.jsx(K,{skipLinkText:e.translate("LiveView.skipHeatMapMetric"),children:t.jsx(sr,{totalSessions:E,viewState:r,streamerMode:s})})}),t.jsx(w,{position:"relative",children:t.jsx(K,{skipLinkText:e.translate("LiveView.skipHeatMapMetric"),children:t.jsx(ir,{totalOrders:C,viewState:r,streamerMode:s})})}),t.jsx("div",{className:Q.MetricGridItem,children:t.jsx(K,{skipLinkText:e.translate("LiveView.skipChart"),children:t.jsx(br,{data:k,viewState:r,streamerMode:s})})}),t.jsx("div",{className:Q.MetricGridItem,children:t.jsx(K,{skipLinkText:e.translate("LiveView.skipChart"),children:t.jsx("div",{ref:m,children:t.jsx(Hr,{data:h,streamerMode:s,viewState:r})})})}),t.jsx("div",{className:Q.MetricGridItem,children:t.jsx(K,{skipLinkText:e.translate("LiveView.skipChart"),children:t.jsx(Mr,{data:v,viewState:r,streamerMode:s})})}),t.jsx("div",{className:Q.MetricGridItem,children:t.jsx(Cs,{width:(p==null?void 0:p.width)??200,height:c,data:d,streamerMode:s})})]})});return t.jsxs(t.Fragment,{children:[l?t.jsx("div",{className:Q.ToggleContainer,children:t.jsx("div",{className:Q.Metrics,children:T})}):t.jsx(je,{isActive:n,isDisabled:!1,children:t.jsx(je.Content,{children:t.jsx("div",{className:Q.Metrics,children:T})})}),t.jsx(Wt,{stage:R,id:"LiveView"})]})}finally{o.f()}}finally{a.f()}}const Se={initialVisitorLocations:`
    SHOW max(timestamp) AS timestamp
    BY session_token, event_type, latitude, longitude
    FROM pageviews
    WHERE event_type == "pageview" AND latitude != 0 AND longitude != 0
    SINCE -300s
    UNTIL -2s
    ORDER BY timestamp ASC
    LIMIT 3000 SAMPLED
  `,visitorLocations:()=>`
    SHOW max(timestamp) AS timestamp
    BY session_token, event_type, latitude, longitude
    FROM pageviews_v4
    WHERE event_type == "pageview" AND latitude != 0 AND longitude != 0
    SINCE -300s
    UNTIL -2s
    ORDER BY timestamp ASC
    LIMIT 3000 SAMPLED
  `,orderLocations:(e=-62-P/1e3,n=-62)=>`
    SHOW max(timestamp) AS timestamp
    BY session_token, event_type, latitude, longitude, city, order_value, country
    FROM pageviews_v4
    WHERE event_type == "order_placed" AND latitude != 0 AND longitude != 0
    SINCE ${e}s
    UNTIL ${n}s
    ORDER BY timestamp ASC
    LIMIT 1000 SAMPLED
  `};function io({skip:e=!1}){let n,s;const r=H({query:Se.initialVisitorLocations,skip:e}),a=H({query:Se.visitorLocations(),pollInterval:P,skip:e}),o=H({query:Se.orderLocations(n,s),pollInterval:P,skip:e}),i={initialVisitorLocations:r,visitorLocations:a,orderLocations:o},l=Object.values(i).find(m=>m!=null&&m.hasError),c=Object.values(i).find(m=>m!=null&&m.response!=null);return{...i,hasErrors:l,hasData:c}}function lo(){const{data:e,loading:n}=dt(en);return{shopLocation:f.useMemo(()=>{var l;const r=(l=e==null?void 0:e.shop)==null?void 0:l.billingAddress;if(r==null||r.latitude==null||r.longitude==null||r.countryCode==null||r.latitude===0&&r.longitude===0)return null;const{latitude:a,longitude:o,countryCode:i}=r;return{latitude:a,longitude:o,countryCode:i}},[e]),loading:n}}const co={message:"Live View cannot be displayed at the moment. Check your browser settings to make sure you have hardware acceleration enabled. Try restarting your browser or {link}.",bannerLink:"use a different one"},uo={WebGLError:co},fo={[Symbol.for("i18n-id")]:"WebGLErrorBanner_91ruow",en:uo};function mo(){var e=u(1);try{var n=u(1);try{const[s]=O(fo),r=Z();return t.jsx(w,{as:"div",padding:"400",children:t.jsx(qt,{tone:"warning",children:s.translate("WebGLError.message",{link:t.jsx(mt,{url:r.helpCenterUrl({path:"/manual/shopify-admin/supported-browsers",locale:s.locale}),children:s.translate("WebGLError.bannerLink")})})})})}finally{n.f()}}finally{e.f()}}const po=rt({load:()=>lt(()=>import("./Globe-6NZnt_5f_Jwm.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37]))}),ho=rt({load:()=>lt(()=>import("./Map-Ar-O8PpawOTh.js"),__vite__mapDeps([38,1,2,12,3,4,5,6,13,39,14,15,16,17,18,19,20,21,22,23,24,10,11,9,25,26,27,28,29,30,31,32,33,34,35,36,40]))});function _o({fullScreenActive:e,fullscreenEnabled:n,i18n:s,isDrawerActive:r,mapMode:a,onDrawerClose:o,onDrawerOpen:i,onLiveViewClickEvent:l,onToggleFullScreen:c,onToggleMapMode:m,onToggleStreamerMode:p,streamerMode:d,webGLAvailable:y}){var E=u(1);try{var C=u(1);try{const x=io({}),k=lo(),{lgDown:v}=Ut(),S=[v?null:{id:"streamerAction",content:s.translate("LiveView.streamerMode"),icon:d?"hide":"view",onAction:()=>{p();const _=d?A.DisableStreamerMode:A.EnableStreamerMode;l(_)}},{id:"mapModeToggleAction",content:a===W.Flat?s.translate("LiveView.globeView"):s.translate("LiveView.flatMapView"),icon:a===W.Flat?"globe":"map",onAction:m},v?null:{id:"fullScreenAction",content:!e&&n?s.translate("LiveView.fullScreen"):s.translate("LiveView.exitFullScreen"),icon:!e&&n?"maximize":"minimize",onAction:c}].filter(Boolean);return t.jsxs(t.Fragment,{children:[y?null:t.jsx(mo,{}),y&&a===W.Globe?t.jsx(po,{geoData:x,shopLocationData:k,actions:S,isMetricsActive:r,handleDrawerClose:o,handleDrawerOpen:i,streamerMode:d}):t.jsx(ho,{actions:S,geoData:x,shopLocationData:k})]})}finally{C.f()}}finally{E.f()}}function me(){return typeof document>"u"?null:document}function yo(e=me()){if(e==null)return!1;const n=e.fullscreenEnabled||e.webkitFullscreenEnabled||e.mozFullScreenEnabled||e.msFullscreenEnabled,r=window!==window.top?e.documentElement.getAttribute("allowfullscreen")!==null||e.documentElement.getAttribute("webkitallowfullscreen")!==null||e.documentElement.getAttribute("mozallowfullscreen")!==null:!0;return!!(n&&r&&"requestFullscreen"in e.documentElement)}function go(e=me()){return e==null?!1:!!(e.fullscreenElement||e.webkitFullscreenElement||e.mozFullScreenElement||e.msFullscreenElement)}function vo(e=me()){if(e==null)return;const n=["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","msfullscreenchange"];for(const s of n)if(`on${s}`in e)return s}function bo(e){if(e==null)return;const n=e.requestFullscreen||e.webkitRequestFullscreen||e.mozRequestFullScreen||e.msRequestFullscreen;if(n)try{n.call(e)}catch{}}function xo(e=me()){if(e==null)return;const n=e.exitFullscreen||e.webkitExitFullscreen||e.mozCancelFullScreen||e.msExitFullscreen;if(n)try{n.call(e)}catch{}}function Co({onChangeCallback:e}={}){const{current:n}=at(()=>vo()),{isFullscreen:s,setFullscreen:r}=f.useContext(jt),a=f.useCallback(()=>{document.body&&(go()?xo():bo(document.body))},[]),o=f.useCallback(()=>{e&&e(s),r(!s)},[s,r,e]);return{EnableFullScreen:f.useMemo(()=>{function l(){var c=u(1);try{return t.jsx(t.Fragment,{children:n&&t.jsx(ut,{event:n,handler:o})})}finally{c.f()}}return l},[n,o]),enabled:yo(),active:s,toggle:a}}function So(e){if(e)return!0;const n=window.WebGLRenderingContext!=null,s=document.createElement("canvas"),r=s.getContext("webgl")!=null,a=s.getContext("experimental-webgl")!=null;return n&&(r||a)}const ko="AIzaSyAebPbAriSPSkel_ZBZW609HbioFnQI78w",Eo={fullScreen:"Full screen",exitFullScreen:"Exit full screen",title:"Live View",skipGlobe:"Skip globe content",skipHeatMapMetric:"Skip heat metric content",skipChart:"Skip chart content",streamerMode:"Streamer mode",globeView:"Switch to globe view",flatMapView:"Switch to map view"},To={title:"Total Sessions",tooltip:{one:"{count} session on {date}",other:"{count} total sessions on {date}"}},jo={LiveView:Eo,TotalSessions:To},Tt={[Symbol.for("i18n-id")]:"LiveView_1qmltsb",en:jo};function Io(){var e=u(1);try{const n=f.useMemo(()=>So(ot),[]),s=zt(),[r]=O(Tt),a=f.useRef(r.locale),o=f.useRef(r.defaultCountry);return s.leaveBreadcrumb("Live View Google Maps locale",{currentI18nLocale:r.locale,currentI18nDefaultCountry:r.defaultCountry,refI18nLocale:a.current,refI18nDefaultCountry:o.current}),t.jsx(ln,{children:t.jsx(dn,{children:t.jsx(nn,{themes:Cn,children:t.jsx(wo,{webGLAvailable:n,locale:a.current,defaultCountry:o.current})})})})}finally{e.f()}}function wo({webGLAvailable:e,locale:n,defaultCountry:s}){var r=u(1);try{const{shopName:a}=re(),o=Rt(),[i]=O(Tt),{value:l,toggle:c}=$e(!1),{produceClickEvent:m,producePageViewEvent:p}=X(),[{value:d,update:y}]=Yt("live_view_2021_default_map_mode",W.Globe),{value:E,setFalse:C,setTrue:x}=$e((o==null?void 0:o.hash)===""),k=d===W.Globe?A.GlobeView:A.MapView,v=g=>{m({viewState:k,buttonHandle:g})},S=()=>{y(g=>g===W.Globe?(v(A.EnableMap),W.Flat):(v(A.EnableGlobe),W.Globe))};Qt(()=>p({viewState:k}));const _=g=>{const j=g?A.ExitFullScreen:A.EnterFullScreen;v(j)},{EnableFullScreen:h,enabled:R,active:T,toggle:D}=Co({onChangeCallback:_});return t.jsxs(At.Wrapper,{apiKey:ko,libraries:["places"],version:"quarterly",language:n,region:s,children:[t.jsx(h,{}),t.jsx(w,{position:"relative",minHeight:"100%",width:"100%",overflowX:"hidden",background:"bg",paddingBlockStart:{xs:"400",lg:"600"},paddingBlockEnd:{xs:"400",lg:"600"},paddingInlineStart:{xs:"400",lg:"800"},paddingInlineEnd:{xs:"400"},children:t.jsxs(Ln,{title:a,streamerMode:l,titleHidden:Nt(),children:[t.jsx(Zt,{title:i.translate("LiveView.title")}),t.jsxs(tn,{children:[t.jsx(w,{position:"absolute",zIndex:"var(--p-z-index-3)",paddingBlockStart:"300",children:t.jsx(Mn,{mapMode:d})}),t.jsx(_o,{i18n:i,fullScreenActive:T,fullscreenEnabled:R,isDrawerActive:E,mapMode:d,onDrawerClose:C,onDrawerOpen:x,onLiveViewClickEvent:v,onToggleFullScreen:D,onToggleMapMode:S,onToggleStreamerMode:c,streamerMode:l,webGLAvailable:e}),t.jsx(ao,{i18n:i,isDrawerActive:E,streamerMode:l,viewState:k})]})]})})]})}finally{r.f()}}const sa=Object.freeze(Object.defineProperty({__proto__:null,default:Io},Symbol.toStringTag,{value:"Module"}));export{ea as C,Jo as G,Yo as I,A as L,ta as M,Zo as O,na as S,ws as T,Es as V,X as a,Qo as b,Ko as c,Xo as d,un as e,sa as f,cn as u};
//# sourceMappingURL=https://web-sourcemaps.shopify.io/v1/en/LiveView-BtAKJocWST2N.js.map
