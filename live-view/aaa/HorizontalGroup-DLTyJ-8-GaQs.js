import{b6 as d}from"./common-BQgXWrz2O5Bt.js";import{a as z,u as P,b as nt,e as U,g as K}from"./estimateStringWidthWithOffset-BtLey8F0hhhu.js";import{o as _t,L as At,H as vt,q as Y,a as Et,i as rt,e as ft,v as bt,d as mt,f as q,Z as Tt,N as yt,B as Mt}from"./ChartContainer-XfUOX9D3-me7.js";import{x as ot,a as St,y as J,H as $,z as at,G as N,J as F,K as Lt,M as $t,C as D,F as Nt,N as Ot,O as V,f as Gt,Q as st,R as It,q as Rt}from"./PolarisVizContext-DMg2GlMLMFOp.js";import{n as Ht,k as Q}from"./getAxisOptions-ZBfQL9C9uyF_.js";import{a as it}from"./linear-CXDBUpXMebsN.js";import{e as jt}from"./extent-DJTi1Ll1A6EW.js";import{d as Ct,u as dt,a as ht}from"./react-spring-web.esm-BOY3iVmaUFuM.js";import{X as m}from"./router-D2A3v33YTGz9.js";import{e as Bt,F as Ft,T as zt,H as Wt}from"./TrendIndicator-ForsXhGLj1mL.js";function ge(t,o={xAxisLabelFormatter:void 0,yAxisLabelFormatter:void 0}){return d.useCallback(function({seriesIndex:r,key:e}){const{xAxisLabelFormatter:a,yAxisLabelFormatter:s}=o,i=t.map(({name:c,data:u})=>u[r]?`${c} ${a?a(u[r].value):u[r].value}`:"").join(", ");return e?`${s?s(e):e}: ${i}`:""},[t,o])}function Dt({stackedValues:t,data:o,integersOnly:n}){if(t!=null){const r=t.map(c=>Math.min(...c.map(([u])=>u))),e=t.map(c=>Math.max(...c.map(([,u])=>u))),a=Math.max(...e),s=Math.min(...r),i=o.length===0||a===0&&s===0?ot:Math.max(0,a);return{min:n?Math.floor(s):s,max:n?Math.ceil(i):i}}else{const r=o.reduce((i,c)=>{const u=c.data.map(({value:l})=>l).filter(l=>l!==null);return i.concat(u)},[]),e=Math.max(...r),a=Math.min(...r,0),s=o.length===0||e===0&&a===0?ot:Math.max(0,e);return{min:n?Math.floor(a):a,max:n?Math.ceil(s):s}}}const Pt="grad";function xe({direction:t="vertical",id:o,seriesColors:n=[],size:r="100%",gradientUnits:e}){const{theme:a}=z();return m.jsx("defs",{children:n.map((s,i)=>{const c=tt(a,i,o);return m.jsx(kt,{color:s,direction:t,gradientUnits:e,id:c,size:r},c)})})}function kt({id:t,color:o,direction:n,size:r,gradientUnits:e="userSpaceOnUse"}){const a=_t(o),s=n==="vertical"?{y1:r}:{x2:r};return m.jsx(At,{gradient:a,gradientUnits:e,id:t,...s})}function tt(t=St,o,n){return[n,t,o,Pt].join("-")}function ct({gaps:t,index:o,direction:n,firstGapValue:r}){if(!t[n][t[n].length-1]){t[n].push({index:o,gap:r});return}const{gap:e}=t[n][t[n].length-1];t[n].push({index:o,gap:e+J})}function lt({gaps:t,direction:o,seriesIndex:n}){var r,e;return(r=(e=t[o].find(({index:a})=>a===n))===null||e===void 0?void 0:e.gap)!==null&&r!==void 0?r:0}function Xt({barSize:t,zeroPosition:o,max:n,position:r}){let e=vt;const a=n-o,s=n-a;return r==="horizontal"?t+e>=a&&(e=a-t):t+e>=s&&(e=s-t),{clampedSize:Y({amount:t+e,min:t,max:n}),offset:e}}function _e(t){const o=P(),n=d.useMemo(()=>t.reduce((a,s,i)=>t[a].data.length<s.data.length?i:a,0),[t]),r=d.useMemo(()=>t[n].data.length,[t,n]),e=d.useMemo(()=>{const a=t.filter(({isComparison:i})=>i!==!0),s=Et(a.length,o);return t.forEach(({color:i,isComparison:c},u)=>{let l;c?l=o.seriesColors.comparison:i!=null&&(l=i),l&&s.splice(u,0,l)}),s.slice(0,t.length)},[t,o]);return{longestSeriesCount:r,seriesColors:e,longestSeriesIndex:n}}function Ae({data:t,isSimple:o,isStacked:n,labelFormatter:r}){const{characterWidths:e}=z(),a=d.useMemo(()=>t.reduce((f,h)=>{const A=h.data.map(({value:b})=>b).filter(b=>b!==null);return f.concat(...A)},[]),[t]),s=d.useMemo(()=>Math.min(0,...a),[a]),i=d.useMemo(()=>Math.max(0,...a),[a]);if(rt(s)||rt(i))throw new Error("Data must be finite");const c=d.useMemo(()=>{if(!o&&!n)return{positive:0,negative:0};const f=s===0?0:nt(`${r(s)}`,e)+$,h=i===0?0:nt(`${r(i)}`,e)+$;return{negative:f,positive:h}},[r,o,n,i,s,e]),u=d.useMemo(()=>!a.some(f=>f!==null&&f!==0),[a]),l=d.useMemo(()=>u?!1:!a.some(f=>f!==null&&f>0),[u,a]);return{allNumbers:a,areAllNegative:l,longestLabel:c}}function ve({data:t,isStacked:o}){const{stackedValues:n,stackedMin:r,stackedMax:e}=d.useMemo(()=>{if(!o||t.length===0)return{stackedMin:0,stackedMax:0,stackedValues:[]};const{stackedValues:a,formattedStackedValues:s}=Ht(t),{min:i,max:c}=Dt({stackedValues:a,data:t,integersOnly:!1});return{stackedMin:i,stackedMax:c,stackedValues:s}},[o,t]);return{stackedValues:n,stackedMin:r,stackedMax:e}}function wt({maxWidth:t,allNumbers:o,labelFormatter:n,isStacked:r,stackedMin:e,stackedMax:a}){const s=d.useMemo(()=>{const f=!o.some(A=>A!=null&&A!==0),h=[0,...o];return f&&h.push(1),it().range([0,t]).domain(jt(h,A=>A)).nice()},[t,o]),i=d.useMemo(()=>s.ticks(),[s]),c=d.useMemo(()=>r?it().range([0,t]).domain([e,a]).nice():null,[r,t,e,a]),u=d.useMemo(()=>!r||!c?[]:c.ticks(),[r,c]),l=r?u:i;return{ticks:l,xScale:r?c:s,ticksFormatted:l.map(f=>`${n(f)}`)}}function Ee({allNumbers:t,isStacked:o,labelFormatter:n,maxWidth:r,stackedMax:e=0,stackedMin:a=0,longestLabel:s}){let i=r,c=0;const u=s.positive+s.negative;i-=u,c+=u/2;const{xScale:l,ticks:f,ticksFormatted:h}=wt({maxWidth:i,allNumbers:t,labelFormatter:n,isStacked:o,stackedMin:a,stackedMax:e});return{xScale:l,ticks:f,ticksFormatted:h,drawableWidth:i,chartXPosition:c}}const Zt=6;function be({chartDimensions:t,isSimple:o,isStacked:n,seriesLength:r,singleBarCount:e,xAxisHeight:a}){return d.useMemo(()=>{const s=o?0:Lt,i=t.height+at,c=o?i:t.height,u=o?0:a+s,l=c-u,f=l/r,h=f-N-(e-1)*F-at;return{barHeight:Y({amount:h/(n?1:e),min:Zt}),chartHeight:l,groupBarsAreaHeight:h,groupHeight:f}},[t,o,n,r,e,a])}function Te({chartXPosition:t,groupHeight:o,series:n}){const{shouldAnimate:r,id:e}=z(),a=d.useMemo(()=>n[0].data.map(({key:l},f)=>({key:`${l}`,index:f})),[n]),s=l=>`translate(${t}px,${o*l}px)`,i=50,c=s(n.length+1);return{transitions:Ct(a,{keys:l=>l.key===""?`${e}-${l.index}`:l.key,initial:({index:l})=>({opacity:1,transform:s(l)}),from:({index:l})=>({opacity:0,transform:r?c:s(l)}),leave:{opacity:0,transform:c},update:({index:l})=>({opacity:1,transform:s(l)}),expires:!0,config:$t,trail:r?i:0,immediate:!r})}}var Vt={Group:"_Group_kzepq_144"},Ut={Label:"_Label_1vvi2_144"};const ut=15;function Kt({areAllNegative:t,containerWidth:o,label:n,zeroPosition:r}){const e=K(),a=U(n,e),s=P(),i=t?a+ut:o-r;return m.jsx("foreignObject",{height:N,width:"100%",x:r+(t?a*-1:0),"aria-hidden":"true",children:m.jsx("div",{className:Ut.Label,style:{background:s.chartContainer.backgroundColor,fontSize:`${e}px`,color:s.yAxis.labelColor,maxWidth:i,height:N,width:a+ut},children:n})})}function Yt({stackedValues:t,groupIndex:o}){return d.useMemo(()=>{const n={positive:[],negative:[]};return t[o].forEach(([r,e],a)=>{e>0&&ct({gaps:n,index:a,direction:"positive",firstGapValue:0}),r<0&&ct({gaps:n,index:a,direction:"negative",firstGapValue:J})}),n},[o,t])}function qt({start:t,end:o,seriesIndex:n,gaps:r,xScale:e}){return t<0?e(t)-lt({gaps:r,direction:"negative",seriesIndex:n}):o>0?e(t)+lt({gaps:r,direction:"positive",seriesIndex:n}):e(t)}function Jt({animationDelay:t,activeBarIndex:o,ariaLabel:n,borderRadius:r,color:e,height:a,seriesIndex:s,setActiveBarIndex:i,width:c,x:u,zeroPosition:l}){const f=ft({animationDelay:t}),{transform:h}=dt({from:{transform:"scale(0, 1)"},to:{transform:"scale(1, 1)"},...f}),A=bt({height:a,width:c,borderRadius:r});return m.jsxs(ht.g,{style:{transform:h,transformOrigin:`${l}px 0px`},children:[m.jsx("path",{d:A,fill:`url(#${e})`,height:a,style:{outline:"none",transformOrigin:`${u}px 0px`,...mt({activeIndex:o,index:s})},width:c,transform:`translate(${u},0)`,"aria-hidden":"true"}),m.jsx("rect",{fill:"transparent",height:a,width:c+J,x:u,...q({type:D,index:s}),"aria-label":n,role:"img",tabIndex:-1,onMouseOver:()=>i(s),onMouseLeave:()=>i(-1)})]})}function pt({animationDelay:t,children:o,x:n}){const r=ft({animationDelay:t}),e=dt({from:{transform:"translateX(0px)",opacity:0},to:{opacity:1,transform:`translateX(${n}px)`},...r});return m.jsx(ht.g,{style:{opacity:e.opacity,transform:e.transform},children:o})}function gt({barHeight:t,color:o,fontSize:n,label:r,labelWidth:e,y:a}){const s=t/2;return m.jsx("text",{height:Ot,width:e,"aria-hidden":"true",y:a+s,fontSize:`${n}px`,fontFamily:Nt,fill:o,dominantBaseline:"central",children:r})}function Qt(t,o,n){return`${t}-series-${o}-${n}`}function te({lastIndexes:t,seriesIndex:o}){const[n,r]=t;return n===o?V.Right:r===o?V.Left:V.None}function ee({activeGroupIndex:t,animationDelay:o,barHeight:n,dataKeys:r,groupIndex:e,id:a,name:s,stackedValues:i,xScale:c,areAllNegative:u,isSimple:l,labelFormatter:f}){const h=P(),{theme:A}=z(),[b,y]=d.useState(-1),M=h.groupLabel.hide,O=K();Q({type:D,onIndexChange:({detail:g})=>{(t===-1||t===e)&&y(g.index)}});const G=d.useMemo(()=>{let g=-1,p=-1;return i[e].forEach(([x,S],L)=>{x<0&&(p=L),S>0&&(g=L)}),[g,p]},[e,i]),_=Yt({stackedValues:i,groupIndex:e}),T=i[e].reduce((g,p)=>p.data?Object.values(p.data).reduce((x,S)=>x+S,0):0,0),v=T&&T<0,H=f(T),E=U(`${H}`,O),j=i[e].reduce((g,p)=>{const x=p[0];return x<g?x:g},Number.MAX_SAFE_INTEGER),W=i[e].reduce((g,p)=>{const x=p[1];return x>g?x:g},-Number.MAX_SAFE_INTEGER),k=v?c(j)-E-$:c(W)+$;return m.jsxs("g",{style:{transform:`translate(0, ${N}px`},"aria-hidden":"true",children:[i[e].map((g,p)=>{var x;const[S,L]=g,C=Qt(a,e,p),I=Math.abs(c(L)-c(S)),X=te({lastIndexes:G,seriesIndex:p}),B=qt({start:S,end:L,seriesIndex:p,gaps:_,xScale:c}),w=`${(x=r[p])!==null&&x!==void 0?x:""} ${L}`,Z=i[e].every(([R,xt])=>R+xt===0);return m.jsx(d.Fragment,{children:Z?m.jsx(Tt,{x:u?B-yt:B,y:n/2,direction:"horizontal"}):m.jsx(Jt,{animationDelay:o,activeBarIndex:b,ariaLabel:w,borderRadius:X,color:tt(A,p,a),height:n,seriesIndex:p,setActiveBarIndex:y,width:I,x:B,zeroPosition:c(0)},`${s}${C}`)},`stackedBar ${C}`)}),!l&&!M&&m.jsx(pt,{animationDelay:o,x:k,children:m.jsx(gt,{barHeight:n,color:h.xAxis.labelColor,fontSize:O,label:H,labelWidth:E,y:0})})]})}function ne(t){if(t!=null){var o;const{totalWidth:n}=Bt((o=t.value)!==null&&o!==void 0?o:"",Gt,Ft);return{trendIndicatorProps:t,trendIndicatorWidth:n}}return{trendIndicatorProps:void 0,trendIndicatorWidth:0}}var re={Bar:"_Bar_h2fc5_144"};const oe=150;function ae({activeGroupIndex:t,animationDelay:o=0,barHeight:n,data:r,groupIndex:e,id:a,isSimple:s,labelFormatter:i,name:c,xScale:u,zeroPosition:l,containerWidth:f,areAllNegative:h}){const A=P(),{theme:b}=z(),y=K(),[M,O]=d.useState(-1);return Q({type:D,onIndexChange:({detail:G})=>{(t===-1||t===e)&&O(G.index)}}),m.jsx("g",{transform:`translate(${l},${N})`,"aria-hidden":"true",children:r.map((G,_)=>{var T,v;if(r[_].data[e]==null)return;const H=o+oe*_,{value:E}=r[_].data[e];if(E==null)return null;const j=E&&E<0,W=i(E),k=`${r[_]?r[_].name:""} ${E}`,{trendIndicatorProps:g,trendIndicatorWidth:p}=ne((T=r[_])===null||T===void 0||(v=T.metadata)===null||v===void 0?void 0:v.trends[e]),x=U(`${W}`,y);function S(){const et=Math.abs(u(E??0)-u(0)),w=g==null?$:$*2,Z=s?x+w+p:0,R=Y({amount:et,min:1});return h||j?{labelX:-(R+Z),barWidth:R}:{labelX:R+$,barWidth:R}}const{labelX:L,barWidth:C}=S(),I=n*_+F*_,{clampedSize:X}=Xt({barSize:C,zeroPosition:u(0),max:f,position:"horizontal"}),B=(n-Wt)/2;return m.jsxs(d.Fragment,{children:[m.jsx(Mt,{animationDelay:H,areAllNegative:h,color:`url(#${tt(b,_,a)})`,height:n,index:e,isActive:M===-1||M===_,transform:j?"scaleX(-1)":"",width:C,x:0,y:I}),s&&m.jsxs(pt,{animationDelay:H,x:L,children:[m.jsx(gt,{barHeight:n,color:A.xAxis.labelColor,fontSize:y,label:W,labelWidth:x,y:I}),g!=null&&m.jsx("g",{transform:`translate(${x+$}, ${I+B})`,children:m.jsx(zt,{...g})})]}),m.jsx("rect",{className:re.Bar,x:0,y:I-F/2,width:X,height:n+F,fill:"transparent",style:{transform:j?"scaleX(-1)":""},...q({type:D,index:_}),tabIndex:-1,role:"img","aria-label":k})]},`series-${_}-${a}-${c}`)})})}function ye({areAllNegative:t,ariaLabel:o,barHeight:n,containerWidth:r,data:e,groupHeight:a,id:s,index:i,isSimple:c,isStacked:u,name:l,stackedValues:f,xAxisOptions:h,yAxisOptions:A,xScale:b,zeroPosition:y}){const[M,O]=d.useState(-1);Q({type:st,onIndexChange:({detail:v})=>{O(v.index)}});const G=d.useMemo(()=>e.map(({name:v})=>v??""),[e]),_=d.useMemo(()=>{const v=n+F;return u?N+v:N+v*e.length},[n,e.length,u]),T=i*(It/e[0].data.length);return m.jsxs("g",{style:mt({activeIndex:M,index:i}),...q({type:st,index:i}),"data-type":Rt.BarGroup,"data-index":i,"aria-hidden":"false","aria-label":o,role:"list",className:Vt.Group,children:[m.jsx("rect",{fill:"transparent",height:a,width:r,y:-(a-_)/2}),m.jsx(Kt,{areAllNegative:t,containerWidth:r,label:A.labelFormatter(l),zeroPosition:y}),u?m.jsx(ee,{activeGroupIndex:M,animationDelay:T,ariaLabel:o,barHeight:n,dataKeys:G,groupIndex:i,id:s,name:l,stackedValues:f,xScale:b,areAllNegative:t,labelFormatter:h.labelFormatter,isSimple:c}):m.jsx(ae,{animationDelay:T,activeGroupIndex:M,barHeight:n,data:e,groupIndex:i,id:s,isSimple:c,labelFormatter:h.labelFormatter,name:l,xScale:b,zeroPosition:y,containerWidth:r,areAllNegative:t})]})}export{xe as G,ye as H,Ae as a,ve as b,Ee as c,be as d,Te as e,ge as f,ne as g,lt as h,tt as i,Xt as j,Dt as k,ct as p,_e as u};
//# sourceMappingURL=https://web-sourcemaps.shopify.io/v1/en/HorizontalGroup-DLTyJ-8-GaQs.js.map
